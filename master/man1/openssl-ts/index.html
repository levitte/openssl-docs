<!doctype html><html class=no-js lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><link href=https://docs.openssl.org/master/man1/openssl-ts/ rel=canonical><link href=../openssl-storeutl/ rel=prev><link href=../openssl-verification-options/ rel=next><link href=../../images/favicon.ico rel=icon><meta content="mkdocs-1.6.0, mkdocs-material-9.5.27" name=generator><title>openssl-ts - OpenSSL Documentation</title><link href=../../assets/stylesheets/main.6543a935.min.css rel=stylesheet><link href=../../assets/stylesheets/palette.06af60db.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href=../../stylesheets/extra.css rel=stylesheet><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><body data-md-color-accent=light-blue data-md-color-primary=blue-grey data-md-color-scheme=default dir=ltr><input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox><input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox><label class=md-overlay for=__drawer></label><div data-md-component=skip><a class=md-skip href=#openssl-ts> Skip to content </a></div><div data-md-component=announce></div><div data-md-color-scheme=default data-md-component=outdated hidden></div><header class="md-header md-header--shadow md-header--lifted" data-md-component=header><nav class="md-header__inner md-grid" aria-label=Header><a aria-label="OpenSSL Documentation" class="md-header__button md-logo" title="OpenSSL Documentation" data-md-component=logo href=../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a><label class="md-header__button md-icon" for=__drawer><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> OpenSSL Documentation </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> openssl-ts </span></div></div></div><form class=md-header__option data-md-component=palette><input aria-label="Switch to dark mode" class=md-option data-md-color-accent=light-blue data-md-color-media data-md-color-primary=blue-grey data-md-color-scheme=default id=__palette_0 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg></label><input aria-label="Switch to light mode" class=md-option data-md-color-accent=light-blue data-md-color-media data-md-color-primary=black data-md-color-scheme=slate id=__palette_1 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg></label></form><script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script><label class="md-header__button md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input aria-label=Search autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=Search required spellcheck=false><label class="md-search__icon md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg></label><nav aria-label=Search class=md-search__options><button class="md-search__icon md-icon" aria-label=Clear tabindex=-1 title=Clear type=reset><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg></button></nav><div class=md-search__suggest data-md-component=search-suggest></div></form><div class=md-search__output><div class=md-search__scrollwrap data-md-scrollfix tabindex=0><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta>Initializing search</div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a title="Go to repository" class=md-source data-md-component=source href=https://github.com/openssl/openssl> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div> <div class=md-source__repository>GitHub</div> </a></div></nav><nav aria-label=Tabs class=md-tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a class=md-tabs__link href=../..> Home </a><li class=md-tabs__item><a class=md-tabs__link href=../../fips/> FIPS-140 </a><li class="md-tabs__item md-tabs__item--active"><a class=md-tabs__link href=../> Commands </a><li class=md-tabs__item><a class=md-tabs__link href=../../man3/> Libraries </a><li class=md-tabs__item><a class=md-tabs__link href=../../man5/> File Formats </a><li class=md-tabs__item><a class=md-tabs__link href=../../man7/> Overviews </a></ul></div></nav></header><div class=md-container data-md-component=container><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0><label class=md-nav__title for=__drawer><a aria-label="OpenSSL Documentation" class="md-nav__button md-logo" title="OpenSSL Documentation" data-md-component=logo href=../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> OpenSSL Documentation</label><div class=md-nav__source><a title="Go to repository" class=md-source data-md-component=source href=https://github.com/openssl/openssl> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div> <div class=md-source__repository>GitHub</div> </a></div><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item> <a class=md-nav__link href=../.. title=Home>    <span class=md-ellipsis-custom> Home </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../../fips/ title=FIPS-140>    <span class=md-ellipsis-custom> FIPS-140 </span>  </a><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">  <input class="md-nav__toggle md-toggle" checked id=__nav_3 type=checkbox>  <div class="md-nav__link md-nav__container"><a class=md-nav__link href=../>    <span class=md-ellipsis-custom> Commands </span>  </a><label class=md-nav__link for=__nav_3 id=__nav_3_label><span class="md-nav__icon md-icon"></span></label></div>  <nav aria-expanded=true aria-labelledby=__nav_3_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_3><span class="md-nav__icon md-icon"></span> Commands</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item> <a class=md-nav__link href=../CA.pl/ title=CA.pl>    <span class=md-ellipsis-custom> CA.pl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=asn1parse>    <span class=md-ellipsis-custom> asn1parse </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-rehash title=c_rehash>    <span class=md-ellipsis-custom> c_rehash </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=ca>    <span class=md-ellipsis-custom> ca </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=ciphers>    <span class=md-ellipsis-custom> ciphers </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=cmp>    <span class=md-ellipsis-custom> cmp </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=cms>    <span class=md-ellipsis-custom> cms </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=crl>    <span class=md-ellipsis-custom> crl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=crl2pkcs7>    <span class=md-ellipsis-custom> crl2pkcs7 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=dgst>    <span class=md-ellipsis-custom> dgst </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=dhparam>    <span class=md-ellipsis-custom> dhparam </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=dsa>    <span class=md-ellipsis-custom> dsa </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=dsaparam>    <span class=md-ellipsis-custom> dsaparam </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=ec>    <span class=md-ellipsis-custom> ec </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=ecparam>    <span class=md-ellipsis-custom> ecparam </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=enc>    <span class=md-ellipsis-custom> enc </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=engine>    <span class=md-ellipsis-custom> engine </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=errstr>    <span class=md-ellipsis-custom> errstr </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=gendsa>    <span class=md-ellipsis-custom> gendsa </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=genpkey>    <span class=md-ellipsis-custom> genpkey </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=genrsa>    <span class=md-ellipsis-custom> genrsa </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=info>    <span class=md-ellipsis-custom> info </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=kdf>    <span class=md-ellipsis-custom> kdf </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=mac>    <span class=md-ellipsis-custom> mac </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=nseq>    <span class=md-ellipsis-custom> nseq </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=ocsp>    <span class=md-ellipsis-custom> ocsp </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl/ title=openssl>    <span class=md-ellipsis-custom> openssl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-asn1parse/ title=openssl-asn1parse>    <span class=md-ellipsis-custom> openssl-asn1parse </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-ca/ title=openssl-ca>    <span class=md-ellipsis-custom> openssl-ca </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-ciphers/ title=openssl-ciphers>    <span class=md-ellipsis-custom> openssl-ciphers </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds/ title=openssl-cmds>    <span class=md-ellipsis-custom> openssl-cmds </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmp/ title=openssl-cmp>    <span class=md-ellipsis-custom> openssl-cmp </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cms/ title=openssl-cms>    <span class=md-ellipsis-custom> openssl-cms </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-crl/ title=openssl-crl>    <span class=md-ellipsis-custom> openssl-crl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-crl2pkcs7/ title=openssl-crl2pkcs7>    <span class=md-ellipsis-custom> openssl-crl2pkcs7 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-dgst/ title=openssl-dgst>    <span class=md-ellipsis-custom> openssl-dgst </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-dhparam/ title=openssl-dhparam>    <span class=md-ellipsis-custom> openssl-dhparam </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-dsa/ title=openssl-dsa>    <span class=md-ellipsis-custom> openssl-dsa </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-dsaparam/ title=openssl-dsaparam>    <span class=md-ellipsis-custom> openssl-dsaparam </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-ec/ title=openssl-ec>    <span class=md-ellipsis-custom> openssl-ec </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-ecparam/ title=openssl-ecparam>    <span class=md-ellipsis-custom> openssl-ecparam </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-enc/ title=openssl-enc>    <span class=md-ellipsis-custom> openssl-enc </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-engine/ title=openssl-engine>    <span class=md-ellipsis-custom> openssl-engine </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-errstr/ title=openssl-errstr>    <span class=md-ellipsis-custom> openssl-errstr </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-fipsinstall/ title=openssl-fipsinstall>    <span class=md-ellipsis-custom> openssl-fipsinstall </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-format-options/ title=openssl-format-options>    <span class=md-ellipsis-custom> openssl-format-options </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-gendsa/ title=openssl-gendsa>    <span class=md-ellipsis-custom> openssl-gendsa </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-genpkey/ title=openssl-genpkey>    <span class=md-ellipsis-custom> openssl-genpkey </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-genrsa/ title=openssl-genrsa>    <span class=md-ellipsis-custom> openssl-genrsa </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-info/ title=openssl-info>    <span class=md-ellipsis-custom> openssl-info </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-kdf/ title=openssl-kdf>    <span class=md-ellipsis-custom> openssl-kdf </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-list/ title=openssl-list>    <span class=md-ellipsis-custom> openssl-list </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-mac/ title=openssl-mac>    <span class=md-ellipsis-custom> openssl-mac </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-namedisplay-options/ title=openssl-namedisplay-options>    <span class=md-ellipsis-custom> openssl-namedisplay-options </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-nseq/ title=openssl-nseq>    <span class=md-ellipsis-custom> openssl-nseq </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-ocsp/ title=openssl-ocsp>    <span class=md-ellipsis-custom> openssl-ocsp </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-passphrase-options/ title=openssl-passphrase-options>    <span class=md-ellipsis-custom> openssl-passphrase-options </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-passwd/ title=openssl-passwd>    <span class=md-ellipsis-custom> openssl-passwd </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-pkcs12/ title=openssl-pkcs12>    <span class=md-ellipsis-custom> openssl-pkcs12 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-pkcs7/ title=openssl-pkcs7>    <span class=md-ellipsis-custom> openssl-pkcs7 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-pkcs8/ title=openssl-pkcs8>    <span class=md-ellipsis-custom> openssl-pkcs8 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-pkey/ title=openssl-pkey>    <span class=md-ellipsis-custom> openssl-pkey </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-pkeyparam/ title=openssl-pkeyparam>    <span class=md-ellipsis-custom> openssl-pkeyparam </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-pkeyutl/ title=openssl-pkeyutl>    <span class=md-ellipsis-custom> openssl-pkeyutl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-prime/ title=openssl-prime>    <span class=md-ellipsis-custom> openssl-prime </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-rand/ title=openssl-rand>    <span class=md-ellipsis-custom> openssl-rand </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-rehash/ title=openssl-rehash>    <span class=md-ellipsis-custom> openssl-rehash </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-req/ title=openssl-req>    <span class=md-ellipsis-custom> openssl-req </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-rsa/ title=openssl-rsa>    <span class=md-ellipsis-custom> openssl-rsa </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-rsautl/ title=openssl-rsautl>    <span class=md-ellipsis-custom> openssl-rsautl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-s_client/ title=openssl-s_client>    <span class=md-ellipsis-custom> openssl-s_client </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-s_server/ title=openssl-s_server>    <span class=md-ellipsis-custom> openssl-s_server </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-s_time/ title=openssl-s_time>    <span class=md-ellipsis-custom> openssl-s_time </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-sess_id/ title=openssl-sess_id>    <span class=md-ellipsis-custom> openssl-sess_id </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-smime/ title=openssl-smime>    <span class=md-ellipsis-custom> openssl-smime </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-speed/ title=openssl-speed>    <span class=md-ellipsis-custom> openssl-speed </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-spkac/ title=openssl-spkac>    <span class=md-ellipsis-custom> openssl-spkac </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-srp/ title=openssl-srp>    <span class=md-ellipsis-custom> openssl-srp </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-storeutl/ title=openssl-storeutl>    <span class=md-ellipsis-custom> openssl-storeutl </span>  </a><li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id=__toc type=checkbox>   <label class="md-nav__link md-nav__link--active" for=__toc>   <span class=md-ellipsis-custom> openssl-ts </span>  <span class="md-nav__icon md-icon"></span></label> <a class="md-nav__link md-nav__link--active" href=./>    <span class=md-ellipsis-custom> openssl-ts </span>  </a>  <nav aria-label="Table of contents" class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#name> <span class=md-ellipsis> NAME </span> </a><li class=md-nav__item><a class=md-nav__link href=#synopsis> <span class=md-ellipsis> SYNOPSIS </span> </a><li class=md-nav__item><a class=md-nav__link href=#description> <span class=md-ellipsis> DESCRIPTION </span> </a><li class=md-nav__item><a class=md-nav__link href=#options> <span class=md-ellipsis> OPTIONS </span> </a> <nav aria-label=OPTIONS class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#timestamp-request-generation> <span class=md-ellipsis> Timestamp Request generation </span> </a><li class=md-nav__item><a class=md-nav__link href=#timestamp-response-generation> <span class=md-ellipsis> Timestamp Response generation </span> </a><li class=md-nav__item><a class=md-nav__link href=#timestamp-response-verification> <span class=md-ellipsis> Timestamp Response verification </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#configuration-file-options> <span class=md-ellipsis> CONFIGURATION FILE OPTIONS </span> </a><li class=md-nav__item><a class=md-nav__link href=#examples> <span class=md-ellipsis> EXAMPLES </span> </a> <nav aria-label=EXAMPLES class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#timestamp-request> <span class=md-ellipsis> Timestamp Request </span> </a><li class=md-nav__item><a class=md-nav__link href=#timestamp-response> <span class=md-ellipsis> Timestamp Response </span> </a><li class=md-nav__item><a class=md-nav__link href=#timestamp-verification> <span class=md-ellipsis> Timestamp Verification </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#bugs> <span class=md-ellipsis> BUGS </span> </a><li class=md-nav__item><a class=md-nav__link href=#history> <span class=md-ellipsis> HISTORY </span> </a><li class=md-nav__item><a class=md-nav__link href=#see-also> <span class=md-ellipsis> SEE ALSO </span> </a><li class=md-nav__item><a class=md-nav__link href=#copyright> <span class=md-ellipsis> COPYRIGHT </span> </a></ul></nav><li class=md-nav__item> <a class=md-nav__link href=../openssl-verification-options/ title=openssl-verification-options>    <span class=md-ellipsis-custom> openssl-verification-options </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-verify/ title=openssl-verify>    <span class=md-ellipsis-custom> openssl-verify </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-version/ title=openssl-version>    <span class=md-ellipsis-custom> openssl-version </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-x509/ title=openssl-x509>    <span class=md-ellipsis-custom> openssl-x509 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=passwd>    <span class=md-ellipsis-custom> passwd </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=pkcs12>    <span class=md-ellipsis-custom> pkcs12 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=pkcs7>    <span class=md-ellipsis-custom> pkcs7 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=pkcs8>    <span class=md-ellipsis-custom> pkcs8 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=pkey>    <span class=md-ellipsis-custom> pkey </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=pkeyparam>    <span class=md-ellipsis-custom> pkeyparam </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=pkeyutl>    <span class=md-ellipsis-custom> pkeyutl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=prime>    <span class=md-ellipsis-custom> prime </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=rand>    <span class=md-ellipsis-custom> rand </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=rehash>    <span class=md-ellipsis-custom> rehash </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=req>    <span class=md-ellipsis-custom> req </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=rsa>    <span class=md-ellipsis-custom> rsa </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=rsautl>    <span class=md-ellipsis-custom> rsautl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=s_client>    <span class=md-ellipsis-custom> s_client </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=s_server>    <span class=md-ellipsis-custom> s_server </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=s_time>    <span class=md-ellipsis-custom> s_time </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=sess_id>    <span class=md-ellipsis-custom> sess_id </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=smime>    <span class=md-ellipsis-custom> smime </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=speed>    <span class=md-ellipsis-custom> speed </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=spkac>    <span class=md-ellipsis-custom> spkac </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=srp>    <span class=md-ellipsis-custom> srp </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=storeutl>    <span class=md-ellipsis-custom> storeutl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=ts>    <span class=md-ellipsis-custom> ts </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../tsget/ title=tsget>    <span class=md-ellipsis-custom> tsget </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=verify>    <span class=md-ellipsis-custom> verify </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=version>    <span class=md-ellipsis-custom> version </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=x509>    <span class=md-ellipsis-custom> x509 </span>  </a></ul></nav> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class=md-nav__link href=../../man3/>    <span class=md-ellipsis-custom> Libraries </span>   <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class=md-nav__link href=../../man5/>    <span class=md-ellipsis-custom> File Formats </span>   <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class=md-nav__link href=../../man7/>    <span class=md-ellipsis-custom> Overviews </span>   <span class="md-nav__icon md-icon"></span> </a></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav aria-label="Table of contents" class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#name> <span class=md-ellipsis> NAME </span> </a><li class=md-nav__item><a class=md-nav__link href=#synopsis> <span class=md-ellipsis> SYNOPSIS </span> </a><li class=md-nav__item><a class=md-nav__link href=#description> <span class=md-ellipsis> DESCRIPTION </span> </a><li class=md-nav__item><a class=md-nav__link href=#options> <span class=md-ellipsis> OPTIONS </span> </a> <nav aria-label=OPTIONS class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#timestamp-request-generation> <span class=md-ellipsis> Timestamp Request generation </span> </a><li class=md-nav__item><a class=md-nav__link href=#timestamp-response-generation> <span class=md-ellipsis> Timestamp Response generation </span> </a><li class=md-nav__item><a class=md-nav__link href=#timestamp-response-verification> <span class=md-ellipsis> Timestamp Response verification </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#configuration-file-options> <span class=md-ellipsis> CONFIGURATION FILE OPTIONS </span> </a><li class=md-nav__item><a class=md-nav__link href=#examples> <span class=md-ellipsis> EXAMPLES </span> </a> <nav aria-label=EXAMPLES class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#timestamp-request> <span class=md-ellipsis> Timestamp Request </span> </a><li class=md-nav__item><a class=md-nav__link href=#timestamp-response> <span class=md-ellipsis> Timestamp Response </span> </a><li class=md-nav__item><a class=md-nav__link href=#timestamp-verification> <span class=md-ellipsis> Timestamp Verification </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#bugs> <span class=md-ellipsis> BUGS </span> </a><li class=md-nav__item><a class=md-nav__link href=#history> <span class=md-ellipsis> HISTORY </span> </a><li class=md-nav__item><a class=md-nav__link href=#see-also> <span class=md-ellipsis> SEE ALSO </span> </a><li class=md-nav__item><a class=md-nav__link href=#copyright> <span class=md-ellipsis> COPYRIGHT </span> </a></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><h1 id=openssl-ts>openssl-ts<a title="Permanent link" class=headerlink href=#openssl-ts>¶</a></h1><h2 id=name>NAME<a title="Permanent link" class=headerlink href=#name>¶</a></h2><p>openssl-ts - Time Stamping Authority command<h2 id=synopsis>SYNOPSIS<a title="Permanent link" class=headerlink href=#synopsis>¶</a></h2><p><strong>openssl</strong> <strong>ts</strong> <strong>-help</strong><p><strong>openssl</strong> <strong>ts</strong> <strong>-query</strong> [<strong>-config</strong> <em>configfile</em>] [<strong>-data</strong> <em>file_to_hash</em>] [<strong>-digest</strong> <em>digest_bytes</em>] [<strong>-<em>digest</em></strong>] [<strong>-tspolicy</strong> <em>object_id</em>] [<strong>-no_nonce</strong>] [<strong>-cert</strong>] [<strong>-in</strong> <em>request.tsq</em>] [<strong>-out</strong> <em>request.tsq</em>] [<strong>-text</strong>] [<strong>-rand</strong> <em>files</em>] [<strong>-writerand</strong> <em>file</em>] [<strong>-provider</strong> <em>name</em>] [<strong>-provider-path</strong> <em>path</em>] [<strong>-propquery</strong> <em>propq</em>]<p><strong>openssl</strong> <strong>ts</strong> <strong>-reply</strong> [<strong>-config</strong> <em>configfile</em>] [<strong>-section</strong> <em>tsa_section</em>] [<strong>-queryfile</strong> <em>request.tsq</em>] [<strong>-passin</strong> <em>password_src</em>] [<strong>-signer</strong> <em>tsa_cert.pem</em>] [<strong>-inkey</strong> <em>filename</em>|<em>uri</em>] [<strong>-<em>digest</em></strong>] [<strong>-chain</strong> <em>certs_file.pem</em>] [<strong>-tspolicy</strong> <em>object_id</em>] [<strong>-in</strong> <em>response.tsr</em>] [<strong>-token_in</strong>] [<strong>-out</strong> <em>response.tsr</em>] [<strong>-token_out</strong>] [<strong>-text</strong>] [<strong>-engine</strong> <em>id</em>] [<strong>-provider</strong> <em>name</em>] [<strong>-provider-path</strong> <em>path</em>] [<strong>-propquery</strong> <em>propq</em>]<p><strong>openssl</strong> <strong>ts</strong> <strong>-verify</strong> [<strong>-data</strong> <em>file_to_hash</em>] [<strong>-digest</strong> <em>digest_bytes</em>] [<strong>-queryfile</strong> <em>request.tsq</em>] [<strong>-in</strong> <em>response.tsr</em>] [<strong>-token_in</strong>] [<strong>-untrusted</strong> <em>files</em>|<em>uris</em>] [<strong>-CAfile</strong> <em>file</em>] [<strong>-CApath</strong> <em>dir</em>] [<strong>-CAstore</strong> <em>uri</em>] [<strong>-allow_proxy_certs</strong>] [<strong>-attime</strong> <em>timestamp</em>] [<strong>-no_check_time</strong>] [<strong>-check_ss_sig</strong>] [<strong>-crl_check</strong>] [<strong>-crl_check_all</strong>] [<strong>-explicit_policy</strong>] [<strong>-extended_crl</strong>] [<strong>-ignore_critical</strong>] [<strong>-inhibit_any</strong>] [<strong>-inhibit_map</strong>] [<strong>-partial_chain</strong>] [<strong>-policy</strong> <em>arg</em>] [<strong>-policy_check</strong>] [<strong>-policy_print</strong>] [<strong>-purpose</strong> <em>purpose</em>] [<strong>-suiteB_128</strong>] [<strong>-suiteB_128_only</strong>] [<strong>-suiteB_192</strong>] [<strong>-trusted_first</strong>] [<strong>-no_alt_chains</strong>] [<strong>-use_deltas</strong>] [<strong>-auth_level</strong> <em>num</em>] [<strong>-verify_depth</strong> <em>num</em>] [<strong>-verify_email</strong> <em>email</em>] [<strong>-verify_hostname</strong> <em>hostname</em>] [<strong>-verify_ip</strong> <em>ip</em>] [<strong>-verify_name</strong> <em>name</em>] [<strong>-x509_strict</strong>] [<strong>-issuer_checks</strong>] [<strong>-provider</strong> <em>name</em>] [<strong>-provider-path</strong> <em>path</em>] [<strong>-propquery</strong> <em>propq</em>]<h2 id=description>DESCRIPTION<a title="Permanent link" class=headerlink href=#description>¶</a></h2><p>This command is a basic Time Stamping Authority (TSA) client and server application as specified in RFC 3161 (Time-Stamp Protocol, TSP). A TSA can be part of a PKI deployment and its role is to provide long term proof of the existence of a certain datum before a particular time. Here is a brief description of the protocol:<ol><li>The TSA client computes a one-way hash value for a data file and sends the hash to the TSA.<li>The TSA attaches the current date and time to the received hash value, signs them and sends the timestamp token back to the client. By creating this token the TSA certifies the existence of the original data file at the time of response generation.<li>The TSA client receives the timestamp token and verifies the signature on it. It also checks if the token contains the same hash value that it had sent to the TSA.</ol><p>There is one DER encoded protocol data unit defined for transporting a timestamp request to the TSA and one for sending the timestamp response back to the client. This command has three main functions: creating a timestamp request based on a data file, creating a timestamp response based on a request, verifying if a response corresponds to a particular request or a data file.<p>There is no support for sending the requests/responses automatically over HTTP or TCP yet as suggested in RFC 3161. The users must send the requests either by ftp or e-mail.<h2 id=options>OPTIONS<a title="Permanent link" class=headerlink href=#options>¶</a></h2><ul><li><strong>-help</strong></ul><p>Print out a usage message.<ul><li><strong>-query</strong></ul><p>Generate a TS query. For details see <a href=#timestamp-request-generation>"Timestamp Request generation"</a>.<ul><li><strong>-reply</strong></ul><p>Generate a TS reply. For details see <a href=#timestamp-response-generation>"Timestamp Response generation"</a>.<ul><li><strong>-verify</strong></ul><p>Verify a TS response. For details see <a href=#timestamp-response-verification>"Timestamp Response verification"</a>.<h3 id=timestamp-request-generation>Timestamp Request generation<a title="Permanent link" class=headerlink href=#timestamp-request-generation>¶</a></h3><p>The <strong>-query</strong> command can be used for creating and printing a timestamp request with the following options:<ul><li><strong>-config</strong> <em>configfile</em></ul><p>The configuration file to use. Optional; for a description of the default value, see <a href=../../man1/openssl>"COMMAND SUMMARY" in openssl(1)</a>.<ul><li><strong>-data</strong> <em>file_to_hash</em></ul><p>The data file for which the timestamp request needs to be created. stdin is the default if neither the <strong>-data</strong> nor the <strong>-digest</strong> parameter is specified. (Optional)<ul><li><strong>-digest</strong> <em>digest_bytes</em></ul><p>It is possible to specify the message imprint explicitly without the data file. The imprint must be specified in a hexadecimal format, two characters per byte, the bytes optionally separated by colons (e.g. 1A:F6:01:... or 1AF601...). The number of bytes must match the message digest algorithm in use. (Optional)<ul><li><strong>-<em>digest</em></strong></ul><p>The message digest to apply to the data file. Any digest supported by the <a href=../../man1/openssl-dgst>openssl-dgst(1)</a> command can be used. The default is SHA-256. (Optional)<ul><li><strong>-tspolicy</strong> <em>object_id</em></ul><p>The policy that the client expects the TSA to use for creating the timestamp token. Either the dotted OID notation or OID names defined in the config file can be used. If no policy is requested the TSA will use its own default policy. (Optional)<ul><li><strong>-no_nonce</strong></ul><p>No nonce is specified in the request if this option is given. Otherwise, a 64-bit long pseudo-random nonce is included in the request. It is recommended to use a nonce to protect against replay attacks. (Optional)<ul><li><strong>-cert</strong></ul><p>The TSA is expected to include its signing certificate in the response. (Optional)<ul><li><strong>-in</strong> <em>request.tsq</em></ul><p>This option specifies a previously created timestamp request in DER format that will be printed into the output file. Useful when you need to examine the content of a request in human-readable format. (Optional)<ul><li><strong>-out</strong> <em>request.tsq</em></ul><p>Name of the output file to which the request will be written. Default is stdout. (Optional)<ul><li><strong>-text</strong></ul><p>If this option is specified the output is human-readable text format instead of DER. (Optional)<ul><li><strong>-rand</strong> <em>files</em>, <strong>-writerand</strong> <em>file</em></ul><p>See <a href=../../man1/openssl>"Random State Options" in openssl(1)</a> for details.<h3 id=timestamp-response-generation>Timestamp Response generation<a title="Permanent link" class=headerlink href=#timestamp-response-generation>¶</a></h3><p>A timestamp response (TimeStampResp) consists of a response status and the timestamp token itself (ContentInfo), if the token generation was successful. The <strong>-reply</strong> command is for creating a timestamp response or timestamp token based on a request and printing the response/token in human-readable format. If <strong>-token_out</strong> is not specified the output is always a timestamp response (TimeStampResp), otherwise it is a timestamp token (ContentInfo).<ul><li><strong>-config</strong> <em>configfile</em></ul><p>The configuration file to use. Optional; for a description of the default value, see <a href=../../man1/openssl>"COMMAND SUMMARY" in openssl(1)</a>. See <a href=#configuration-file-options>"CONFIGURATION FILE OPTIONS"</a> for configurable variables.<ul><li><strong>-section</strong> <em>tsa_section</em></ul><p>The name of the config file section containing the settings for the response generation. If not specified the default TSA section is used, see <a href=#configuration-file-options>"CONFIGURATION FILE OPTIONS"</a> for details. (Optional)<ul><li><strong>-queryfile</strong> <em>request.tsq</em></ul><p>The name of the file containing a DER encoded timestamp request. (Optional)<ul><li><strong>-passin</strong> <em>password_src</em></ul><p>Specifies the password source for the private key of the TSA. See description in <a href=../../man1/openssl>openssl(1)</a>. (Optional)<ul><li><strong>-signer</strong> <em>tsa_cert.pem</em></ul><p>The signer certificate of the TSA in PEM format. The TSA signing certificate must have exactly one extended key usage assigned to it: timeStamping. The extended key usage must also be critical, otherwise the certificate is going to be refused. Overrides the <strong>signer_cert</strong> variable of the config file. (Optional)<ul><li><strong>-inkey</strong> <em>filename</em>|<em>uri</em></ul><p>The signer private key of the TSA in PEM format. Overrides the <strong>signer_key</strong> config file option. (Optional)<ul><li><strong>-<em>digest</em></strong></ul><p>Signing digest to use. Overrides the <strong>signer_digest</strong> config file option. (Mandatory unless specified in the config file)<ul><li><strong>-chain</strong> <em>certs_file.pem</em></ul><p>The collection of certificates in PEM format that will all be included in the response in addition to the signer certificate if the <strong>-cert</strong> option was used for the request. This file is supposed to contain the certificate chain for the signer certificate from its issuer upwards. The <strong>-reply</strong> command does not build a certificate chain automatically. (Optional)<ul><li><strong>-tspolicy</strong> <em>object_id</em></ul><p>The default policy to use for the response unless the client explicitly requires a particular TSA policy. The OID can be specified either in dotted notation or with its name. Overrides the <strong>default_policy</strong> config file option. (Optional)<ul><li><strong>-in</strong> <em>response.tsr</em></ul><p>Specifies a previously created timestamp response or timestamp token (if <strong>-token_in</strong> is also specified) in DER format that will be written to the output file. This option does not require a request, it is useful e.g. when you need to examine the content of a response or token or you want to extract the timestamp token from a response. If the input is a token and the output is a timestamp response a default 'granted' status info is added to the token. (Optional)<ul><li><strong>-token_in</strong></ul><p>This flag can be used together with the <strong>-in</strong> option and indicates that the input is a DER encoded timestamp token (ContentInfo) instead of a timestamp response (TimeStampResp). (Optional)<ul><li><strong>-out</strong> <em>response.tsr</em></ul><p>The response is written to this file. The format and content of the file depends on other options (see <strong>-text</strong>, <strong>-token_out</strong>). The default is stdout. (Optional)<ul><li><strong>-token_out</strong></ul><p>The output is a timestamp token (ContentInfo) instead of timestamp response (TimeStampResp). (Optional)<ul><li><strong>-text</strong></ul><p>If this option is specified the output is human-readable text format instead of DER. (Optional)<ul><li><strong>-engine</strong> <em>id</em></ul><p>See <a href=../../man1/openssl>"Engine Options" in openssl(1)</a>. This option is deprecated.<ul><li><strong>-provider</strong> <em>name</em><li><strong>-provider-path</strong> <em>path</em><li><strong>-propquery</strong> <em>propq</em></ul><p>See <a href=../../man1/openssl>"Provider Options" in openssl(1)</a>, <a href=../../man7/provider>provider(7)</a>, and <a href=../../man7/property>property(7)</a>.<h3 id=timestamp-response-verification>Timestamp Response verification<a title="Permanent link" class=headerlink href=#timestamp-response-verification>¶</a></h3><p>The <strong>-verify</strong> command is for verifying if a timestamp response or timestamp token is valid and matches a particular timestamp request or data file. The <strong>-verify</strong> command does not use the configuration file.<ul><li><strong>-data</strong> <em>file_to_hash</em></ul><p>The response or token must be verified against file_to_hash. The file is hashed with the message digest algorithm specified in the token. The <strong>-digest</strong> and <strong>-queryfile</strong> options must not be specified with this one. (Optional)<ul><li><strong>-digest</strong> <em>digest_bytes</em></ul><p>The response or token must be verified against the message digest specified with this option. The number of bytes must match the message digest algorithm specified in the token. The <strong>-data</strong> and <strong>-queryfile</strong> options must not be specified with this one. (Optional)<ul><li><strong>-queryfile</strong> <em>request.tsq</em></ul><p>The original timestamp request in DER format. The <strong>-data</strong> and <strong>-digest</strong> options must not be specified with this one. (Optional)<ul><li><strong>-in</strong> <em>response.tsr</em></ul><p>The timestamp response that needs to be verified in DER format. (Mandatory)<ul><li><strong>-token_in</strong></ul><p>This flag can be used together with the <strong>-in</strong> option and indicates that the input is a DER encoded timestamp token (ContentInfo) instead of a timestamp response (TimeStampResp). (Optional)<ul><li><strong>-untrusted</strong> <em>files</em>|<em>uris</em></ul><p>A set of additional untrusted certificates which may be needed when building the certificate chain for the TSA's signing certificate. These do not need to contain the TSA signing certificate and intermediate CA certificates as far as the response already includes them. (Optional)<p>Multiple sources may be given, separated by commas and/or whitespace. Each file may contain multiple certificates.<ul><li><strong>-CAfile</strong> <em>file</em>, <strong>-CApath</strong> <em>dir</em>, <strong>-CAstore</strong> <em>uri</em></ul><p>See <a href=../../man1/openssl-verification-options>"Trusted Certificate Options" in openssl-verification-options(1)</a> for details. At least one of <strong>-CAfile</strong>, <strong>-CApath</strong> or <strong>-CAstore</strong> must be specified.<ul><li><strong>-allow_proxy_certs</strong>, <strong>-attime</strong>, <strong>-no_check_time</strong>, <strong>-check_ss_sig</strong>, <strong>-crl_check</strong>, <strong>-crl_check_all</strong>, <strong>-explicit_policy</strong>, <strong>-extended_crl</strong>, <strong>-ignore_critical</strong>, <strong>-inhibit_any</strong>, <strong>-inhibit_map</strong>, <strong>-no_alt_chains</strong>, <strong>-partial_chain</strong>, <strong>-policy</strong>, <strong>-policy_check</strong>, <strong>-policy_print</strong>, <strong>-purpose</strong>, <strong>-suiteB_128</strong>, <strong>-suiteB_128_only</strong>, <strong>-suiteB_192</strong>, <strong>-trusted_first</strong>, <strong>-use_deltas</strong>, <strong>-auth_level</strong>, <strong>-verify_depth</strong>, <strong>-verify_email</strong>, <strong>-verify_hostname</strong>, <strong>-verify_ip</strong>, <strong>-verify_name</strong>, <strong>-x509_strict</strong> <strong>-issuer_checks</strong></ul><p>Set various options of certificate chain verification. See <a href=../../man1/openssl-verification-options>"Verification Options" in openssl-verification-options(1)</a> for details.<p>Any verification errors cause the command to exit.<h2 id=configuration-file-options>CONFIGURATION FILE OPTIONS<a title="Permanent link" class=headerlink href=#configuration-file-options>¶</a></h2><p>The <strong>-query</strong> and <strong>-reply</strong> commands make use of a configuration file. See <a href=../../man5/config/>config(5)</a> for a general description of the syntax of the config file. The <strong>-query</strong> command uses only the symbolic OID names section and it can work without it. However, the <strong>-reply</strong> command needs the config file for its operation.<p>When there is a command line switch equivalent of a variable the switch always overrides the settings in the config file.<ul><li><strong>tsa</strong> section, <strong>default_tsa</strong></ul><p>This is the main section and it specifies the name of another section that contains all the options for the <strong>-reply</strong> command. This default section can be overridden with the <strong>-section</strong> command line switch. (Optional)<ul><li><strong>oid_file</strong></ul><p>This specifies a file containing additional <strong>OBJECT IDENTIFIERS</strong>. Each line of the file should consist of the numerical form of the object identifier followed by whitespace then the short name followed by whitespace and finally the long name. (Optional)<ul><li><strong>oid_section</strong></ul><p>This specifies a section in the configuration file containing extra object identifiers. Each line should consist of the short name of the object identifier followed by <strong>=</strong> and the numerical form. The short and long names are the same when this option is used. (Optional)<ul><li><strong>RANDFILE</strong></ul><p>At startup the specified file is loaded into the random number generator, and at exit 256 bytes will be written to it. (Note: Using a RANDFILE is not necessary anymore, see the <a href=#history>"HISTORY"</a> section.<ul><li><strong>serial</strong></ul><p>The name of the file containing the hexadecimal serial number of the last timestamp response created. This number is incremented by 1 for each response. If the file does not exist at the time of response generation a new file is created with serial number 1. (Mandatory)<ul><li><strong>crypto_device</strong></ul><p>Specifies the OpenSSL engine that will be set as the default for all available algorithms. The default value is built-in, you can specify any other engines supported by OpenSSL (e.g. use chil for the NCipher HSM). (Optional)<ul><li><strong>signer_cert</strong></ul><p>TSA signing certificate in PEM format. The same as the <strong>-signer</strong> command line option. (Optional)<ul><li><strong>certs</strong></ul><p>A file containing a set of PEM encoded certificates that need to be included in the response. The same as the <strong>-chain</strong> command line option. (Optional)<ul><li><strong>signer_key</strong></ul><p>The private key of the TSA in PEM format. The same as the <strong>-inkey</strong> command line option. (Optional)<ul><li><strong>signer_digest</strong></ul><p>Signing digest to use. The same as the <strong>-<em>digest</em></strong> command line option. (Mandatory unless specified on the command line)<ul><li><strong>default_policy</strong></ul><p>The default policy to use when the request does not mandate any policy. The same as the <strong>-tspolicy</strong> command line option. (Optional)<ul><li><strong>other_policies</strong></ul><p>Comma separated list of policies that are also acceptable by the TSA and used only if the request explicitly specifies one of them. (Optional)<ul><li><strong>digests</strong></ul><p>The list of message digest algorithms that the TSA accepts. At least one algorithm must be specified. (Mandatory)<ul><li><strong>accuracy</strong></ul><p>The accuracy of the time source of the TSA in seconds, milliseconds and microseconds. E.g. secs:1, millisecs:500, microsecs:100. If any of the components is missing zero is assumed for that field. (Optional)<ul><li><strong>clock_precision_digits</strong></ul><p>Specifies the maximum number of digits, which represent the fraction of seconds, that need to be included in the time field. The trailing zeros must be removed from the time, so there might actually be fewer digits, or no fraction of seconds at all. Supported only on UNIX platforms. The maximum value is 6, default is 0. (Optional)<ul><li><strong>ordering</strong></ul><p>If this option is yes the responses generated by this TSA can always be ordered, even if the time difference between two responses is less than the sum of their accuracies. Default is no. (Optional)<ul><li><strong>tsa_name</strong></ul><p>Set this option to yes if the subject name of the TSA must be included in the TSA name field of the response. Default is no. (Optional)<ul><li><strong>ess_cert_id_chain</strong></ul><p>The SignedData objects created by the TSA always contain the certificate identifier of the signing certificate in a signed attribute (see RFC 2634, Enhanced Security Services). If this variable is set to no, only this signing certificate identifier is included in the SigningCertificate signed attribute. If this variable is set to yes and the <strong>certs</strong> variable or the <strong>-chain</strong> option is specified then the certificate identifiers of the chain will also be included, where the <strong>-chain</strong> option overrides the <strong>certs</strong> variable. Default is no. (Optional)<ul><li><strong>ess_cert_id_alg</strong></ul><p>This option specifies the hash function to be used to calculate the TSA's public key certificate identifier. Default is sha256. (Optional)<h2 id=examples>EXAMPLES<a title="Permanent link" class=headerlink href=#examples>¶</a></h2><p>All the examples below presume that <strong>OPENSSL_CONF</strong> is set to a proper configuration file, e.g. the example configuration file <code>openssl/apps/openssl.cnf</code> will do.<h3 id=timestamp-request>Timestamp Request<a title="Permanent link" class=headerlink href=#timestamp-request>¶</a></h3><p>To create a timestamp request for <code>design1.txt</code> with SHA-256 digest, without nonce and policy, and without requirement for a certificate in the response:<div class=highlight><pre><span></span><code>openssl ts -query -data design1.txt -no_nonce \
      -out design1.tsq
</code></pre></div><p>To create a similar timestamp request with specifying the message imprint explicitly:<div class=highlight><pre><span></span><code>openssl ts -query -digest b7e5d3f93198b38379852f2c04e78d73abdd0f4b \
       -no_nonce -out design1.tsq
</code></pre></div><p>To print the content of the previous request in human readable format:<div class=highlight><pre><span></span><code>openssl ts -query -in design1.tsq -text
</code></pre></div><p>To create a timestamp request which includes the SHA-512 digest of <code>design2.txt</code>, requests the signer certificate and nonce, and specifies a policy id (assuming the tsa_policy1 name is defined in the OID section of the config file):<div class=highlight><pre><span></span><code>openssl ts -query -data design2.txt -sha512 \
      -tspolicy tsa_policy1 -cert -out design2.tsq
</code></pre></div><h3 id=timestamp-response>Timestamp Response<a title="Permanent link" class=headerlink href=#timestamp-response>¶</a></h3><p>Before generating a response a signing certificate must be created for the TSA that contains the <strong>timeStamping</strong> critical extended key usage extension without any other key usage extensions. You can add this line to the user certificate section of the config file to generate a proper certificate;<div class=highlight><pre><span></span><code>extendedKeyUsage = critical,timeStamping
</code></pre></div><p>See <a href=../openssl-req/>openssl-req(1)</a>, <a href=../openssl-ca/>openssl-ca(1)</a>, and <a href=../openssl-x509/>openssl-x509(1)</a> for instructions. The examples below assume that <code>cacert.pem</code> contains the certificate of the CA, <code>tsacert.pem</code> is the signing certificate issued by <code>cacert.pem</code> and <code>tsakey.pem</code> is the private key of the TSA.<p>To create a timestamp response for a request:<div class=highlight><pre><span></span><code>openssl ts -reply -queryfile design1.tsq -inkey tsakey.pem \
      -signer tsacert.pem -out design1.tsr
</code></pre></div><p>If you want to use the settings in the config file you could just write:<div class=highlight><pre><span></span><code>openssl ts -reply -queryfile design1.tsq -out design1.tsr
</code></pre></div><p>To print a timestamp reply to stdout in human readable format:<div class=highlight><pre><span></span><code>openssl ts -reply -in design1.tsr -text
</code></pre></div><p>To create a timestamp token instead of timestamp response:<div class=highlight><pre><span></span><code>openssl ts -reply -queryfile design1.tsq -out design1_token.der -token_out
</code></pre></div><p>To print a timestamp token to stdout in human readable format:<div class=highlight><pre><span></span><code>openssl ts -reply -in design1_token.der -token_in -text -token_out
</code></pre></div><p>To extract the timestamp token from a response:<div class=highlight><pre><span></span><code>openssl ts -reply -in design1.tsr -out design1_token.der -token_out
</code></pre></div><p>To add 'granted' status info to a timestamp token thereby creating a valid response:<div class=highlight><pre><span></span><code>openssl ts -reply -in design1_token.der -token_in -out design1.tsr
</code></pre></div><h3 id=timestamp-verification>Timestamp Verification<a title="Permanent link" class=headerlink href=#timestamp-verification>¶</a></h3><p>To verify a timestamp reply against a request:<div class=highlight><pre><span></span><code>openssl ts -verify -queryfile design1.tsq -in design1.tsr \
      -CAfile cacert.pem -untrusted tsacert.pem
</code></pre></div><p>To verify a timestamp reply that includes the certificate chain:<div class=highlight><pre><span></span><code>openssl ts -verify -queryfile design2.tsq -in design2.tsr \
      -CAfile cacert.pem
</code></pre></div><p>To verify a timestamp token against the original data file: openssl ts -verify -data design2.txt -in design2.tsr \ -CAfile cacert.pem<p>To verify a timestamp token against a message imprint: openssl ts -verify -digest b7e5d3f93198b38379852f2c04e78d73abdd0f4b \ -in design2.tsr -CAfile cacert.pem<p>You could also look at the 'test' directory for more examples.<h2 id=bugs>BUGS<a title="Permanent link" class=headerlink href=#bugs>¶</a></h2><ul><li>No support for timestamps over SMTP, though it is quite easy to implement an automatic e-mail based TSA with <a href=../../man1/procmail>procmail(1)</a> and <a href=../../man1/perl>perl(1)</a>. HTTP server support is provided in the form of a separate apache module. HTTP client support is provided by <a href=../../man1/tsget>tsget(1)</a>. Pure TCP/IP protocol is not supported.<li>The file containing the last serial number of the TSA is not locked when being read or written. This is a problem if more than one instance of <a href=../../man1/openssl>openssl(1)</a> is trying to create a timestamp response at the same time. This is not an issue when using the apache server module, it does proper locking.<li>Look for the FIXME word in the source files.<li>The source code should really be reviewed by somebody else, too.<li>More testing is needed, I have done only some basic tests (see test/testtsa).</ul><h2 id=history>HISTORY<a title="Permanent link" class=headerlink href=#history>¶</a></h2><p>OpenSSL 1.1.1 introduced a new random generator (CSPRNG) with an improved seeding mechanism. The new seeding mechanism makes it unnecessary to define a RANDFILE for saving and restoring randomness. This option is retained mainly for compatibility reasons.<p>The <strong>-engine</strong> option was deprecated in OpenSSL 3.0.<h2 id=see-also>SEE ALSO<a title="Permanent link" class=headerlink href=#see-also>¶</a></h2><p><a href=../openssl/>openssl(1)</a>, <a href=../tsget/>tsget(1)</a>, <a href=../openssl-req/>openssl-req(1)</a>, <a href=../openssl-x509/>openssl-x509(1)</a>, <a href=../openssl-ca/>openssl-ca(1)</a>, <a href=../openssl-genrsa/>openssl-genrsa(1)</a>, <a href=../../man5/config/>config(5)</a>, <a href=../../man7/ossl_store-file/>ossl_store-file(7)</a><h2 id=copyright>COPYRIGHT<a title="Permanent link" class=headerlink href=#copyright>¶</a></h2><p>Copyright 2006-2024 The OpenSSL Project Authors. All Rights Reserved.<p>Licensed under the Apache License 2.0 (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at <a href=https://www.openssl.org/source/license.html>https://www.openssl.org/source/license.html</a>.</article></div><script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script></div></main><footer class=md-footer><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright>Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs </a></div></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><script id=__config type=application/json>{"base": "../..", "features": ["navigation.indexes", "navigation.instant", "navigation.path", "navigation.prune", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "master", "provider": "mike"}}</script><script src=../../assets/javascripts/bundle.ad660dcc.min.js></script>