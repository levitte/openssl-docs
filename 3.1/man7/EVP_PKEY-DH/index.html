<!doctype html><html class=no-js lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><link href=https://docs.openssl.org/3.1/man7/EVP_PKEY-DH/ rel=canonical><link href=../EVP_MD-common/ rel=prev><link href=../EVP_PKEY-DSA/ rel=next><link href=../../images/favicon.ico rel=icon><meta content="mkdocs-1.6.0, mkdocs-material-9.5.27" name=generator><title>EVP_PKEY-DH - OpenSSL Documentation</title><link href=../../assets/stylesheets/main.6543a935.min.css rel=stylesheet><link href=../../assets/stylesheets/palette.06af60db.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href=../../stylesheets/extra.css rel=stylesheet><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><body data-md-color-accent=light-blue data-md-color-primary=blue-grey data-md-color-scheme=default dir=ltr><input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox><input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox><label class=md-overlay for=__drawer></label><div data-md-component=skip><a class=md-skip href=#evp_pkey-dh> Skip to content </a></div><div data-md-component=announce></div><div data-md-color-scheme=default data-md-component=outdated hidden></div><header class="md-header md-header--shadow md-header--lifted" data-md-component=header><nav class="md-header__inner md-grid" aria-label=Header><a aria-label="OpenSSL Documentation" class="md-header__button md-logo" title="OpenSSL Documentation" data-md-component=logo href=../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a><label class="md-header__button md-icon" for=__drawer><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> OpenSSL Documentation </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> EVP_PKEY-DH </span></div></div></div><form class=md-header__option data-md-component=palette><input aria-label="Switch to dark mode" class=md-option data-md-color-accent=light-blue data-md-color-media data-md-color-primary=blue-grey data-md-color-scheme=default id=__palette_0 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg></label><input aria-label="Switch to light mode" class=md-option data-md-color-accent=light-blue data-md-color-media data-md-color-primary=black data-md-color-scheme=slate id=__palette_1 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg></label></form><script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script><label class="md-header__button md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input aria-label=Search autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=Search required spellcheck=false><label class="md-search__icon md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg></label><nav aria-label=Search class=md-search__options><button class="md-search__icon md-icon" aria-label=Clear tabindex=-1 title=Clear type=reset><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg></button></nav><div class=md-search__suggest data-md-component=search-suggest></div></form><div class=md-search__output><div class=md-search__scrollwrap data-md-scrollfix tabindex=0><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta>Initializing search</div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a title="Go to repository" class=md-source data-md-component=source href=https://github.com/openssl/openssl> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div> <div class=md-source__repository>GitHub</div> </a></div></nav><nav aria-label=Tabs class=md-tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a class=md-tabs__link href=../..> Home </a><li class=md-tabs__item><a class=md-tabs__link href=../../fips/> FIPS-140 </a><li class=md-tabs__item><a class=md-tabs__link href=../../man1/> Commands </a><li class=md-tabs__item><a class=md-tabs__link href=../../man3/> Libraries </a><li class=md-tabs__item><a class=md-tabs__link href=../../man5/> File Formats </a><li class="md-tabs__item md-tabs__item--active"><a class=md-tabs__link href=../> Overviews </a></ul></div></nav></header><div class=md-container data-md-component=container><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0><label class=md-nav__title for=__drawer><a aria-label="OpenSSL Documentation" class="md-nav__button md-logo" title="OpenSSL Documentation" data-md-component=logo href=../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> OpenSSL Documentation</label><div class=md-nav__source><a title="Go to repository" class=md-source data-md-component=source href=https://github.com/openssl/openssl> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div> <div class=md-source__repository>GitHub</div> </a></div><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item> <a class=md-nav__link href=../.. title=Home>    <span class=md-ellipsis-custom> Home </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../../fips/ title=FIPS-140>    <span class=md-ellipsis-custom> FIPS-140 </span>  </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class=md-nav__link href=../../man1/>    <span class=md-ellipsis-custom> Commands </span>   <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class=md-nav__link href=../../man3/>    <span class=md-ellipsis-custom> Libraries </span>   <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class=md-nav__link href=../../man5/>    <span class=md-ellipsis-custom> File Formats </span>   <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">  <input class="md-nav__toggle md-toggle" checked id=__nav_6 type=checkbox>  <div class="md-nav__link md-nav__container"><a class=md-nav__link href=../>    <span class=md-ellipsis-custom> Overviews </span>  </a><label class=md-nav__link for=__nav_6 id=__nav_6_label><span class="md-nav__icon md-icon"></span></label></div>  <nav aria-expanded=true aria-labelledby=__nav_6_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_6><span class="md-nav__icon md-icon"></span> Overviews</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item> <a class=md-nav__link href=../EVP_ASYM_CIPHER-RSA/ title=EVP_ASYM_CIPHER-RSA>    <span class=md-ellipsis-custom> EVP_ASYM_CIPHER-RSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_ASYM_CIPHER-SM2/ title=EVP_ASYM_CIPHER-SM2>    <span class=md-ellipsis-custom> EVP_ASYM_CIPHER-SM2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-AES/ title=EVP_CIPHER-AES>    <span class=md-ellipsis-custom> EVP_CIPHER-AES </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-ARIA/ title=EVP_CIPHER-ARIA>    <span class=md-ellipsis-custom> EVP_CIPHER-ARIA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-BLOWFISH/ title=EVP_CIPHER-BLOWFISH>    <span class=md-ellipsis-custom> EVP_CIPHER-BLOWFISH </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-CAMELLIA/ title=EVP_CIPHER-CAMELLIA>    <span class=md-ellipsis-custom> EVP_CIPHER-CAMELLIA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-CAST/ title=EVP_CIPHER-CAST>    <span class=md-ellipsis-custom> EVP_CIPHER-CAST </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-CHACHA/ title=EVP_CIPHER-CHACHA>    <span class=md-ellipsis-custom> EVP_CIPHER-CHACHA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-DES/ title=EVP_CIPHER-DES>    <span class=md-ellipsis-custom> EVP_CIPHER-DES </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-IDEA/ title=EVP_CIPHER-IDEA>    <span class=md-ellipsis-custom> EVP_CIPHER-IDEA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-NULL/ title=EVP_CIPHER-NULL>    <span class=md-ellipsis-custom> EVP_CIPHER-NULL </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-RC2/ title=EVP_CIPHER-RC2>    <span class=md-ellipsis-custom> EVP_CIPHER-RC2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-RC4/ title=EVP_CIPHER-RC4>    <span class=md-ellipsis-custom> EVP_CIPHER-RC4 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-RC5/ title=EVP_CIPHER-RC5>    <span class=md-ellipsis-custom> EVP_CIPHER-RC5 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-SEED/ title=EVP_CIPHER-SEED>    <span class=md-ellipsis-custom> EVP_CIPHER-SEED </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_CIPHER-SM4/ title=EVP_CIPHER-SM4>    <span class=md-ellipsis-custom> EVP_CIPHER-SM4 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-HKDF/ title=EVP_KDF-HKDF>    <span class=md-ellipsis-custom> EVP_KDF-HKDF </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-KB/ title=EVP_KDF-KB>    <span class=md-ellipsis-custom> EVP_KDF-KB </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-KRB5KDF/ title=EVP_KDF-KRB5KDF>    <span class=md-ellipsis-custom> EVP_KDF-KRB5KDF </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-PBKDF1/ title=EVP_KDF-PBKDF1>    <span class=md-ellipsis-custom> EVP_KDF-PBKDF1 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-PBKDF2/ title=EVP_KDF-PBKDF2>    <span class=md-ellipsis-custom> EVP_KDF-PBKDF2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-PKCS12KDF/ title=EVP_KDF-PKCS12KDF>    <span class=md-ellipsis-custom> EVP_KDF-PKCS12KDF </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-SCRYPT/ title=EVP_KDF-SCRYPT>    <span class=md-ellipsis-custom> EVP_KDF-SCRYPT </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-SS/ title=EVP_KDF-SS>    <span class=md-ellipsis-custom> EVP_KDF-SS </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-SSHKDF/ title=EVP_KDF-SSHKDF>    <span class=md-ellipsis-custom> EVP_KDF-SSHKDF </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-TLS13_KDF/ title=EVP_KDF-TLS13_KDF>    <span class=md-ellipsis-custom> EVP_KDF-TLS13_KDF </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-TLS1_PRF/ title=EVP_KDF-TLS1_PRF>    <span class=md-ellipsis-custom> EVP_KDF-TLS1_PRF </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-X942-ASN1/ title=EVP_KDF-X942-ASN1>    <span class=md-ellipsis-custom> EVP_KDF-X942-ASN1 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-X942-CONCAT/ title=EVP_KDF-X942-CONCAT>    <span class=md-ellipsis-custom> EVP_KDF-X942-CONCAT </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KDF-X963/ title=EVP_KDF-X963>    <span class=md-ellipsis-custom> EVP_KDF-X963 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KEM-RSA/ title=EVP_KEM-RSA>    <span class=md-ellipsis-custom> EVP_KEM-RSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KEYEXCH-DH/ title=EVP_KEYEXCH-DH>    <span class=md-ellipsis-custom> EVP_KEYEXCH-DH </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KEYEXCH-ECDH/ title=EVP_KEYEXCH-ECDH>    <span class=md-ellipsis-custom> EVP_KEYEXCH-ECDH </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KEYEXCH-X25519/ title=EVP_KEYEXCH-X25519>    <span class=md-ellipsis-custom> EVP_KEYEXCH-X25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_KEYEXCH-X25519 title=EVP_KEYEXCH-X448>    <span class=md-ellipsis-custom> EVP_KEYEXCH-X448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-HMAC title=EVP_KEYMGMT-CMAC>    <span class=md-ellipsis-custom> EVP_KEYMGMT-CMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=. title=EVP_KEYMGMT-DH>    <span class=md-ellipsis-custom> EVP_KEYMGMT-DH </span>  </a><li class=md-nav__item> <a class=md-nav__link href=. title=EVP_KEYMGMT-DHX>    <span class=md-ellipsis-custom> EVP_KEYMGMT-DHX </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-DSA title=EVP_KEYMGMT-DSA>    <span class=md-ellipsis-custom> EVP_KEYMGMT-DSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-EC title=EVP_KEYMGMT-EC>    <span class=md-ellipsis-custom> EVP_KEYMGMT-EC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-X25519 title=EVP_KEYMGMT-ED25519>    <span class=md-ellipsis-custom> EVP_KEYMGMT-ED25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-X25519 title=EVP_KEYMGMT-ED448>    <span class=md-ellipsis-custom> EVP_KEYMGMT-ED448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-HMAC title=EVP_KEYMGMT-HMAC>    <span class=md-ellipsis-custom> EVP_KEYMGMT-HMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-HMAC title=EVP_KEYMGMT-Poly1305>    <span class=md-ellipsis-custom> EVP_KEYMGMT-Poly1305 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-RSA title=EVP_KEYMGMT-RSA>    <span class=md-ellipsis-custom> EVP_KEYMGMT-RSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-SM2 title=EVP_KEYMGMT-SM2>    <span class=md-ellipsis-custom> EVP_KEYMGMT-SM2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-HMAC title=EVP_KEYMGMT-Siphash>    <span class=md-ellipsis-custom> EVP_KEYMGMT-Siphash </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-X25519 title=EVP_KEYMGMT-X25519>    <span class=md-ellipsis-custom> EVP_KEYMGMT-X25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-X25519 title=EVP_KEYMGMT-X448>    <span class=md-ellipsis-custom> EVP_KEYMGMT-X448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-BLAKE2/ title=EVP_MAC-BLAKE2>    <span class=md-ellipsis-custom> EVP_MAC-BLAKE2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-BLAKE2 title=EVP_MAC-BLAKE2BMAC>    <span class=md-ellipsis-custom> EVP_MAC-BLAKE2BMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-BLAKE2 title=EVP_MAC-BLAKE2SMAC>    <span class=md-ellipsis-custom> EVP_MAC-BLAKE2SMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-CMAC/ title=EVP_MAC-CMAC>    <span class=md-ellipsis-custom> EVP_MAC-CMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-GMAC/ title=EVP_MAC-GMAC>    <span class=md-ellipsis-custom> EVP_MAC-GMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-HMAC/ title=EVP_MAC-HMAC>    <span class=md-ellipsis-custom> EVP_MAC-HMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-KMAC/ title=EVP_MAC-KMAC>    <span class=md-ellipsis-custom> EVP_MAC-KMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-KMAC title=EVP_MAC-KMAC128>    <span class=md-ellipsis-custom> EVP_MAC-KMAC128 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-KMAC title=EVP_MAC-KMAC256>    <span class=md-ellipsis-custom> EVP_MAC-KMAC256 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-Poly1305/ title=EVP_MAC-Poly1305>    <span class=md-ellipsis-custom> EVP_MAC-Poly1305 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MAC-Siphash/ title=EVP_MAC-Siphash>    <span class=md-ellipsis-custom> EVP_MAC-Siphash </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-BLAKE2/ title=EVP_MD-BLAKE2>    <span class=md-ellipsis-custom> EVP_MD-BLAKE2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-SHAKE title=EVP_MD-KECCAK-KMAC>    <span class=md-ellipsis-custom> EVP_MD-KECCAK-KMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-MD2/ title=EVP_MD-MD2>    <span class=md-ellipsis-custom> EVP_MD-MD2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-MD4/ title=EVP_MD-MD4>    <span class=md-ellipsis-custom> EVP_MD-MD4 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-MD5/ title=EVP_MD-MD5>    <span class=md-ellipsis-custom> EVP_MD-MD5 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-MD5-SHA1/ title=EVP_MD-MD5-SHA1>    <span class=md-ellipsis-custom> EVP_MD-MD5-SHA1 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-MDC2/ title=EVP_MD-MDC2>    <span class=md-ellipsis-custom> EVP_MD-MDC2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-NULL/ title=EVP_MD-NULL>    <span class=md-ellipsis-custom> EVP_MD-NULL </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-RIPEMD160/ title=EVP_MD-RIPEMD160>    <span class=md-ellipsis-custom> EVP_MD-RIPEMD160 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-SHA1/ title=EVP_MD-SHA1>    <span class=md-ellipsis-custom> EVP_MD-SHA1 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-SHA2/ title=EVP_MD-SHA2>    <span class=md-ellipsis-custom> EVP_MD-SHA2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-SHA3/ title=EVP_MD-SHA3>    <span class=md-ellipsis-custom> EVP_MD-SHA3 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-SHAKE/ title=EVP_MD-SHAKE>    <span class=md-ellipsis-custom> EVP_MD-SHAKE </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-SM3/ title=EVP_MD-SM3>    <span class=md-ellipsis-custom> EVP_MD-SM3 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-WHIRLPOOL/ title=EVP_MD-WHIRLPOOL>    <span class=md-ellipsis-custom> EVP_MD-WHIRLPOOL </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_MD-common/ title=EVP_MD-common>    <span class=md-ellipsis-custom> EVP_MD-common </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-HMAC title=EVP_PKEY-CMAC>    <span class=md-ellipsis-custom> EVP_PKEY-CMAC </span>  </a><li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id=__toc type=checkbox>   <label class="md-nav__link md-nav__link--active" for=__toc>   <span class=md-ellipsis-custom> EVP_PKEY-DH </span>  <span class="md-nav__icon md-icon"></span></label> <a class="md-nav__link md-nav__link--active" href=./>    <span class=md-ellipsis-custom> EVP_PKEY-DH </span>  </a>  <nav aria-label="Table of contents" class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#name> <span class=md-ellipsis> NAME </span> </a><li class=md-nav__item><a class=md-nav__link href=#description> <span class=md-ellipsis> DESCRIPTION </span> </a> <nav aria-label=DESCRIPTION class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#dh-and-dhx-domain-parameters> <span class=md-ellipsis> DH and DHX domain parameters </span> </a><li class=md-nav__item><a class=md-nav__link href=#dh-and-dhx-additional-parameters> <span class=md-ellipsis> DH and DHX additional parameters </span> </a><li class=md-nav__item><a class=md-nav__link href=#dh-additional-domain-parameters> <span class=md-ellipsis> DH additional domain parameters </span> </a><li class=md-nav__item><a class=md-nav__link href=#dh-and-dhx-domain-parameter-key-generation-parameters> <span class=md-ellipsis> DH and DHX domain parameter / key generation parameters </span> </a><li class=md-nav__item><a class=md-nav__link href=#dh-key-validation> <span class=md-ellipsis> DH key validation </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#examples> <span class=md-ellipsis> EXAMPLES </span> </a><li class=md-nav__item><a class=md-nav__link href=#conforming-to> <span class=md-ellipsis> CONFORMING TO </span> </a><li class=md-nav__item><a class=md-nav__link href=#see-also> <span class=md-ellipsis> SEE ALSO </span> </a><li class=md-nav__item><a class=md-nav__link href=#copyright> <span class=md-ellipsis> COPYRIGHT </span> </a></ul></nav><li class=md-nav__item> <a class=md-nav__link href=. title=EVP_PKEY-DHX>    <span class=md-ellipsis-custom> EVP_PKEY-DHX </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-DSA/ title=EVP_PKEY-DSA>    <span class=md-ellipsis-custom> EVP_PKEY-DSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-EC/ title=EVP_PKEY-EC>    <span class=md-ellipsis-custom> EVP_PKEY-EC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-X25519 title=EVP_PKEY-ED25519>    <span class=md-ellipsis-custom> EVP_PKEY-ED25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-X25519 title=EVP_PKEY-ED448>    <span class=md-ellipsis-custom> EVP_PKEY-ED448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-FFC/ title=EVP_PKEY-FFC>    <span class=md-ellipsis-custom> EVP_PKEY-FFC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-HMAC/ title=EVP_PKEY-HMAC>    <span class=md-ellipsis-custom> EVP_PKEY-HMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-HMAC title=EVP_PKEY-Poly1305>    <span class=md-ellipsis-custom> EVP_PKEY-Poly1305 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-RSA/ title=EVP_PKEY-RSA>    <span class=md-ellipsis-custom> EVP_PKEY-RSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-SM2/ title=EVP_PKEY-SM2>    <span class=md-ellipsis-custom> EVP_PKEY-SM2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-HMAC title=EVP_PKEY-Siphash>    <span class=md-ellipsis-custom> EVP_PKEY-Siphash </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-X25519/ title=EVP_PKEY-X25519>    <span class=md-ellipsis-custom> EVP_PKEY-X25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-X25519 title=EVP_PKEY-X448>    <span class=md-ellipsis-custom> EVP_PKEY-X448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_RAND/ title=EVP_RAND>    <span class=md-ellipsis-custom> EVP_RAND </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_RAND-CTR-DRBG/ title=EVP_RAND-CTR-DRBG>    <span class=md-ellipsis-custom> EVP_RAND-CTR-DRBG </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_RAND-HASH-DRBG/ title=EVP_RAND-HASH-DRBG>    <span class=md-ellipsis-custom> EVP_RAND-HASH-DRBG </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_RAND-HMAC-DRBG/ title=EVP_RAND-HMAC-DRBG>    <span class=md-ellipsis-custom> EVP_RAND-HMAC-DRBG </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_RAND-SEED-SRC/ title=EVP_RAND-SEED-SRC>    <span class=md-ellipsis-custom> EVP_RAND-SEED-SRC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_RAND-TEST-RAND/ title=EVP_RAND-TEST-RAND>    <span class=md-ellipsis-custom> EVP_RAND-TEST-RAND </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-HMAC title=EVP_SIGNATURE-CMAC>    <span class=md-ellipsis-custom> EVP_SIGNATURE-CMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-DSA/ title=EVP_SIGNATURE-DSA>    <span class=md-ellipsis-custom> EVP_SIGNATURE-DSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-ECDSA/ title=EVP_SIGNATURE-ECDSA>    <span class=md-ellipsis-custom> EVP_SIGNATURE-ECDSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-ED25519/ title=EVP_SIGNATURE-ED25519>    <span class=md-ellipsis-custom> EVP_SIGNATURE-ED25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-ED25519 title=EVP_SIGNATURE-ED448>    <span class=md-ellipsis-custom> EVP_SIGNATURE-ED448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-HMAC/ title=EVP_SIGNATURE-HMAC>    <span class=md-ellipsis-custom> EVP_SIGNATURE-HMAC </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-HMAC title=EVP_SIGNATURE-Poly1305>    <span class=md-ellipsis-custom> EVP_SIGNATURE-Poly1305 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-RSA/ title=EVP_SIGNATURE-RSA>    <span class=md-ellipsis-custom> EVP_SIGNATURE-RSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-HMAC title=EVP_SIGNATURE-Siphash>    <span class=md-ellipsis-custom> EVP_SIGNATURE-Siphash </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-ED25519 title=Ed25519>    <span class=md-ellipsis-custom> Ed25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_SIGNATURE-ED25519 title=Ed448>    <span class=md-ellipsis-custom> Ed448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl_user_macros title=OPENSSL_API_COMPAT>    <span class=md-ellipsis-custom> OPENSSL_API_COMPAT </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl_user_macros title=OPENSSL_NO_DEPRECATED>    <span class=md-ellipsis-custom> OPENSSL_NO_DEPRECATED </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../OSSL_PROVIDER-FIPS/ title=OSSL_PROVIDER-FIPS>    <span class=md-ellipsis-custom> OSSL_PROVIDER-FIPS </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../OSSL_PROVIDER-base/ title=OSSL_PROVIDER-base>    <span class=md-ellipsis-custom> OSSL_PROVIDER-base </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../OSSL_PROVIDER-default/ title=OSSL_PROVIDER-default>    <span class=md-ellipsis-custom> OSSL_PROVIDER-default </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../OSSL_PROVIDER-legacy/ title=OSSL_PROVIDER-legacy>    <span class=md-ellipsis-custom> OSSL_PROVIDER-legacy </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../OSSL_PROVIDER-null/ title=OSSL_PROVIDER-null>    <span class=md-ellipsis-custom> OSSL_PROVIDER-null </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../RAND/ title=RAND>    <span class=md-ellipsis-custom> RAND </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-RSA title=RSA>    <span class=md-ellipsis-custom> RSA </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../RSA-PSS/ title=RSA-PSS>    <span class=md-ellipsis-custom> RSA-PSS </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../EVP_PKEY-SM2 title=SM2>    <span class=md-ellipsis-custom> SM2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../X25519/ title=X25519>    <span class=md-ellipsis-custom> X25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../X25519 title=X448>    <span class=md-ellipsis-custom> X448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../bio/ title=bio>    <span class=md-ellipsis-custom> bio </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../crypto/ title=crypto>    <span class=md-ellipsis-custom> crypto </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ct/ title=ct>    <span class=md-ellipsis-custom> ct </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../des_modes/ title=des_modes>    <span class=md-ellipsis-custom> des_modes </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../evp/ title=evp>    <span class=md-ellipsis-custom> evp </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../fips_module/ title=fips_module>    <span class=md-ellipsis-custom> fips_module </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../life_cycle-cipher/ title=life_cycle-cipher>    <span class=md-ellipsis-custom> life_cycle-cipher </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../life_cycle-digest/ title=life_cycle-digest>    <span class=md-ellipsis-custom> life_cycle-digest </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../life_cycle-kdf/ title=life_cycle-kdf>    <span class=md-ellipsis-custom> life_cycle-kdf </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../life_cycle-mac/ title=life_cycle-mac>    <span class=md-ellipsis-custom> life_cycle-mac </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../life_cycle-pkey/ title=life_cycle-pkey>    <span class=md-ellipsis-custom> life_cycle-pkey </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../life_cycle-rand/ title=life_cycle-rand>    <span class=md-ellipsis-custom> life_cycle-rand </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../migration_guide/ title=migration_guide>    <span class=md-ellipsis-custom> migration_guide </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-core.h/ title=openssl-core.h>    <span class=md-ellipsis-custom> openssl-core.h </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-core_dispatch.h/ title=openssl-core_dispatch.h>    <span class=md-ellipsis-custom> openssl-core_dispatch.h </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-core_names.h/ title=openssl-core_names.h>    <span class=md-ellipsis-custom> openssl-core_names.h </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-env/ title=openssl-env>    <span class=md-ellipsis-custom> openssl-env </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-glossary/ title=openssl-glossary>    <span class=md-ellipsis-custom> openssl-glossary </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-threads/ title=openssl-threads>    <span class=md-ellipsis-custom> openssl-threads </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl_user_macros/ title=openssl_user_macros>    <span class=md-ellipsis-custom> openssl_user_macros </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl_store/ title=ossl_store>    <span class=md-ellipsis-custom> ossl_store </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl_store-file/ title=ossl_store-file>    <span class=md-ellipsis-custom> ossl_store-file </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../passphrase-encoding/ title=passphrase-encoding>    <span class=md-ellipsis-custom> passphrase-encoding </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../property/ title=property>    <span class=md-ellipsis-custom> property </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider/ title=provider>    <span class=md-ellipsis-custom> provider </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-asym_cipher/ title=provider-asym_cipher>    <span class=md-ellipsis-custom> provider-asym_cipher </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-base/ title=provider-base>    <span class=md-ellipsis-custom> provider-base </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-cipher/ title=provider-cipher>    <span class=md-ellipsis-custom> provider-cipher </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-decoder/ title=provider-decoder>    <span class=md-ellipsis-custom> provider-decoder </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-digest/ title=provider-digest>    <span class=md-ellipsis-custom> provider-digest </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-encoder/ title=provider-encoder>    <span class=md-ellipsis-custom> provider-encoder </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-kdf/ title=provider-kdf>    <span class=md-ellipsis-custom> provider-kdf </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-kem/ title=provider-kem>    <span class=md-ellipsis-custom> provider-kem </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-keyexch/ title=provider-keyexch>    <span class=md-ellipsis-custom> provider-keyexch </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-keymgmt/ title=provider-keymgmt>    <span class=md-ellipsis-custom> provider-keymgmt </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-mac/ title=provider-mac>    <span class=md-ellipsis-custom> provider-mac </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-object/ title=provider-object>    <span class=md-ellipsis-custom> provider-object </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-rand/ title=provider-rand>    <span class=md-ellipsis-custom> provider-rand </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-signature/ title=provider-signature>    <span class=md-ellipsis-custom> provider-signature </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../provider-storemgmt/ title=provider-storemgmt>    <span class=md-ellipsis-custom> provider-storemgmt </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../proxy-certificates/ title=proxy-certificates>    <span class=md-ellipsis-custom> proxy-certificates </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ssl/ title=ssl>    <span class=md-ellipsis-custom> ssl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../x509/ title=x509>    <span class=md-ellipsis-custom> x509 </span>  </a></ul></nav> </ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav aria-label="Table of contents" class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#name> <span class=md-ellipsis> NAME </span> </a><li class=md-nav__item><a class=md-nav__link href=#description> <span class=md-ellipsis> DESCRIPTION </span> </a> <nav aria-label=DESCRIPTION class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#dh-and-dhx-domain-parameters> <span class=md-ellipsis> DH and DHX domain parameters </span> </a><li class=md-nav__item><a class=md-nav__link href=#dh-and-dhx-additional-parameters> <span class=md-ellipsis> DH and DHX additional parameters </span> </a><li class=md-nav__item><a class=md-nav__link href=#dh-additional-domain-parameters> <span class=md-ellipsis> DH additional domain parameters </span> </a><li class=md-nav__item><a class=md-nav__link href=#dh-and-dhx-domain-parameter-key-generation-parameters> <span class=md-ellipsis> DH and DHX domain parameter / key generation parameters </span> </a><li class=md-nav__item><a class=md-nav__link href=#dh-key-validation> <span class=md-ellipsis> DH key validation </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#examples> <span class=md-ellipsis> EXAMPLES </span> </a><li class=md-nav__item><a class=md-nav__link href=#conforming-to> <span class=md-ellipsis> CONFORMING TO </span> </a><li class=md-nav__item><a class=md-nav__link href=#see-also> <span class=md-ellipsis> SEE ALSO </span> </a><li class=md-nav__item><a class=md-nav__link href=#copyright> <span class=md-ellipsis> COPYRIGHT </span> </a></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><h1 id=evp_pkey-dh>EVP_PKEY-DH<a title="Permanent link" class=headerlink href=#evp_pkey-dh>¶</a></h1><h2 id=name>NAME<a title="Permanent link" class=headerlink href=#name>¶</a></h2><p>EVP_PKEY-DH, EVP_PKEY-DHX, EVP_KEYMGMT-DH, EVP_KEYMGMT-DHX - EVP_PKEY DH and DHX keytype and algorithm support<h2 id=description>DESCRIPTION<a title="Permanent link" class=headerlink href=#description>¶</a></h2><p>For <strong>DH</strong> FFC key agreement, two classes of domain parameters can be used: "safe" domain parameters that are associated with approved named safe-prime groups, and a class of "FIPS186-type" domain parameters. FIPS186-type domain parameters should only be used for backward compatibility with existing applications that cannot be upgraded to use the approved safe-prime groups.<p>See <a href=../EVP_PKEY-FFC/>EVP_PKEY-FFC(7)</a> for more information about FFC keys.<p>The <strong>DH</strong> key type uses PKCS#3 format which saves <em>p</em> and <em>g</em>, but not the <em>q</em> value. The <strong>DHX</strong> key type uses X9.42 format which saves the value of <em>q</em> and this must be used for FIPS186-4. If key validation is required, users should be aware of the nuances associated with FIPS186-4 style parameters as discussed in <a href=#dh-key-validation>"DH key validation"</a>.<h3 id=dh-and-dhx-domain-parameters>DH and DHX domain parameters<a title="Permanent link" class=headerlink href=#dh-and-dhx-domain-parameters>¶</a></h3><p>In addition to the common FCC parameters that all FFC keytypes should support (see <a href=../EVP_PKEY-FFC/>"FFC parameters" in EVP_PKEY-FFC(7)</a>) the <strong>DHX</strong> and <strong>DH</strong> keytype implementations support the following:<ul><li>"group" (<strong>OSSL_PKEY_PARAM_GROUP_NAME</strong>) <utf8 string> <p>Sets or gets a string that associates a <strong>DH</strong> or <strong>DHX</strong> named safe prime group with known values for <em>p</em>, <em>q</em> and <em>g</em>.</p> <p>The following values can be used by the OpenSSL's default and FIPS providers: "ffdhe2048", "ffdhe3072", "ffdhe4096", "ffdhe6144", "ffdhe8192", "modp_2048", "modp_3072", "modp_4096", "modp_6144", "modp_8192".</p> <p>The following additional values can also be used by OpenSSL's default provider: "modp_1536", "dh_1024_160", "dh_2048_224", "dh_2048_256".</p> <p>DH/DHX named groups can be easily validated since the parameters are well known. For protocols that only transfer <em>p</em> and <em>g</em> the value of <em>q</em> can also be retrieved.</p> <h3 id=dh-and-dhx-additional-parameters>DH and DHX additional parameters<a title="Permanent link" class=headerlink href=#dh-and-dhx-additional-parameters>¶</a></h3> <ul><li>"encoded-pub-key" (<strong>OSSL_PKEY_PARAM_ENCODED_PUBLIC_KEY</strong>) &LToctet string></ul> <p>Used for getting and setting the encoding of the DH public key used in a key exchange message for the TLS protocol. See EVP_PKEY_set1_encoded_public_key() and EVP_PKEY_get1_encoded_public_key().</p> <h3 id=dh-additional-domain-parameters>DH additional domain parameters<a title="Permanent link" class=headerlink href=#dh-additional-domain-parameters>¶</a></h3> <ul><li>"safeprime-generator" (<strong>OSSL_PKEY_PARAM_DH_GENERATOR</strong>) &LTinteger></ul> <p>Used for DH generation of safe primes using the old safe prime generator code. The default value is 2. It is recommended to use a named safe prime group instead, if domain parameter validation is required.</p> <p>Randomly generated safe primes are not allowed by FIPS, so setting this value for the OpenSSL FIPS provider will instead choose a named safe prime group based on the size of <em>p</em>.</p> <h3 id=dh-and-dhx-domain-parameter-key-generation-parameters>DH and DHX domain parameter / key generation parameters<a title="Permanent link" class=headerlink href=#dh-and-dhx-domain-parameter-key-generation-parameters>¶</a></h3> <p>In addition to the common FFC key generation parameters that all FFC key types should support (see <a href=../EVP_PKEY-FFC/>"FFC key generation parameters" in EVP_PKEY-FFC(7)</a>) the <strong>DH</strong> and <strong>DHX</strong> keytype implementation supports the following:</p> <ul><li>"type" (<strong>OSSL_PKEY_PARAM_FFC_TYPE</strong>) <utf8 string> <p>Sets the type of parameter generation. For <strong>DH</strong> valid values are:</p> <ul><li>"fips186_4"<li>"default"<li><p>"fips186_2"</p> <p>These are described in <a href=../../man7/EVP_PKEY-FFC>"FFC key generation parameters" in EVP_PKEY-FFC(7)</a></p><li><p>"group"</p> <p>This specifies that a named safe prime name will be chosen using the "pbits" type.</p><li><p>"generator"</p> <p>A safe prime generator. See the "safeprime-generator" type above. This is only valid for <strong>DH</strong> keys.</p><li><p>"pbits" (<strong>OSSL_PKEY_PARAM_FFC_PBITS</strong>) &LTunsigned integer></p></ul> <p>Sets the size (in bits) of the prime 'p'.</p> <p>For "fips186_4" this must be 2048. For "fips186_2" this must be 1024. For "group" this can be any one of 2048, 3072, 4096, 6144 or 8192.</p> <ul><li>"priv_len" (<strong>OSSL_PKEY_PARAM_DH_PRIV_LEN</strong>) &LTinteger></ul> <p>An optional value to set the maximum length of the generated private key. The default value used if this is not set is the maximum value of BN_num_bits(<em>q</em>)). The minimum value that this can be set to is 2 * s. Where s is the security strength of the key which has values of 112, 128, 152, 176 and 200 for key sizes of 2048, 3072, 4096, 6144 and 8192.</p> <h3 id=dh-key-validation>DH key validation<a title="Permanent link" class=headerlink href=#dh-key-validation>¶</a></h3> <p>For <strong>DHX</strong> that is not a named group the FIPS186-4 standard specifies that the values used for FFC parameter generation are also required for parameter validation. This means that optional FFC domain parameter values for <em>seed</em>, <em>pcounter</em> and <em>gindex</em> or <em>hindex</em> may need to be stored for validation purposes. For <strong>DHX</strong> the <em>seed</em> and <em>pcounter</em> can be stored in ASN1 data (but the <em>gindex</em> or <em>hindex</em> cannot be stored). It is recommended to use a named safe prime group instead.</p> <p>For DH keys, <a href=../../man3/EVP_PKEY_check/>EVP_PKEY_param_check(3)</a> behaves in the following way: The OpenSSL FIPS provider tests if the parameters are either an approved safe prime group OR that the FFC parameters conform to FIPS186-4 as defined in SP800-56Ar3 <em>Assurances of Domain-Parameter Validity</em>. The OpenSSL default provider uses simpler checks that allows there to be no <em>q</em> value for backwards compatibility.</p> <p>For DH keys, <a href=../../man3/EVP_PKEY_check/>EVP_PKEY_param_check_quick(3)</a> is equivalent to <a href=../../man3/EVP_PKEY_check/>EVP_PKEY_param_check(3)</a>.</p> <p>For DH keys, <a href=../../man3/EVP_PKEY_check/>EVP_PKEY_public_check(3)</a> conforms to SP800-56Ar3 <em>FFC Full Public-Key Validation</em>.</p> <p>For DH keys, <a href=../../man3/EVP_PKEY_check/>EVP_PKEY_public_check_quick(3)</a> conforms to SP800-56Ar3 <em>FFC Partial Public-Key Validation</em> when the DH key is an approved named safe prime group, otherwise it is the same as <a href=../../man3/EVP_PKEY_check/>EVP_PKEY_public_check(3)</a>.</p> <p>For DH Keys, <a href=../../man3/EVP_PKEY_check/>EVP_PKEY_private_check(3)</a> tests that the private key is in the correct range according to SP800-56Ar3. The OpenSSL FIPS provider requires the value of <em>q</em> to be set (note that this is set for named safe prime groups). For backwards compatibility the OpenSSL default provider only requires <em>p</em> to be set.</p> <p>For DH keys, <a href=../../man3/EVP_PKEY_check/>EVP_PKEY_pairwise_check(3)</a> conforms to SP800-56Ar3 <em>Owner Assurance of Pair-wise Consistency</em>.</p> <h2 id=examples>EXAMPLES<a title="Permanent link" class=headerlink href=#examples>¶</a></h2> <p>An <strong>EVP_PKEY</strong> context can be obtained by calling:</p> <div class=highlight><pre><span></span><code>EVP_PKEY_CTX *pctx = EVP_PKEY_CTX_new_from_name(NULL, "DH", NULL);
</code></pre></div> <p>A <strong>DH</strong> key can be generated with a named safe prime group by calling:</p> <div class=highlight><pre><span></span><code>int priv_len = 2 * 112;
OSSL_PARAM params[3];
EVP_PKEY *pkey = NULL;
EVP_PKEY_CTX *pctx = EVP_PKEY_CTX_new_from_name(NULL, "DH", NULL);

params[0] = OSSL_PARAM_construct_utf8_string("group", "ffdhe2048", 0);
/* "priv_len" is optional */
params[1] = OSSL_PARAM_construct_int("priv_len", &priv_len);
params[2] = OSSL_PARAM_construct_end();

EVP_PKEY_keygen_init(pctx);
EVP_PKEY_CTX_set_params(pctx, params);
EVP_PKEY_generate(pctx, &pkey);
...
EVP_PKEY_free(pkey);
EVP_PKEY_CTX_free(pctx);
</code></pre></div> <p><strong>DHX</strong> domain parameters can be generated according to <strong>FIPS186-4</strong> by calling:</p> <div class=highlight><pre><span></span><code>int gindex = 2;
unsigned int pbits = 2048;
unsigned int qbits = 256;
OSSL_PARAM params[6];
EVP_PKEY *param_key = NULL;
EVP_PKEY_CTX *pctx = NULL;

pctx = EVP_PKEY_CTX_new_from_name(NULL, "DHX", NULL);
EVP_PKEY_paramgen_init(pctx);

params[0] = OSSL_PARAM_construct_uint("pbits", &pbits);
params[1] = OSSL_PARAM_construct_uint("qbits", &qbits);
params[2] = OSSL_PARAM_construct_int("gindex", &gindex);
params[3] = OSSL_PARAM_construct_utf8_string("type", "fips186_4", 0);
params[4] = OSSL_PARAM_construct_utf8_string("digest", "SHA256", 0);
params[5] = OSSL_PARAM_construct_end();
EVP_PKEY_CTX_set_params(pctx, params);

EVP_PKEY_generate(pctx, &ampparam_key);

EVP_PKEY_print_params(bio_out, param_key, 0, NULL);
...
EVP_PKEY_free(param_key);
EVP_PKEY_CTX_free(pctx);
</code></pre></div> <p>A <strong>DH</strong> key can be generated using domain parameters by calling:</p> <div class=highlight><pre><span></span><code>EVP_PKEY *key = NULL;
EVP_PKEY_CTX *gctx = EVP_PKEY_CTX_new_from_pkey(NULL, param_key, NULL);

EVP_PKEY_keygen_init(gctx);
EVP_PKEY_generate(gctx, &key);
EVP_PKEY_print_private(bio_out, key, 0, NULL);
...
EVP_PKEY_free(key);
EVP_PKEY_CTX_free(gctx);
</code></pre></div> <p>To validate <strong>FIPS186-4</strong> <strong>DHX</strong> domain parameters decoded from <strong>PEM</strong> or <strong>DER</strong> data, additional values used during generation may be required to be set into the key.</p> <p>EVP_PKEY_todata(), OSSL_PARAM_merge(), and EVP_PKEY_fromdata() are useful to add these parameters to the original key or domain parameters before the actual validation. In production code the return values should be checked.</p> <div class=highlight><pre><span></span><code>EVP_PKEY *received_domp = ...; /* parameters received and decoded */
unsigned char *seed = ...;     /* and additional parameters received */
size_t seedlen = ...;          /* by other means, required */
int gindex = ...;              /* for the validation */
int pcounter = ...;
int hindex = ...;
OSSL_PARAM extra_params[4];
OSSL_PARAM *domain_params = NULL;
OSSL_PARAM *merged_params = NULL;
EVP_PKEY_CTX *ctx = NULL, *validate_ctx = NULL;
EVP_PKEY *complete_domp = NULL;

EVP_PKEY_todata(received_domp, OSSL_KEYMGMT_SELECT_DOMAIN_PARAMETERS,
                &domain_params);
extra_params[0] = OSSL_PARAM_construct_octet_string("seed", seed, seedlen);
/*
 * NOTE: For unverifiable g use "hindex" instead of "gindex"
 * extra_params[1] = OSSL_PARAM_construct_int("hindex", &hindex);
 */
extra_params[1] = OSSL_PARAM_construct_int("gindex", &gindex);
extra_params[2] = OSSL_PARAM_construct_int("pcounter", &pcounter);
extra_params[3] = OSSL_PARAM_construct_end();
merged_params = OSSL_PARAM_merge(domain_params, extra_params);

ctx = EVP_PKEY_CTX_new_from_name(NULL, "DHX", NULL);
EVP_PKEY_fromdata_init(ctx);
EVP_PKEY_fromdata(ctx, &complete_domp, OSSL_KEYMGMT_SELECT_ALL,
                  merged_params);

validate_ctx = EVP_PKEY_CTX_new_from_pkey(NULL, complete_domp, NULL);
if (EVP_PKEY_param_check(validate_ctx) > 0)
    /* validation_passed(); */
else
    /* validation_failed(); */

OSSL_PARAM_free(domain_params);
OSSL_PARAM_free(merged_params);
EVP_PKEY_CTX_free(ctx);
EVP_PKEY_CTX_free(validate_ctx);
EVP_PKEY_free(complete_domp);
</code></pre></div> <h2 id=conforming-to>CONFORMING TO<a title="Permanent link" class=headerlink href=#conforming-to>¶</a></h2> <ul><li>RFC 7919 (TLS ffdhe named safe prime groups)<li>RFC 3526 (IKE modp named safe prime groups)<li>RFC 5114 (Additional DH named groups for dh_1024_160", "dh_2048_224" and "dh_2048_256").</ul> <p>The following sections of SP800-56Ar3:</p> <ul><li>5.5.1.1 FFC Domain Parameter Selection/Generation<li>Appendix D: FFC Safe-prime Groups</ul> <p>The following sections of FIPS186-4:</p> <ul><li>A.1.1.2 Generation of Probable Primes p and q Using an Approved Hash Function.<li>A.2.3 Generation of canonical generator g.<li>A.2.1 Unverifiable Generation of the Generator g.</ul> <h2 id=see-also>SEE ALSO<a title="Permanent link" class=headerlink href=#see-also>¶</a></h2> <p><a href=../EVP_PKEY-FFC/>EVP_PKEY-FFC(7)</a>, <a href=../EVP_KEYEXCH-DH/>EVP_KEYEXCH-DH(7)</a> <a href=../../man3/EVP_PKEY_new/>EVP_PKEY(3)</a>, <a href=../provider-keymgmt/>provider-keymgmt(7)</a>, <a href=../../man3/EVP_KEYMGMT/>EVP_KEYMGMT(3)</a>, <a href=../OSSL_PROVIDER-default/>OSSL_PROVIDER-default(7)</a>, <a href=../OSSL_PROVIDER-FIPS/>OSSL_PROVIDER-FIPS(7)</a></p> <h2 id=copyright>COPYRIGHT<a title="Permanent link" class=headerlink href=#copyright>¶</a></h2> <p>Copyright 2020-2022 The OpenSSL Project Authors. All Rights Reserved.</p> <p>Licensed under the Apache License 2.0 (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at <a href=https://www.openssl.org/source/license.html>https://www.openssl.org/source/license.html</a>.</p> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> <footer class=md-footer><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright>Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs </a></div></div></div></footer> <div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.indexes", "navigation.instant", "navigation.path", "navigation.prune", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "master", "provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.ad660dcc.min.js></script> 