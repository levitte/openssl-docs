<!doctype html><html class=no-js lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><link href=https://docs.openssl.org/1.1.1/man7/passphrase-encoding/ rel=canonical><link href=../ossl_store/ rel=prev><link href=../proxy-certificates/ rel=next><link href=../../images/favicon.ico rel=icon><meta content="mkdocs-1.6.0, mkdocs-material-9.5.27" name=generator><title>passphrase-encoding - OpenSSL Documentation</title><link href=../../assets/stylesheets/main.6543a935.min.css rel=stylesheet><link href=../../assets/stylesheets/palette.06af60db.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href=../../stylesheets/extra.css rel=stylesheet><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><body data-md-color-accent=light-blue data-md-color-primary=blue-grey data-md-color-scheme=default dir=ltr><input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox><input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox><label class=md-overlay for=__drawer></label><div data-md-component=skip><a class=md-skip href=#passphrase-encoding> Skip to content </a></div><div data-md-component=announce></div><div data-md-color-scheme=default data-md-component=outdated hidden></div><header class="md-header md-header--shadow md-header--lifted" data-md-component=header><nav class="md-header__inner md-grid" aria-label=Header><a aria-label="OpenSSL Documentation" class="md-header__button md-logo" title="OpenSSL Documentation" data-md-component=logo href=../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a><label class="md-header__button md-icon" for=__drawer><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> OpenSSL Documentation </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> passphrase-encoding </span></div></div></div><form class=md-header__option data-md-component=palette><input aria-label="Switch to dark mode" class=md-option data-md-color-accent=light-blue data-md-color-media data-md-color-primary=blue-grey data-md-color-scheme=default id=__palette_0 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg></label><input aria-label="Switch to light mode" class=md-option data-md-color-accent=light-blue data-md-color-media data-md-color-primary=black data-md-color-scheme=slate id=__palette_1 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg></label></form><script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script><label class="md-header__button md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input aria-label=Search autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=Search required spellcheck=false><label class="md-search__icon md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg></label><nav aria-label=Search class=md-search__options><button class="md-search__icon md-icon" aria-label=Clear tabindex=-1 title=Clear type=reset><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg></button></nav><div class=md-search__suggest data-md-component=search-suggest></div></form><div class=md-search__output><div class=md-search__scrollwrap data-md-scrollfix tabindex=0><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta>Initializing search</div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a title="Go to repository" class=md-source data-md-component=source href=https://github.com/openssl/openssl> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div> <div class=md-source__repository>GitHub</div> </a></div></nav><nav aria-label=Tabs class=md-tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a class=md-tabs__link href=../..> Home </a><li class=md-tabs__item><a class=md-tabs__link href=../../fips/> FIPS-140 </a><li class=md-tabs__item><a class=md-tabs__link href=../../man1/> Commands </a><li class=md-tabs__item><a class=md-tabs__link href=../../man3/> Libraries </a><li class=md-tabs__item><a class=md-tabs__link href=../../man5/> File Formats </a><li class="md-tabs__item md-tabs__item--active"><a class=md-tabs__link href=../> Overviews </a></ul></div></nav></header><div class=md-container data-md-component=container><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0><label class=md-nav__title for=__drawer><a aria-label="OpenSSL Documentation" class="md-nav__button md-logo" title="OpenSSL Documentation" data-md-component=logo href=../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> OpenSSL Documentation</label><div class=md-nav__source><a title="Go to repository" class=md-source data-md-component=source href=https://github.com/openssl/openssl> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div> <div class=md-source__repository>GitHub</div> </a></div><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item> <a class=md-nav__link href=../.. title=Home>    <span class=md-ellipsis-custom> Home </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../../fips/ title=FIPS-140>    <span class=md-ellipsis-custom> FIPS-140 </span>  </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class=md-nav__link href=../../man1/>    <span class=md-ellipsis-custom> Commands </span>   <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class=md-nav__link href=../../man3/>    <span class=md-ellipsis-custom> Libraries </span>   <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class=md-nav__link href=../../man5/>    <span class=md-ellipsis-custom> File Formats </span>   <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">  <input class="md-nav__toggle md-toggle" checked id=__nav_6 type=checkbox>  <div class="md-nav__link md-nav__container"><a class=md-nav__link href=../>    <span class=md-ellipsis-custom> Overviews </span>  </a><label class=md-nav__link for=__nav_6 id=__nav_6_label><span class="md-nav__icon md-icon"></span></label></div>  <nav aria-expanded=true aria-labelledby=__nav_6_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_6><span class="md-nav__icon md-icon"></span> Overviews</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item> <a class=md-nav__link href=../Ed25519/ title=Ed25519>    <span class=md-ellipsis-custom> Ed25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../Ed25519 title=Ed448>    <span class=md-ellipsis-custom> Ed448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../RAND/ title=RAND>    <span class=md-ellipsis-custom> RAND </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../RAND_DRBG/ title=RAND_DRBG>    <span class=md-ellipsis-custom> RAND_DRBG </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../RSA-PSS/ title=RSA-PSS>    <span class=md-ellipsis-custom> RSA-PSS </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../SM2/ title=SM2>    <span class=md-ellipsis-custom> SM2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../X25519/ title=X25519>    <span class=md-ellipsis-custom> X25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../X25519 title=X448>    <span class=md-ellipsis-custom> X448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../bio/ title=bio>    <span class=md-ellipsis-custom> bio </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../crypto/ title=crypto>    <span class=md-ellipsis-custom> crypto </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ct/ title=ct>    <span class=md-ellipsis-custom> ct </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../des_modes/ title=des_modes>    <span class=md-ellipsis-custom> des_modes </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../evp/ title=evp>    <span class=md-ellipsis-custom> evp </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl_store/ title=ossl_store>    <span class=md-ellipsis-custom> ossl_store </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl_store-file/ title=ossl_store-file>    <span class=md-ellipsis-custom> ossl_store-file </span>  </a><li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id=__toc type=checkbox>   <label class="md-nav__link md-nav__link--active" for=__toc>   <span class=md-ellipsis-custom> passphrase-encoding </span>  <span class="md-nav__icon md-icon"></span></label> <a class="md-nav__link md-nav__link--active" href=./>    <span class=md-ellipsis-custom> passphrase-encoding </span>  </a>  <nav aria-label="Table of contents" class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#name> <span class=md-ellipsis> NAME </span> </a><li class=md-nav__item><a class=md-nav__link href=#description> <span class=md-ellipsis> DESCRIPTION </span> </a> <nav aria-label=DESCRIPTION class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#the-general-case> <span class=md-ellipsis> The general case </span> </a><li class=md-nav__item><a class=md-nav__link href=#pkcs12> <span class=md-ellipsis> PKCS#12 </span> </a><li class=md-nav__item><a class=md-nav__link href=#ossl_store> <span class=md-ellipsis> OSSL_STORE </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#recommendations> <span class=md-ellipsis> RECOMMENDATIONS </span> </a> <nav aria-label=RECOMMENDATIONS class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#creating-new-objects> <span class=md-ellipsis> Creating new objects </span> </a><li class=md-nav__item><a class=md-nav__link href=#opening-existing-objects> <span class=md-ellipsis> Opening existing objects </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#see-also> <span class=md-ellipsis> SEE ALSO </span> </a><li class=md-nav__item><a class=md-nav__link href=#copyright> <span class=md-ellipsis> COPYRIGHT </span> </a></ul></nav><li class=md-nav__item> <a class=md-nav__link href=../proxy-certificates/ title=proxy-certificates>    <span class=md-ellipsis-custom> proxy-certificates </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../scrypt/ title=scrypt>    <span class=md-ellipsis-custom> scrypt </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ssl/ title=ssl>    <span class=md-ellipsis-custom> ssl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../x509/ title=x509>    <span class=md-ellipsis-custom> x509 </span>  </a></ul></nav> </ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav aria-label="Table of contents" class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#name> <span class=md-ellipsis> NAME </span> </a><li class=md-nav__item><a class=md-nav__link href=#description> <span class=md-ellipsis> DESCRIPTION </span> </a> <nav aria-label=DESCRIPTION class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#the-general-case> <span class=md-ellipsis> The general case </span> </a><li class=md-nav__item><a class=md-nav__link href=#pkcs12> <span class=md-ellipsis> PKCS#12 </span> </a><li class=md-nav__item><a class=md-nav__link href=#ossl_store> <span class=md-ellipsis> OSSL_STORE </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#recommendations> <span class=md-ellipsis> RECOMMENDATIONS </span> </a> <nav aria-label=RECOMMENDATIONS class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#creating-new-objects> <span class=md-ellipsis> Creating new objects </span> </a><li class=md-nav__item><a class=md-nav__link href=#opening-existing-objects> <span class=md-ellipsis> Opening existing objects </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#see-also> <span class=md-ellipsis> SEE ALSO </span> </a><li class=md-nav__item><a class=md-nav__link href=#copyright> <span class=md-ellipsis> COPYRIGHT </span> </a></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><h1 id=passphrase-encoding>passphrase-encoding<a title="Permanent link" class=headerlink href=#passphrase-encoding>¶</a></h1><h2 id=name>NAME<a title="Permanent link" class=headerlink href=#name>¶</a></h2><p>passphrase-encoding - How diverse parts of OpenSSL treat pass phrases character encoding<h2 id=description>DESCRIPTION<a title="Permanent link" class=headerlink href=#description>¶</a></h2><p>In a modern world with all sorts of character encodings, the treatment of pass phrases has become increasingly complex. This manual page attempts to give an overview over how this problem is currently addressed in different parts of the OpenSSL library.<h3 id=the-general-case>The general case<a title="Permanent link" class=headerlink href=#the-general-case>¶</a></h3><p>The OpenSSL library doesn't treat pass phrases in any special way as a general rule, and trusts the application or user to choose a suitable character set and stick to that throughout the lifetime of affected objects. This means that for an object that was encrypted using a pass phrase encoded in ISO-8859-1, that object needs to be decrypted using a pass phrase encoded in ISO-8859-1. Using the wrong encoding is expected to cause a decryption failure.<h3 id=pkcs12>PKCS#12<a title="Permanent link" class=headerlink href=#pkcs12>¶</a></h3><p>PKCS#12 is a bit different regarding pass phrase encoding. The standard stipulates that the pass phrase shall be encoded as an ASN.1 BMPString, which consists of the code points of the basic multilingual plane, encoded in big endian (UCS-2 BE).<p>OpenSSL tries to adapt to this requirements in one of the following manners:<ol><li>Treats the received pass phrase as UTF-8 encoded and tries to re-encode it to UTF-16 (which is the same as UCS-2 for characters U+0000 to U+D7FF and U+E000 to U+FFFF, but becomes an expansion for any other character), or failing that, proceeds with step 2.<li><p>Assumes that the pass phrase is encoded in ASCII or ISO-8859-1 and opportunistically prepends each byte with a zero byte to obtain the UCS-2 encoding of the characters, which it stores as a BMPString.</p> <p>Note that since there is no check of your locale, this may produce UCS-2 / UTF-16 characters that do not correspond to the original pass phrase characters for other character sets, such as any ISO-8859-X encoding other than ISO-8859-1 (or for Windows, CP 1252 with exception for the extra "graphical" characters in the 0x80-0x9F range).</p></ol><p>OpenSSL versions older than 1.1.0 do variant 2 only, and that is the reason why OpenSSL still does this, to be able to read files produced with older versions.<p>It should be noted that this approach isn't entirely fault free.<p>A pass phrase encoded in ISO-8859-2 could very well have a sequence such as 0xC3 0xAF (which is the two characters "LATIN CAPITAL LETTER A WITH BREVE" and "LATIN CAPITAL LETTER Z WITH DOT ABOVE" in ISO-8859-2 encoding), but would be misinterpreted as the perfectly valid UTF-8 encoded code point U+00EF (LATIN SMALL LETTER I WITH DIAERESIS) <em>if the pass phrase doesn't contain anything that would be invalid UTF-8</em>. A pass phrase that contains this kind of byte sequence will give a different outcome in OpenSSL 1.1.0 and newer than in OpenSSL older than 1.1.0.<div class=highlight><pre><span></span><code>0x00 0xC3 0x00 0xAF                 #   # OpenSSL older than 1.1.0
0x00 0xEF                           #   # OpenSSL 1.1.0 and newer
</code></pre></div><p>On the same accord, anything encoded in UTF-8 that was given to OpenSSL older than 1.1.0 was misinterpreted as ISO-8859-1 sequences.<h3 id=ossl_store>OSSL_STORE<a title="Permanent link" class=headerlink href=#ossl_store>¶</a></h3><p><a href=../ossl_store/>ossl_store(7)</a> acts as a general interface to access all kinds of objects, potentially protected with a pass phrase, a PIN or something else. This API stipulates that pass phrases should be UTF-8 encoded, and that any other pass phrase encoding may give undefined results. This API relies on the application to ensure UTF-8 encoding, and doesn't check that this is the case, so what it gets, it will also pass to the underlying loader.<h2 id=recommendations>RECOMMENDATIONS<a title="Permanent link" class=headerlink href=#recommendations>¶</a></h2><p>This section assumes that you know what pass phrase was used for encryption, but that it may have been encoded in a different character encoding than the one used by your current input method. For example, the pass phrase may have been used at a time when your default encoding was ISO-8859-1 (i.e. "naïve" resulting in the byte sequence 0x6E 0x61 0xEF 0x76 0x65), and you're now in an environment where your default encoding is UTF-8 (i.e. "naïve" resulting in the byte sequence 0x6E 0x61 0xC3 0xAF 0x76 0x65). Whenever it's mentioned that you should use a certain character encoding, it should be understood that you either change the input method to use the mentioned encoding when you type in your pass phrase, or use some suitable tool to convert your pass phrase from your default encoding to the target encoding.<p>Also note that the sub-sections below discuss human readable pass phrases. This is particularly relevant for PKCS#12 objects, where human readable pass phrases are assumed. For other objects, it's as legitimate to use any byte sequence (such as a sequence of bytes from `/dev/urandom` that's been saved away), which makes any character encoding discussion irrelevant; in such cases, simply use the same byte sequence as it is.<h3 id=creating-new-objects>Creating new objects<a title="Permanent link" class=headerlink href=#creating-new-objects>¶</a></h3><p>For creating new pass phrase protected objects, make sure the pass phrase is encoded using UTF-8. This is default on most modern Unixes, but may involve an effort on other platforms. Specifically for Windows, setting the environment variable <code>OPENSSL_WIN32_UTF8</code> will have anything entered on [Windows] console prompt converted to UTF-8 (command line and separately prompted pass phrases alike).<h3 id=opening-existing-objects>Opening existing objects<a title="Permanent link" class=headerlink href=#opening-existing-objects>¶</a></h3><p>For opening pass phrase protected objects where you know what character encoding was used for the encryption pass phrase, make sure to use the same encoding again.<p>For opening pass phrase protected objects where the character encoding that was used is unknown, or where the producing application is unknown, try one of the following:<ol><li>Try the pass phrase that you have as it is in the character encoding of your environment. It's possible that its byte sequence is exactly right.<li>Convert the pass phrase to UTF-8 and try with the result. Specifically with PKCS#12, this should open up any object that was created according to the specification.<li><p>Do a naïve (i.e. purely mathematical) ISO-8859-1 to UTF-8 conversion and try with the result. This differs from the previous attempt because ISO-8859-1 maps directly to U+0000 to U+00FF, which other non-UTF-8 character sets do not.</p> <p>This also takes care of the case when a UTF-8 encoded string was used with OpenSSL older than 1.1.0. (for example, <code>ï</code>, which is 0xC3 0xAF when encoded in UTF-8, would become 0xC3 0x83 0xC2 0xAF when re-encoded in the naïve manner. The conversion to BMPString would then yield 0x00 0xC3 0x00 0xA4 0x00 0x00, the erroneous/non-compliant encoding used by OpenSSL older than 1.1.0)</p></ol><h2 id=see-also>SEE ALSO<a title="Permanent link" class=headerlink href=#see-also>¶</a></h2><p><a href=../evp/>evp(7)</a>, <a href=../ossl_store/>ossl_store(7)</a>, <a href=../../man3/EVP_BytesToKey/>EVP_BytesToKey(3)</a>, <a href=../../man3/EVP_EncryptInit/>EVP_DecryptInit(3)</a>, <a href=../../man3/PEM_read/>PEM_do_header(3)</a>, <a href=../../man3/PKCS12_parse/>PKCS12_parse(3)</a>, <a href=../../man3/PKCS12_newpass/>PKCS12_newpass(3)</a>, <a href=../../man3/d2i_PKCS8PrivateKey_bio/>d2i_PKCS8PrivateKey_bio(3)</a><h2 id=copyright>COPYRIGHT<a title="Permanent link" class=headerlink href=#copyright>¶</a></h2><p>Copyright 2018-2020 The OpenSSL Project Authors. All Rights Reserved.<p>Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at <a href=https://www.openssl.org/source/license.html>https://www.openssl.org/source/license.html</a>.</article></div><script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script></div></main><footer class=md-footer><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright>Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs </a></div></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><script id=__config type=application/json>{"base": "../..", "features": ["navigation.indexes", "navigation.instant", "navigation.path", "navigation.prune", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "master", "provider": "mike"}}</script><script src=../../assets/javascripts/bundle.ad660dcc.min.js></script>