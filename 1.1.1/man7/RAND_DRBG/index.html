<!doctype html><html class=no-js lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><link href=https://docs.openssl.org/1.1.1/man7/RAND_DRBG/ rel=canonical><link href=../RAND/ rel=prev><link href=../RSA-PSS/ rel=next><link href=../../images/favicon.ico rel=icon><meta content="mkdocs-1.6.0, mkdocs-material-9.5.27" name=generator><title>RAND_DRBG - OpenSSL Documentation</title><link href=../../assets/stylesheets/main.6543a935.min.css rel=stylesheet><link href=../../assets/stylesheets/palette.06af60db.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href=../../stylesheets/extra.css rel=stylesheet><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><body data-md-color-accent=light-blue data-md-color-primary=blue-grey data-md-color-scheme=default dir=ltr><input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox><input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox><label class=md-overlay for=__drawer></label><div data-md-component=skip><a class=md-skip href=#rand_drbg> Skip to content </a></div><div data-md-component=announce></div><div data-md-color-scheme=default data-md-component=outdated hidden></div><header class="md-header md-header--shadow md-header--lifted" data-md-component=header><nav class="md-header__inner md-grid" aria-label=Header><a aria-label="OpenSSL Documentation" class="md-header__button md-logo" title="OpenSSL Documentation" data-md-component=logo href=../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a><label class="md-header__button md-icon" for=__drawer><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> OpenSSL Documentation </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> RAND_DRBG </span></div></div></div><form class=md-header__option data-md-component=palette><input aria-label="Switch to dark mode" class=md-option data-md-color-accent=light-blue data-md-color-media data-md-color-primary=blue-grey data-md-color-scheme=default id=__palette_0 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg></label><input aria-label="Switch to light mode" class=md-option data-md-color-accent=light-blue data-md-color-media data-md-color-primary=black data-md-color-scheme=slate id=__palette_1 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg></label></form><script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script><label class="md-header__button md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input aria-label=Search autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=Search required spellcheck=false><label class="md-search__icon md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg></label><nav aria-label=Search class=md-search__options><button class="md-search__icon md-icon" aria-label=Clear tabindex=-1 title=Clear type=reset><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg></button></nav><div class=md-search__suggest data-md-component=search-suggest></div></form><div class=md-search__output><div class=md-search__scrollwrap data-md-scrollfix tabindex=0><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta>Initializing search</div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a title="Go to repository" class=md-source data-md-component=source href=https://github.com/openssl/openssl> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div> <div class=md-source__repository>GitHub</div> </a></div></nav><nav aria-label=Tabs class=md-tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a class=md-tabs__link href=../..> Home </a><li class=md-tabs__item><a class=md-tabs__link href=../../fips/> FIPS-140 </a><li class=md-tabs__item><a class=md-tabs__link href=../../man1/> Commands </a><li class=md-tabs__item><a class=md-tabs__link href=../../man3/> Libraries </a><li class=md-tabs__item><a class=md-tabs__link href=../../man5/> File Formats </a><li class="md-tabs__item md-tabs__item--active"><a class=md-tabs__link href=../> Overviews </a></ul></div></nav></header><div class=md-container data-md-component=container><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0><label class=md-nav__title for=__drawer><a aria-label="OpenSSL Documentation" class="md-nav__button md-logo" title="OpenSSL Documentation" data-md-component=logo href=../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> OpenSSL Documentation</label><div class=md-nav__source><a title="Go to repository" class=md-source data-md-component=source href=https://github.com/openssl/openssl> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div> <div class=md-source__repository>GitHub</div> </a></div><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item> <a class=md-nav__link href=../.. title=Home>    <span class=md-ellipsis-custom> Home </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../../fips/ title=FIPS-140>    <span class=md-ellipsis-custom> FIPS-140 </span>  </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class=md-nav__link href=../../man1/>    <span class=md-ellipsis-custom> Commands </span>   <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class=md-nav__link href=../../man3/>    <span class=md-ellipsis-custom> Libraries </span>   <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class=md-nav__link href=../../man5/>    <span class=md-ellipsis-custom> File Formats </span>   <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">  <input class="md-nav__toggle md-toggle" checked id=__nav_6 type=checkbox>  <div class="md-nav__link md-nav__container"><a class=md-nav__link href=../>    <span class=md-ellipsis-custom> Overviews </span>  </a><label class=md-nav__link for=__nav_6 id=__nav_6_label><span class="md-nav__icon md-icon"></span></label></div>  <nav aria-expanded=true aria-labelledby=__nav_6_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_6><span class="md-nav__icon md-icon"></span> Overviews</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item> <a class=md-nav__link href=../Ed25519/ title=Ed25519>    <span class=md-ellipsis-custom> Ed25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../Ed25519 title=Ed448>    <span class=md-ellipsis-custom> Ed448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../RAND/ title=RAND>    <span class=md-ellipsis-custom> RAND </span>  </a><li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id=__toc type=checkbox>   <label class="md-nav__link md-nav__link--active" for=__toc>   <span class=md-ellipsis-custom> RAND_DRBG </span>  <span class="md-nav__icon md-icon"></span></label> <a class="md-nav__link md-nav__link--active" href=./>    <span class=md-ellipsis-custom> RAND_DRBG </span>  </a>  <nav aria-label="Table of contents" class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#name> <span class=md-ellipsis> NAME </span> </a><li class=md-nav__item><a class=md-nav__link href=#synopsis> <span class=md-ellipsis> SYNOPSIS </span> </a><li class=md-nav__item><a class=md-nav__link href=#description> <span class=md-ellipsis> DESCRIPTION </span> </a> <nav aria-label=DESCRIPTION class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#disclaimer> <span class=md-ellipsis> Disclaimer </span> </a><li class=md-nav__item><a class=md-nav__link href=#typical-use-cases> <span class=md-ellipsis> Typical Use Cases </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#chaining> <span class=md-ellipsis> CHAINING </span> </a><li class=md-nav__item><a class=md-nav__link href=#the-three-shared-drbg-instances> <span class=md-ellipsis> THE THREE SHARED DRBG INSTANCES </span> </a> <nav aria-label="THE THREE SHARED DRBG INSTANCES" class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#the-master-drbg-instance> <span class=md-ellipsis> The &LTmaster> DRBG instance </span> </a><li class=md-nav__item><a class=md-nav__link href=#the-public-drbg-instance> <span class=md-ellipsis> The &LTpublic> DRBG instance </span> </a><li class=md-nav__item><a class=md-nav__link href=#the-private-drbg-instance> <span class=md-ellipsis> The &LTprivate> DRBG instance </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#locking> <span class=md-ellipsis> LOCKING </span> </a><li class=md-nav__item><a class=md-nav__link href=#the-overall-picture> <span class=md-ellipsis> THE OVERALL PICTURE </span> </a><li class=md-nav__item><a class=md-nav__link href=#reseeding> <span class=md-ellipsis> RESEEDING </span> </a> <nav aria-label=RESEEDING class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#automatic-reseeding> <span class=md-ellipsis> Automatic Reseeding </span> </a><li class=md-nav__item><a class=md-nav__link href=#manual-reseeding> <span class=md-ellipsis> Manual Reseeding </span> </a><li class=md-nav__item><a class=md-nav__link href=#entropy-input-vs-additional-data> <span class=md-ellipsis> Entropy Input vs. Additional Data </span> </a><li class=md-nav__item><a class=md-nav__link href=#configuring-the-random-seed-source> <span class=md-ellipsis> Configuring the Random Seed Source </span> </a><li class=md-nav__item><a class=md-nav__link href=#reseeding-the-master-drbg-with-automatic-seeding-enabled> <span class=md-ellipsis> Reseeding the master DRBG with automatic seeding enabled </span> </a><li class=md-nav__item><a class=md-nav__link href=#reseeding-the-master-drbg-with-automatic-seeding-disabled> <span class=md-ellipsis> Reseeding the master DRBG with automatic seeding disabled </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#see-also> <span class=md-ellipsis> SEE ALSO </span> </a><li class=md-nav__item><a class=md-nav__link href=#copyright> <span class=md-ellipsis> COPYRIGHT </span> </a></ul></nav><li class=md-nav__item> <a class=md-nav__link href=../RSA-PSS/ title=RSA-PSS>    <span class=md-ellipsis-custom> RSA-PSS </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../SM2/ title=SM2>    <span class=md-ellipsis-custom> SM2 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../X25519/ title=X25519>    <span class=md-ellipsis-custom> X25519 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../X25519 title=X448>    <span class=md-ellipsis-custom> X448 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../bio/ title=bio>    <span class=md-ellipsis-custom> bio </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../crypto/ title=crypto>    <span class=md-ellipsis-custom> crypto </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ct/ title=ct>    <span class=md-ellipsis-custom> ct </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../des_modes/ title=des_modes>    <span class=md-ellipsis-custom> des_modes </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../evp/ title=evp>    <span class=md-ellipsis-custom> evp </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl_store/ title=ossl_store>    <span class=md-ellipsis-custom> ossl_store </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ossl_store-file/ title=ossl_store-file>    <span class=md-ellipsis-custom> ossl_store-file </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../passphrase-encoding/ title=passphrase-encoding>    <span class=md-ellipsis-custom> passphrase-encoding </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../proxy-certificates/ title=proxy-certificates>    <span class=md-ellipsis-custom> proxy-certificates </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../scrypt/ title=scrypt>    <span class=md-ellipsis-custom> scrypt </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../ssl/ title=ssl>    <span class=md-ellipsis-custom> ssl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../x509/ title=x509>    <span class=md-ellipsis-custom> x509 </span>  </a></ul></nav> </ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav aria-label="Table of contents" class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#name> <span class=md-ellipsis> NAME </span> </a><li class=md-nav__item><a class=md-nav__link href=#synopsis> <span class=md-ellipsis> SYNOPSIS </span> </a><li class=md-nav__item><a class=md-nav__link href=#description> <span class=md-ellipsis> DESCRIPTION </span> </a> <nav aria-label=DESCRIPTION class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#disclaimer> <span class=md-ellipsis> Disclaimer </span> </a><li class=md-nav__item><a class=md-nav__link href=#typical-use-cases> <span class=md-ellipsis> Typical Use Cases </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#chaining> <span class=md-ellipsis> CHAINING </span> </a><li class=md-nav__item><a class=md-nav__link href=#the-three-shared-drbg-instances> <span class=md-ellipsis> THE THREE SHARED DRBG INSTANCES </span> </a> <nav aria-label="THE THREE SHARED DRBG INSTANCES" class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#the-master-drbg-instance> <span class=md-ellipsis> The &LTmaster> DRBG instance </span> </a><li class=md-nav__item><a class=md-nav__link href=#the-public-drbg-instance> <span class=md-ellipsis> The &LTpublic> DRBG instance </span> </a><li class=md-nav__item><a class=md-nav__link href=#the-private-drbg-instance> <span class=md-ellipsis> The &LTprivate> DRBG instance </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#locking> <span class=md-ellipsis> LOCKING </span> </a><li class=md-nav__item><a class=md-nav__link href=#the-overall-picture> <span class=md-ellipsis> THE OVERALL PICTURE </span> </a><li class=md-nav__item><a class=md-nav__link href=#reseeding> <span class=md-ellipsis> RESEEDING </span> </a> <nav aria-label=RESEEDING class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#automatic-reseeding> <span class=md-ellipsis> Automatic Reseeding </span> </a><li class=md-nav__item><a class=md-nav__link href=#manual-reseeding> <span class=md-ellipsis> Manual Reseeding </span> </a><li class=md-nav__item><a class=md-nav__link href=#entropy-input-vs-additional-data> <span class=md-ellipsis> Entropy Input vs. Additional Data </span> </a><li class=md-nav__item><a class=md-nav__link href=#configuring-the-random-seed-source> <span class=md-ellipsis> Configuring the Random Seed Source </span> </a><li class=md-nav__item><a class=md-nav__link href=#reseeding-the-master-drbg-with-automatic-seeding-enabled> <span class=md-ellipsis> Reseeding the master DRBG with automatic seeding enabled </span> </a><li class=md-nav__item><a class=md-nav__link href=#reseeding-the-master-drbg-with-automatic-seeding-disabled> <span class=md-ellipsis> Reseeding the master DRBG with automatic seeding disabled </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#see-also> <span class=md-ellipsis> SEE ALSO </span> </a><li class=md-nav__item><a class=md-nav__link href=#copyright> <span class=md-ellipsis> COPYRIGHT </span> </a></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><h1 id=rand_drbg>RAND_DRBG<a title="Permanent link" class=headerlink href=#rand_drbg>¶</a></h1><h2 id=name>NAME<a title="Permanent link" class=headerlink href=#name>¶</a></h2><p>RAND_DRBG - the deterministic random bit generator<h2 id=synopsis>SYNOPSIS<a title="Permanent link" class=headerlink href=#synopsis>¶</a></h2><div class=highlight><pre><span></span><code>#include &LTopenssl/rand_drbg.h>
</code></pre></div><h2 id=description>DESCRIPTION<a title="Permanent link" class=headerlink href=#description>¶</a></h2><p>The default OpenSSL RAND method is based on the RAND_DRBG class, which implements a deterministic random bit generator (DRBG). A DRBG is a certain type of cryptographically-secure pseudo-random number generator (CSPRNG), which is described in [NIST SP 800-90A Rev. 1].<p>While the RAND API is the 'frontend' which is intended to be used by application developers for obtaining random bytes, the RAND_DRBG API serves as the 'backend', connecting the former with the operating systems's entropy sources and providing access to the DRBG's configuration parameters.<h3 id=disclaimer>Disclaimer<a title="Permanent link" class=headerlink href=#disclaimer>¶</a></h3><p>Unless you have very specific requirements for your random generator, it is in general not necessary to utilize the RAND_DRBG API directly. The usual way to obtain random bytes is to use <a href=../../man3/RAND_bytes/>RAND_bytes(3)</a> or <a href=../../man3/RAND_bytes/>RAND_priv_bytes(3)</a>, see also <a href=../RAND/>RAND(7)</a>.<h3 id=typical-use-cases>Typical Use Cases<a title="Permanent link" class=headerlink href=#typical-use-cases>¶</a></h3><p>Typical examples for such special use cases are the following:<ul><li>You want to use your own private DRBG instances. Multiple DRBG instances which are accessed only by a single thread provide additional security (because their internal states are independent) and better scalability in multithreaded applications (because they don't need to be locked).<li>You need to integrate a previously unsupported entropy source.<li>You need to change the default settings of the standard OpenSSL RAND implementation to meet specific requirements.</ul><h2 id=chaining>CHAINING<a title="Permanent link" class=headerlink href=#chaining>¶</a></h2><p>A DRBG instance can be used as the entropy source of another DRBG instance, provided it has itself access to a valid entropy source. The DRBG instance which acts as entropy source is called the <em>parent</em> DRBG, the other instance the <em>child</em> DRBG.<p>This is called chaining. A chained DRBG instance is created by passing a pointer to the parent DRBG as argument to the RAND_DRBG_new() call. It is possible to create chains of more than two DRBG in a row.<h2 id=the-three-shared-drbg-instances>THE THREE SHARED DRBG INSTANCES<a title="Permanent link" class=headerlink href=#the-three-shared-drbg-instances>¶</a></h2><p>Currently, there are three shared DRBG instances, the &LTmaster>, &LTpublic>, and &LTprivate> DRBG. While the &LTmaster> DRBG is a single global instance, the &LTpublic> and &LTprivate> DRBG are created per thread and accessed through thread-local storage.<p>By default, the functions <a href=../../man3/RAND_bytes/>RAND_bytes(3)</a> and <a href=../../man3/RAND_bytes/>RAND_priv_bytes(3)</a> use the thread-local &LTpublic> and &LTprivate> DRBG instance, respectively.<h3 id=the-master-drbg-instance>The &LTmaster> DRBG instance<a title="Permanent link" class=headerlink href=#the-master-drbg-instance>¶</a></h3><p>The &LTmaster> DRBG is not used directly by the application, only for reseeding the two other two DRBG instances. It reseeds itself by obtaining randomness either from os entropy sources or by consuming randomness which was added previously by <a href=../../man3/RAND_add/>RAND_add(3)</a>.<h3 id=the-public-drbg-instance>The &LTpublic> DRBG instance<a title="Permanent link" class=headerlink href=#the-public-drbg-instance>¶</a></h3><p>This instance is used per default by <a href=../../man3/RAND_bytes/>RAND_bytes(3)</a>.<h3 id=the-private-drbg-instance>The &LTprivate> DRBG instance<a title="Permanent link" class=headerlink href=#the-private-drbg-instance>¶</a></h3><p>This instance is used per default by <a href=../../man3/RAND_bytes/>RAND_priv_bytes(3)</a><h2 id=locking>LOCKING<a title="Permanent link" class=headerlink href=#locking>¶</a></h2><p>The &LTmaster> DRBG is intended to be accessed concurrently for reseeding by its child DRBG instances. The necessary locking is done internally. It is <em>not</em> thread-safe to access the &LTmaster> DRBG directly via the RAND_DRBG interface. The &LTpublic> and &LTprivate> DRBG are thread-local, i.e. there is an instance of each per thread. So they can safely be accessed without locking via the RAND_DRBG interface.<p>Pointers to these DRBG instances can be obtained using RAND_DRBG_get0_master(), RAND_DRBG_get0_public(), and RAND_DRBG_get0_private(), respectively. Note that it is not allowed to store a pointer to one of the thread-local DRBG instances in a variable or other memory location where it will be accessed and used by multiple threads.<p>All other DRBG instances created by an application don't support locking, because they are intended to be used by a single thread. Instead of accessing a single DRBG instance concurrently from different threads, it is recommended to instantiate a separate DRBG instance per thread. Using the &LTmaster> DRBG as entropy source for multiple DRBG instances on different threads is thread-safe, because the DRBG instance will lock the &LTmaster> DRBG automatically for obtaining random input.<h2 id=the-overall-picture>THE OVERALL PICTURE<a title="Permanent link" class=headerlink href=#the-overall-picture>¶</a></h2><p>The following picture gives an overview over how the DRBG instances work together and are being used.<div class=highlight><pre><span></span><code>           +--------------------+
           | os entropy sources |
           +--------------------+
                    |
                    v           +-----------------------------+
  RAND_add() ==> &LTmaster>     &LT-| shared DRBG (with locking)  |
                  /   \         +-----------------------------+
                 /     \              +---------------------------+
          &LTpublic>     &LTprivate>   &LT- | per-thread DRBG instances |
             |             |          +---------------------------+
             v             v
           RAND_bytes()   RAND_priv_bytes()
                |               ^
                |               |
+------------------+      +------------------------------------+
| general purpose  |      | used for secrets like session keys |
| random generator |      | and private keys for certificates  |
+------------------+      +------------------------------------+
</code></pre></div><p>The usual way to obtain random bytes is to call RAND_bytes(...) or RAND_priv_bytes(...). These calls are roughly equivalent to calling RAND_DRBG_bytes(&LTpublic>, ...) and RAND_DRBG_bytes(&LTprivate>, ...), respectively. The method <a href=../../man3/RAND_DRBG_generate/>RAND_DRBG_bytes(3)</a> is a convenience method wrapping the <a href=../../man3/RAND_DRBG_generate/>RAND_DRBG_generate(3)</a> function, which serves the actual request for random data.<h2 id=reseeding>RESEEDING<a title="Permanent link" class=headerlink href=#reseeding>¶</a></h2><p>A DRBG instance seeds itself automatically, pulling random input from its entropy source. The entropy source can be either a trusted operating system entropy source, or another DRBG with access to such a source.<p>Automatic reseeding occurs after a predefined number of generate requests. The selection of the trusted entropy sources is configured at build time using the --with-rand-seed option. The following sections explain the reseeding process in more detail.<h3 id=automatic-reseeding>Automatic Reseeding<a title="Permanent link" class=headerlink href=#automatic-reseeding>¶</a></h3><p>Before satisfying a generate request (<a href=../../man3/RAND_DRBG_generate/>RAND_DRBG_generate(3)</a>), the DRBG reseeds itself automatically, if one of the following conditions holds:<p>- the DRBG was not instantiated (=seeded) yet or has been uninstantiated.<p>- the number of generate requests since the last reseeding exceeds a certain threshold, the so called <em>reseed_interval</em>. This behaviour can be disabled by setting the <em>reseed_interval</em> to 0.<p>- the time elapsed since the last reseeding exceeds a certain time interval, the so called <em>reseed_time_interval</em>. This can be disabled by setting the <em>reseed_time_interval</em> to 0.<p>- the DRBG is in an error state.<p><strong>Note</strong>: An error state is entered if the entropy source fails while the DRBG is seeding or reseeding. The last case ensures that the DRBG automatically recovers from the error as soon as the entropy source is available again.<h3 id=manual-reseeding>Manual Reseeding<a title="Permanent link" class=headerlink href=#manual-reseeding>¶</a></h3><p>In addition to automatic reseeding, the caller can request an immediate reseeding of the DRBG with fresh entropy by setting the <em>prediction resistance</em> parameter to 1 when calling <a href=../../man3/RAND_DRBG_generate/>RAND_DRBG_generate(3)</a>.<p>The document [NIST SP 800-90C] describes prediction resistance requests in detail and imposes strict conditions on the entropy sources that are approved for providing prediction resistance. Since the default DRBG implementation does not have access to such an approved entropy source, a request for prediction resistance will currently always fail. In other words, prediction resistance is currently not supported yet by the DRBG.<p>For the three shared DRBGs (and only for these) there is another way to reseed them manually: If <a href=../../man3/RAND_add/>RAND_add(3)</a> is called with a positive <em>randomness</em> argument (or <a href=../../man3/RAND_add/>RAND_seed(3)</a>), then this will immediately reseed the &LTmaster> DRBG. The &LTpublic> and &LTprivate> DRBG will detect this on their next generate call and reseed, pulling randomness from &LTmaster>.<p>The last feature has been added to support the common practice used with previous OpenSSL versions to call RAND_add() before calling RAND_bytes().<h3 id=entropy-input-vs-additional-data>Entropy Input vs. Additional Data<a title="Permanent link" class=headerlink href=#entropy-input-vs-additional-data>¶</a></h3><p>The DRBG distinguishes two different types of random input: <em>entropy</em>, which comes from a trusted source, and <em>additional input</em>', which can optionally be added by the user and is considered untrusted. It is possible to add <em>additional input</em> not only during reseeding, but also for every generate request. This is in fact done automatically by <a href=../../man3/RAND_DRBG_generate/>RAND_DRBG_bytes(3)</a>.<h3 id=configuring-the-random-seed-source>Configuring the Random Seed Source<a title="Permanent link" class=headerlink href=#configuring-the-random-seed-source>¶</a></h3><p>In most cases OpenSSL will automatically choose a suitable seed source for automatically seeding and reseeding its &LTmaster> DRBG. In some cases however, it will be necessary to explicitly specify a seed source during configuration, using the --with-rand-seed option. For more information, see the INSTALL instructions. There are also operating systems where no seed source is available and automatic reseeding is disabled by default.<p>The following two sections describe the reseeding process of the master DRBG, depending on whether automatic reseeding is available or not.<h3 id=reseeding-the-master-drbg-with-automatic-seeding-enabled>Reseeding the master DRBG with automatic seeding enabled<a title="Permanent link" class=headerlink href=#reseeding-the-master-drbg-with-automatic-seeding-enabled>¶</a></h3><p>Calling RAND_poll() or RAND_add() is not necessary, because the DRBG pulls the necessary entropy from its source automatically. However, both calls are permitted, and do reseed the RNG.<p>RAND_add() can be used to add both kinds of random input, depending on the value of the <strong>randomness</strong> argument:<ul><li>randomness == 0:</ul><p>The random bytes are mixed as additional input into the current state of the DRBG. Mixing in additional input is not considered a full reseeding, hence the reseed counter is not reset.<ul><li>randomness > 0:</ul><p>The random bytes are used as entropy input for a full reseeding (resp. reinstantiation) if the DRBG is instantiated (resp. uninstantiated or in an error state). The number of random bits required for reseeding is determined by the security strength of the DRBG. Currently it defaults to 256 bits (32 bytes). It is possible to provide less randomness than required. In this case the missing randomness will be obtained by pulling random input from the trusted entropy sources.<h3 id=reseeding-the-master-drbg-with-automatic-seeding-disabled>Reseeding the master DRBG with automatic seeding disabled<a title="Permanent link" class=headerlink href=#reseeding-the-master-drbg-with-automatic-seeding-disabled>¶</a></h3><p>Calling RAND_poll() will always fail.<p>RAND_add() needs to be called for initial seeding and periodic reseeding. At least 48 bytes (384 bits) of randomness have to be provided, otherwise the (re-)seeding of the DRBG will fail. This corresponds to one and a half times the security strength of the DRBG. The extra half is used for the nonce during instantiation.<p>More precisely, the number of bytes needed for seeding depend on the <em>security strength</em> of the DRBG, which is set to 256 by default.<h2 id=see-also>SEE ALSO<a title="Permanent link" class=headerlink href=#see-also>¶</a></h2><p><a href=../../man3/RAND_DRBG_generate/>RAND_DRBG_bytes(3)</a>, <a href=../../man3/RAND_DRBG_generate/>RAND_DRBG_generate(3)</a>, <a href=../../man3/RAND_DRBG_reseed/>RAND_DRBG_reseed(3)</a>, <a href=../../man3/RAND_DRBG_get0_master/>RAND_DRBG_get0_master(3)</a>, <a href=../../man3/RAND_DRBG_get0_master/>RAND_DRBG_get0_public(3)</a>, <a href=../../man3/RAND_DRBG_get0_master/>RAND_DRBG_get0_private(3)</a>, <a href=../../man3/RAND_DRBG_reseed/>RAND_DRBG_set_reseed_interval(3)</a>, <a href=../../man3/RAND_DRBG_reseed/>RAND_DRBG_set_reseed_time_interval(3)</a>, <a href=../../man3/RAND_DRBG_reseed/>RAND_DRBG_set_reseed_defaults(3)</a>, <a href=../RAND/>RAND(7)</a>,<h2 id=copyright>COPYRIGHT<a title="Permanent link" class=headerlink href=#copyright>¶</a></h2><p>Copyright 2017-2018 The OpenSSL Project Authors. All Rights Reserved.<p>Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at <a href=https://www.openssl.org/source/license.html>https://www.openssl.org/source/license.html</a>.</article></div><script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script></div></main><footer class=md-footer><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright>Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs </a></div></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><script id=__config type=application/json>{"base": "../..", "features": ["navigation.indexes", "navigation.instant", "navigation.path", "navigation.prune", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "master", "provider": "mike"}}</script><script src=../../assets/javascripts/bundle.ad660dcc.min.js></script>