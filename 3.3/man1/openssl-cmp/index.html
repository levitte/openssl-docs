<!doctype html><html class=no-js lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><link href=https://docs.openssl.org/3.3/man1/openssl-cmp/ rel=canonical><link href=../openssl-cmds/ rel=prev><link href=../openssl-cms/ rel=next><link href=../../images/favicon.ico rel=icon><meta content="mkdocs-1.6.0, mkdocs-material-9.5.27" name=generator><title>openssl-cmp - OpenSSL Documentation</title><link href=../../assets/stylesheets/main.6543a935.min.css rel=stylesheet><link href=../../assets/stylesheets/palette.06af60db.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href=../../stylesheets/extra.css rel=stylesheet><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><body data-md-color-accent=light-blue data-md-color-primary=blue-grey data-md-color-scheme=default dir=ltr><input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox><input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox><label class=md-overlay for=__drawer></label><div data-md-component=skip><a class=md-skip href=#openssl-cmp> Skip to content </a></div><div data-md-component=announce></div><div data-md-color-scheme=default data-md-component=outdated hidden></div><header class="md-header md-header--shadow md-header--lifted" data-md-component=header><nav class="md-header__inner md-grid" aria-label=Header><a aria-label="OpenSSL Documentation" class="md-header__button md-logo" title="OpenSSL Documentation" data-md-component=logo href=../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a><label class="md-header__button md-icon" for=__drawer><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> OpenSSL Documentation </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> openssl-cmp </span></div></div></div><form class=md-header__option data-md-component=palette><input aria-label="Switch to dark mode" class=md-option data-md-color-accent=light-blue data-md-color-media data-md-color-primary=blue-grey data-md-color-scheme=default id=__palette_0 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg></label><input aria-label="Switch to light mode" class=md-option data-md-color-accent=light-blue data-md-color-media data-md-color-primary=black data-md-color-scheme=slate id=__palette_1 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg></label></form><script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script><label class="md-header__button md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input aria-label=Search autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=Search required spellcheck=false><label class="md-search__icon md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg></label><nav aria-label=Search class=md-search__options><button class="md-search__icon md-icon" aria-label=Clear tabindex=-1 title=Clear type=reset><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg></button></nav><div class=md-search__suggest data-md-component=search-suggest></div></form><div class=md-search__output><div class=md-search__scrollwrap data-md-scrollfix tabindex=0><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta>Initializing search</div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a title="Go to repository" class=md-source data-md-component=source href=https://github.com/openssl/openssl> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div> <div class=md-source__repository>GitHub</div> </a></div></nav><nav aria-label=Tabs class=md-tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a class=md-tabs__link href=../..> Home </a><li class=md-tabs__item><a class=md-tabs__link href=../../fips/> FIPS-140 </a><li class="md-tabs__item md-tabs__item--active"><a class=md-tabs__link href=../> Commands </a><li class=md-tabs__item><a class=md-tabs__link href=../../man3/> Libraries </a><li class=md-tabs__item><a class=md-tabs__link href=../../man5/> File Formats </a><li class=md-tabs__item><a class=md-tabs__link href=../../man7/> Overviews </a></ul></div></nav></header><div class=md-container data-md-component=container><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0><label class=md-nav__title for=__drawer><a aria-label="OpenSSL Documentation" class="md-nav__button md-logo" title="OpenSSL Documentation" data-md-component=logo href=../..> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> OpenSSL Documentation</label><div class=md-nav__source><a title="Go to repository" class=md-source data-md-component=source href=https://github.com/openssl/openssl> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg></div> <div class=md-source__repository>GitHub</div> </a></div><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item> <a class=md-nav__link href=../.. title=Home>    <span class=md-ellipsis-custom> Home </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../../fips/ title=FIPS-140>    <span class=md-ellipsis-custom> FIPS-140 </span>  </a><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">  <input class="md-nav__toggle md-toggle" checked id=__nav_3 type=checkbox>  <div class="md-nav__link md-nav__container"><a class=md-nav__link href=../>    <span class=md-ellipsis-custom> Commands </span>  </a><label class=md-nav__link for=__nav_3 id=__nav_3_label><span class="md-nav__icon md-icon"></span></label></div>  <nav aria-expanded=true aria-labelledby=__nav_3_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_3><span class="md-nav__icon md-icon"></span> Commands</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item> <a class=md-nav__link href=../CA.pl/ title=CA.pl>    <span class=md-ellipsis-custom> CA.pl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=asn1parse>    <span class=md-ellipsis-custom> asn1parse </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-rehash title=c_rehash>    <span class=md-ellipsis-custom> c_rehash </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=ca>    <span class=md-ellipsis-custom> ca </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=ciphers>    <span class=md-ellipsis-custom> ciphers </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=cmp>    <span class=md-ellipsis-custom> cmp </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=cms>    <span class=md-ellipsis-custom> cms </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=crl>    <span class=md-ellipsis-custom> crl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=crl2pkcs7>    <span class=md-ellipsis-custom> crl2pkcs7 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=dgst>    <span class=md-ellipsis-custom> dgst </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=dhparam>    <span class=md-ellipsis-custom> dhparam </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=dsa>    <span class=md-ellipsis-custom> dsa </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=dsaparam>    <span class=md-ellipsis-custom> dsaparam </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=ec>    <span class=md-ellipsis-custom> ec </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=ecparam>    <span class=md-ellipsis-custom> ecparam </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=enc>    <span class=md-ellipsis-custom> enc </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=engine>    <span class=md-ellipsis-custom> engine </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=errstr>    <span class=md-ellipsis-custom> errstr </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=gendsa>    <span class=md-ellipsis-custom> gendsa </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=genpkey>    <span class=md-ellipsis-custom> genpkey </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=genrsa>    <span class=md-ellipsis-custom> genrsa </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=info>    <span class=md-ellipsis-custom> info </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=kdf>    <span class=md-ellipsis-custom> kdf </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=mac>    <span class=md-ellipsis-custom> mac </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=nseq>    <span class=md-ellipsis-custom> nseq </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=ocsp>    <span class=md-ellipsis-custom> ocsp </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl/ title=openssl>    <span class=md-ellipsis-custom> openssl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-asn1parse/ title=openssl-asn1parse>    <span class=md-ellipsis-custom> openssl-asn1parse </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-ca/ title=openssl-ca>    <span class=md-ellipsis-custom> openssl-ca </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-ciphers/ title=openssl-ciphers>    <span class=md-ellipsis-custom> openssl-ciphers </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds/ title=openssl-cmds>    <span class=md-ellipsis-custom> openssl-cmds </span>  </a><li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id=__toc type=checkbox>   <label class="md-nav__link md-nav__link--active" for=__toc>   <span class=md-ellipsis-custom> openssl-cmp </span>  <span class="md-nav__icon md-icon"></span></label> <a class="md-nav__link md-nav__link--active" href=./>    <span class=md-ellipsis-custom> openssl-cmp </span>  </a>  <nav aria-label="Table of contents" class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#name> <span class=md-ellipsis> NAME </span> </a><li class=md-nav__item><a class=md-nav__link href=#synopsis> <span class=md-ellipsis> SYNOPSIS </span> </a><li class=md-nav__item><a class=md-nav__link href=#description> <span class=md-ellipsis> DESCRIPTION </span> </a><li class=md-nav__item><a class=md-nav__link href=#options> <span class=md-ellipsis> OPTIONS </span> </a> <nav aria-label=OPTIONS class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#generic-message-options> <span class=md-ellipsis> Generic message options </span> </a><li class=md-nav__item><a class=md-nav__link href=#certificate-enrollment-options> <span class=md-ellipsis> Certificate enrollment options </span> </a><li class=md-nav__item><a class=md-nav__link href=#certificate-enrollment-and-revocation-options> <span class=md-ellipsis> Certificate enrollment and revocation options </span> </a><li class=md-nav__item><a class=md-nav__link href=#message-transfer-options> <span class=md-ellipsis> Message transfer options </span> </a><li class=md-nav__item><a class=md-nav__link href=#server-authentication-options> <span class=md-ellipsis> Server authentication options </span> </a><li class=md-nav__item><a class=md-nav__link href=#client-authentication-options> <span class=md-ellipsis> Client authentication options </span> </a><li class=md-nav__item><a class=md-nav__link href=#credentials-format-options> <span class=md-ellipsis> Credentials format options </span> </a><li class=md-nav__item><a class=md-nav__link href=#provider-options> <span class=md-ellipsis> Provider options </span> </a><li class=md-nav__item><a class=md-nav__link href=#random-state-options> <span class=md-ellipsis> Random state options </span> </a><li class=md-nav__item><a class=md-nav__link href=#tls-connection-options> <span class=md-ellipsis> TLS connection options </span> </a><li class=md-nav__item><a class=md-nav__link href=#client-side-options-for-debugging-and-offline-scenarios> <span class=md-ellipsis> Client-side options for debugging and offline scenarios </span> </a><li class=md-nav__item><a class=md-nav__link href=#mock-server-options> <span class=md-ellipsis> Mock server options </span> </a><li class=md-nav__item><a class=md-nav__link href=#certificate-verification-options-for-both-cmp-and-tls> <span class=md-ellipsis> Certificate verification options, for both CMP and TLS </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#notes> <span class=md-ellipsis> NOTES </span> </a><li class=md-nav__item><a class=md-nav__link href=#examples> <span class=md-ellipsis> EXAMPLES </span> </a> <nav aria-label=EXAMPLES class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#simple-examples-using-the-default-openssl-configuration-file> <span class=md-ellipsis> Simple examples using the default OpenSSL configuration file </span> </a><li class=md-nav__item><a class=md-nav__link href=#certificate-enrollment> <span class=md-ellipsis> Certificate enrollment </span> </a><li class=md-nav__item><a class=md-nav__link href=#certificate-update> <span class=md-ellipsis> Certificate update </span> </a><li class=md-nav__item><a class=md-nav__link href=#requesting-information-from-cmp-server> <span class=md-ellipsis> Requesting information from CMP server </span> </a><li class=md-nav__item><a class=md-nav__link href=#using-a-custom-configuration-file> <span class=md-ellipsis> Using a custom configuration file </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#see-also> <span class=md-ellipsis> SEE ALSO </span> </a><li class=md-nav__item><a class=md-nav__link href=#history> <span class=md-ellipsis> HISTORY </span> </a><li class=md-nav__item><a class=md-nav__link href=#copyright> <span class=md-ellipsis> COPYRIGHT </span> </a></ul></nav><li class=md-nav__item> <a class=md-nav__link href=../openssl-cms/ title=openssl-cms>    <span class=md-ellipsis-custom> openssl-cms </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-crl/ title=openssl-crl>    <span class=md-ellipsis-custom> openssl-crl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-crl2pkcs7/ title=openssl-crl2pkcs7>    <span class=md-ellipsis-custom> openssl-crl2pkcs7 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-dgst/ title=openssl-dgst>    <span class=md-ellipsis-custom> openssl-dgst </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-dhparam/ title=openssl-dhparam>    <span class=md-ellipsis-custom> openssl-dhparam </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-dsa/ title=openssl-dsa>    <span class=md-ellipsis-custom> openssl-dsa </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-dsaparam/ title=openssl-dsaparam>    <span class=md-ellipsis-custom> openssl-dsaparam </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-ec/ title=openssl-ec>    <span class=md-ellipsis-custom> openssl-ec </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-ecparam/ title=openssl-ecparam>    <span class=md-ellipsis-custom> openssl-ecparam </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-enc/ title=openssl-enc>    <span class=md-ellipsis-custom> openssl-enc </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-engine/ title=openssl-engine>    <span class=md-ellipsis-custom> openssl-engine </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-errstr/ title=openssl-errstr>    <span class=md-ellipsis-custom> openssl-errstr </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-fipsinstall/ title=openssl-fipsinstall>    <span class=md-ellipsis-custom> openssl-fipsinstall </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-format-options/ title=openssl-format-options>    <span class=md-ellipsis-custom> openssl-format-options </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-gendsa/ title=openssl-gendsa>    <span class=md-ellipsis-custom> openssl-gendsa </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-genpkey/ title=openssl-genpkey>    <span class=md-ellipsis-custom> openssl-genpkey </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-genrsa/ title=openssl-genrsa>    <span class=md-ellipsis-custom> openssl-genrsa </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-info/ title=openssl-info>    <span class=md-ellipsis-custom> openssl-info </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-kdf/ title=openssl-kdf>    <span class=md-ellipsis-custom> openssl-kdf </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-list/ title=openssl-list>    <span class=md-ellipsis-custom> openssl-list </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-mac/ title=openssl-mac>    <span class=md-ellipsis-custom> openssl-mac </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-namedisplay-options/ title=openssl-namedisplay-options>    <span class=md-ellipsis-custom> openssl-namedisplay-options </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-nseq/ title=openssl-nseq>    <span class=md-ellipsis-custom> openssl-nseq </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-ocsp/ title=openssl-ocsp>    <span class=md-ellipsis-custom> openssl-ocsp </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-passphrase-options/ title=openssl-passphrase-options>    <span class=md-ellipsis-custom> openssl-passphrase-options </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-passwd/ title=openssl-passwd>    <span class=md-ellipsis-custom> openssl-passwd </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-pkcs12/ title=openssl-pkcs12>    <span class=md-ellipsis-custom> openssl-pkcs12 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-pkcs7/ title=openssl-pkcs7>    <span class=md-ellipsis-custom> openssl-pkcs7 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-pkcs8/ title=openssl-pkcs8>    <span class=md-ellipsis-custom> openssl-pkcs8 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-pkey/ title=openssl-pkey>    <span class=md-ellipsis-custom> openssl-pkey </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-pkeyparam/ title=openssl-pkeyparam>    <span class=md-ellipsis-custom> openssl-pkeyparam </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-pkeyutl/ title=openssl-pkeyutl>    <span class=md-ellipsis-custom> openssl-pkeyutl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-prime/ title=openssl-prime>    <span class=md-ellipsis-custom> openssl-prime </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-rand/ title=openssl-rand>    <span class=md-ellipsis-custom> openssl-rand </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-rehash/ title=openssl-rehash>    <span class=md-ellipsis-custom> openssl-rehash </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-req/ title=openssl-req>    <span class=md-ellipsis-custom> openssl-req </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-rsa/ title=openssl-rsa>    <span class=md-ellipsis-custom> openssl-rsa </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-rsautl/ title=openssl-rsautl>    <span class=md-ellipsis-custom> openssl-rsautl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-s_client/ title=openssl-s_client>    <span class=md-ellipsis-custom> openssl-s_client </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-s_server/ title=openssl-s_server>    <span class=md-ellipsis-custom> openssl-s_server </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-s_time/ title=openssl-s_time>    <span class=md-ellipsis-custom> openssl-s_time </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-sess_id/ title=openssl-sess_id>    <span class=md-ellipsis-custom> openssl-sess_id </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-smime/ title=openssl-smime>    <span class=md-ellipsis-custom> openssl-smime </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-speed/ title=openssl-speed>    <span class=md-ellipsis-custom> openssl-speed </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-spkac/ title=openssl-spkac>    <span class=md-ellipsis-custom> openssl-spkac </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-srp/ title=openssl-srp>    <span class=md-ellipsis-custom> openssl-srp </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-storeutl/ title=openssl-storeutl>    <span class=md-ellipsis-custom> openssl-storeutl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-ts/ title=openssl-ts>    <span class=md-ellipsis-custom> openssl-ts </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-verification-options/ title=openssl-verification-options>    <span class=md-ellipsis-custom> openssl-verification-options </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-verify/ title=openssl-verify>    <span class=md-ellipsis-custom> openssl-verify </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-version/ title=openssl-version>    <span class=md-ellipsis-custom> openssl-version </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-x509/ title=openssl-x509>    <span class=md-ellipsis-custom> openssl-x509 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=passwd>    <span class=md-ellipsis-custom> passwd </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=pkcs12>    <span class=md-ellipsis-custom> pkcs12 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=pkcs7>    <span class=md-ellipsis-custom> pkcs7 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=pkcs8>    <span class=md-ellipsis-custom> pkcs8 </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=pkey>    <span class=md-ellipsis-custom> pkey </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=pkeyparam>    <span class=md-ellipsis-custom> pkeyparam </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=pkeyutl>    <span class=md-ellipsis-custom> pkeyutl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=prime>    <span class=md-ellipsis-custom> prime </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=rand>    <span class=md-ellipsis-custom> rand </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=rehash>    <span class=md-ellipsis-custom> rehash </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=req>    <span class=md-ellipsis-custom> req </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=rsa>    <span class=md-ellipsis-custom> rsa </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=rsautl>    <span class=md-ellipsis-custom> rsautl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=s_client>    <span class=md-ellipsis-custom> s_client </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=s_server>    <span class=md-ellipsis-custom> s_server </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=s_time>    <span class=md-ellipsis-custom> s_time </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=sess_id>    <span class=md-ellipsis-custom> sess_id </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=smime>    <span class=md-ellipsis-custom> smime </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=speed>    <span class=md-ellipsis-custom> speed </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=spkac>    <span class=md-ellipsis-custom> spkac </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=srp>    <span class=md-ellipsis-custom> srp </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=storeutl>    <span class=md-ellipsis-custom> storeutl </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=ts>    <span class=md-ellipsis-custom> ts </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../tsget/ title=tsget>    <span class=md-ellipsis-custom> tsget </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=verify>    <span class=md-ellipsis-custom> verify </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=version>    <span class=md-ellipsis-custom> version </span>  </a><li class=md-nav__item> <a class=md-nav__link href=../openssl-cmds title=x509>    <span class=md-ellipsis-custom> x509 </span>  </a></ul></nav> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class=md-nav__link href=../../man3/>    <span class=md-ellipsis-custom> Libraries </span>   <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class=md-nav__link href=../../man5/>    <span class=md-ellipsis-custom> File Formats </span>   <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class=md-nav__link href=../../man7/>    <span class=md-ellipsis-custom> Overviews </span>   <span class="md-nav__icon md-icon"></span> </a></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav aria-label="Table of contents" class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#name> <span class=md-ellipsis> NAME </span> </a><li class=md-nav__item><a class=md-nav__link href=#synopsis> <span class=md-ellipsis> SYNOPSIS </span> </a><li class=md-nav__item><a class=md-nav__link href=#description> <span class=md-ellipsis> DESCRIPTION </span> </a><li class=md-nav__item><a class=md-nav__link href=#options> <span class=md-ellipsis> OPTIONS </span> </a> <nav aria-label=OPTIONS class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#generic-message-options> <span class=md-ellipsis> Generic message options </span> </a><li class=md-nav__item><a class=md-nav__link href=#certificate-enrollment-options> <span class=md-ellipsis> Certificate enrollment options </span> </a><li class=md-nav__item><a class=md-nav__link href=#certificate-enrollment-and-revocation-options> <span class=md-ellipsis> Certificate enrollment and revocation options </span> </a><li class=md-nav__item><a class=md-nav__link href=#message-transfer-options> <span class=md-ellipsis> Message transfer options </span> </a><li class=md-nav__item><a class=md-nav__link href=#server-authentication-options> <span class=md-ellipsis> Server authentication options </span> </a><li class=md-nav__item><a class=md-nav__link href=#client-authentication-options> <span class=md-ellipsis> Client authentication options </span> </a><li class=md-nav__item><a class=md-nav__link href=#credentials-format-options> <span class=md-ellipsis> Credentials format options </span> </a><li class=md-nav__item><a class=md-nav__link href=#provider-options> <span class=md-ellipsis> Provider options </span> </a><li class=md-nav__item><a class=md-nav__link href=#random-state-options> <span class=md-ellipsis> Random state options </span> </a><li class=md-nav__item><a class=md-nav__link href=#tls-connection-options> <span class=md-ellipsis> TLS connection options </span> </a><li class=md-nav__item><a class=md-nav__link href=#client-side-options-for-debugging-and-offline-scenarios> <span class=md-ellipsis> Client-side options for debugging and offline scenarios </span> </a><li class=md-nav__item><a class=md-nav__link href=#mock-server-options> <span class=md-ellipsis> Mock server options </span> </a><li class=md-nav__item><a class=md-nav__link href=#certificate-verification-options-for-both-cmp-and-tls> <span class=md-ellipsis> Certificate verification options, for both CMP and TLS </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#notes> <span class=md-ellipsis> NOTES </span> </a><li class=md-nav__item><a class=md-nav__link href=#examples> <span class=md-ellipsis> EXAMPLES </span> </a> <nav aria-label=EXAMPLES class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#simple-examples-using-the-default-openssl-configuration-file> <span class=md-ellipsis> Simple examples using the default OpenSSL configuration file </span> </a><li class=md-nav__item><a class=md-nav__link href=#certificate-enrollment> <span class=md-ellipsis> Certificate enrollment </span> </a><li class=md-nav__item><a class=md-nav__link href=#certificate-update> <span class=md-ellipsis> Certificate update </span> </a><li class=md-nav__item><a class=md-nav__link href=#requesting-information-from-cmp-server> <span class=md-ellipsis> Requesting information from CMP server </span> </a><li class=md-nav__item><a class=md-nav__link href=#using-a-custom-configuration-file> <span class=md-ellipsis> Using a custom configuration file </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=#see-also> <span class=md-ellipsis> SEE ALSO </span> </a><li class=md-nav__item><a class=md-nav__link href=#history> <span class=md-ellipsis> HISTORY </span> </a><li class=md-nav__item><a class=md-nav__link href=#copyright> <span class=md-ellipsis> COPYRIGHT </span> </a></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><h1 id=openssl-cmp>openssl-cmp<a title="Permanent link" class=headerlink href=#openssl-cmp>¶</a></h1><h2 id=name>NAME<a title="Permanent link" class=headerlink href=#name>¶</a></h2><p>openssl-cmp - Certificate Management Protocol (CMP, RFC 4210) application<h2 id=synopsis>SYNOPSIS<a title="Permanent link" class=headerlink href=#synopsis>¶</a></h2><p><strong>openssl</strong> <strong>cmp</strong> [<strong>-help</strong>] [<strong>-config</strong> <em>filename</em>] [<strong>-section</strong> <em>names</em>] [<strong>-verbosity</strong> <em>level</em>]<p>Generic message options:<p>[<strong>-cmd</strong> <em>ir|cr|kur|p10cr|rr|genm</em>] [<strong>-infotype</strong> <em>name</em>] [<strong>-profile</strong> <em>name</em>] [<strong>-geninfo</strong> <em>values</em>]<p>Certificate enrollment options:<p>[<strong>-newkey</strong> <em>filename</em>|<em>uri</em>] [<strong>-newkeypass</strong> <em>arg</em>] [<strong>-subject</strong> <em>name</em>] [<strong>-days</strong> <em>number</em>] [<strong>-reqexts</strong> <em>name</em>] [<strong>-sans</strong> <em>spec</em>] [<strong>-san_nodefault</strong>] [<strong>-policies</strong> <em>name</em>] [<strong>-policy_oids</strong> <em>names</em>] [<strong>-policy_oids_critical</strong>] [<strong>-popo</strong> <em>number</em>] [<strong>-csr</strong> <em>filename</em>] [<strong>-out_trusted</strong> <em>filenames</em>|<em>uris</em>] [<strong>-implicit_confirm</strong>] [<strong>-disable_confirm</strong>] [<strong>-certout</strong> <em>filename</em>] [<strong>-chainout</strong> <em>filename</em>]<p>Certificate enrollment and revocation options:<p>[<strong>-oldcert</strong> <em>filename</em>|<em>uri</em>] [<strong>-issuer</strong> <em>name</em>] [<strong>-serial</strong> <em>number</em>] [<strong>-revreason</strong> <em>number</em>]<p>Message transfer options:<p>[<strong>-server</strong> <em>[http[s]://][userinfo@]host[:port][/path][?query][#fragment]</em>] [<strong>-proxy</strong> <em>[http[s]://][userinfo@]host[:port][/path][?query][#fragment]</em>] [<strong>-no_proxy</strong> <em>addresses</em>] [<strong>-recipient</strong> <em>name</em>] [<strong>-path</strong> <em>remote_path</em>] [<strong>-keep_alive</strong> <em>value</em>] [<strong>-msg_timeout</strong> <em>seconds</em>] [<strong>-total_timeout</strong> <em>seconds</em>]<p>Server authentication options:<p>[<strong>-trusted</strong> <em>filenames</em>|<em>uris</em>] [<strong>-untrusted</strong> <em>filenames</em>|<em>uris</em>] [<strong>-srvcert</strong> <em>filename</em>|<em>uri</em>] [<strong>-expect_sender</strong> <em>name</em>] [<strong>-ignore_keyusage</strong>] [<strong>-unprotected_errors</strong>] [<strong>-no_cache_extracerts</strong>] [<strong>-srvcertout</strong> <em>filename</em>] [<strong>-extracertsout</strong> <em>filename</em>] [<strong>-cacertsout</strong> <em>filename</em>] [<strong>-oldwithold</strong> <em>filename</em>] [<strong>-newwithnew</strong> <em>filename</em>] [<strong>-newwithold</strong> <em>filename</em>] [<strong>-oldwithnew</strong> <em>filename</em>]<p>Client authentication and protection options:<p>[<strong>-ref</strong> <em>value</em>] [<strong>-secret</strong> <em>arg</em>] [<strong>-cert</strong> <em>filename</em>|<em>uri</em>] [<strong>-own_trusted</strong> <em>filenames</em>|<em>uris</em>] [<strong>-key</strong> <em>filename</em>|<em>uri</em>] [<strong>-keypass</strong> <em>arg</em>] [<strong>-digest</strong> <em>name</em>] [<strong>-mac</strong> <em>name</em>] [<strong>-extracerts</strong> <em>filenames</em>|<em>uris</em>] [<strong>-unprotected_requests</strong>]<p>Credentials format options:<p>[<strong>-certform</strong> <em>PEM|DER</em>] [<strong>-keyform</strong> <em>PEM|DER|P12|ENGINE</em>] [<strong>-otherpass</strong> <em>arg</em>] [<strong>-engine</strong> <em>id</em>] [<strong>-provider</strong> <em>name</em>] [<strong>-provider-path</strong> <em>path</em>] [<strong>-propquery</strong> <em>propq</em>]<p>Random state options:<p>[<strong>-rand</strong> <em>files</em>] [<strong>-writerand</strong> <em>file</em>]<p>TLS connection options:<p>[<strong>-tls_used</strong>] [<strong>-tls_cert</strong> <em>filename</em>|<em>uri</em>] [<strong>-tls_key</strong> <em>filename</em>|<em>uri</em>] [<strong>-tls_keypass</strong> <em>arg</em>] [<strong>-tls_extra</strong> <em>filenames</em>|<em>uris</em>] [<strong>-tls_trusted</strong> <em>filenames</em>|<em>uris</em>] [<strong>-tls_host</strong> <em>name</em>]<p>Client-side debugging options:<p>[<strong>-batch</strong>] [<strong>-repeat</strong> <em>number</em>] [<strong>-reqin</strong> <em>filenames</em>] [<strong>-reqin_new_tid</strong>] [<strong>-reqout</strong> <em>filenames</em>] [<strong>-reqout_only</strong> <em>filename</em>] [<strong>-rspin</strong> <em>filenames</em>] [<strong>-rspout</strong> <em>filenames</em>] [<strong>-use_mock_srv</strong>]<p>Mock server options:<p>[<strong>-port</strong> <em>number</em>] [<strong>-max_msgs</strong> <em>number</em>] [<strong>-srv_ref</strong> <em>value</em>] [<strong>-srv_secret</strong> <em>arg</em>] [<strong>-srv_cert</strong> <em>filename</em>|<em>uri</em>] [<strong>-srv_key</strong> <em>filename</em>|<em>uri</em>] [<strong>-srv_keypass</strong> <em>arg</em>] [<strong>-srv_trusted</strong> <em>filenames</em>|<em>uris</em>] [<strong>-srv_untrusted</strong> <em>filenames</em>|<em>uris</em>] [<strong>-ref_cert</strong> <em>filename</em>|<em>uri</em>] [<strong>-rsp_cert</strong> <em>filename</em>|<em>uri</em>] [<strong>-rsp_extracerts</strong> <em>filenames</em>|<em>uris</em>] [<strong>-rsp_capubs</strong> <em>filenames</em>|<em>uris</em>] [<strong>-rsp_newwithnew</strong> <em>filename</em>|<em>uri</em>] [<strong>-rsp_newwithold</strong> <em>filename</em>|<em>uri</em>] [<strong>-rsp_oldwithnew</strong> <em>filename</em>|<em>uri</em>] [<strong>-poll_count</strong> <em>number</em>] [<strong>-check_after</strong> <em>number</em>] [<strong>-grant_implicitconf</strong>] [<strong>-pkistatus</strong> <em>number</em>] [<strong>-failure</strong> <em>number</em>] [<strong>-failurebits</strong> <em>number</em>] [<strong>-statusstring</strong> <em>arg</em>] [<strong>-send_error</strong>] [<strong>-send_unprotected</strong>] [<strong>-send_unprot_err</strong>] [<strong>-accept_unprotected</strong>] [<strong>-accept_unprot_err</strong>] [<strong>-accept_raverified</strong>]<p>Certificate verification options, for both CMP and TLS:<p>[<strong>-allow_proxy_certs</strong>] [<strong>-attime</strong> <em>timestamp</em>] [<strong>-no_check_time</strong>] [<strong>-check_ss_sig</strong>] [<strong>-crl_check</strong>] [<strong>-crl_check_all</strong>] [<strong>-explicit_policy</strong>] [<strong>-extended_crl</strong>] [<strong>-ignore_critical</strong>] [<strong>-inhibit_any</strong>] [<strong>-inhibit_map</strong>] [<strong>-partial_chain</strong>] [<strong>-policy</strong> <em>arg</em>] [<strong>-policy_check</strong>] [<strong>-policy_print</strong>] [<strong>-purpose</strong> <em>purpose</em>] [<strong>-suiteB_128</strong>] [<strong>-suiteB_128_only</strong>] [<strong>-suiteB_192</strong>] [<strong>-trusted_first</strong>] [<strong>-no_alt_chains</strong>] [<strong>-use_deltas</strong>] [<strong>-auth_level</strong> <em>num</em>] [<strong>-verify_depth</strong> <em>num</em>] [<strong>-verify_email</strong> <em>email</em>] [<strong>-verify_hostname</strong> <em>hostname</em>] [<strong>-verify_ip</strong> <em>ip</em>] [<strong>-verify_name</strong> <em>name</em>] [<strong>-x509_strict</strong>] [<strong>-issuer_checks</strong>]<h2 id=description>DESCRIPTION<a title="Permanent link" class=headerlink href=#description>¶</a></h2><p>The <strong>cmp</strong> command is a client implementation for the Certificate Management Protocol (CMP) as defined in RFC4210. It can be used to request certificates from a CA server, update their certificates, request certificates to be revoked, and perform other types of CMP requests.<h2 id=options>OPTIONS<a title="Permanent link" class=headerlink href=#options>¶</a></h2><ul><li><strong>-help</strong></ul><p>Display a summary of all options<ul><li><strong>-config</strong> <em>filename</em></ul><p>Configuration file to use. An empty string <code>""</code> means none. Default filename is from the environment variable <code>OPENSSL_CONF</code>.<ul><li><strong>-section</strong> <em>names</em></ul><p>Section(s) to use within config file defining CMP options. An empty string <code>""</code> means no specific section. Default is <code>cmp</code>.<p>Multiple section names may be given, separated by commas and/or whitespace (where in the latter case the whole argument must be enclosed in "..."). Contents of sections named later may override contents of sections named before. In any case, as usual, the <code>[default]</code> section and finally the unnamed section (as far as present) can provide per-option fallback values.<ul><li><strong>-verbosity</strong> <em>level</em></ul><p>Level of verbosity for logging, error output, etc. 0 = EMERG, 1 = ALERT, 2 = CRIT, 3 = ERR, 4 = WARN, 5 = NOTE, 6 = INFO, 7 = DEBUG, 8 = TRACE. Defaults to 6 = INFO.<h3 id=generic-message-options>Generic message options<a title="Permanent link" class=headerlink href=#generic-message-options>¶</a></h3><ul><li><strong>-cmd</strong> <em>ir|cr|kur|p10cr|rr|genm</em></ul><p>CMP command to execute. Currently implemented commands are:<ul><li>ir   - Initialization Request<li>cr   - Certificate Request<li>p10cr - PKCS#10 Certification Request (for legacy support)<li>kur   - Key Update Request<li>rr   - Revocation Request<li>genm - General Message</ul><p><strong>ir</strong> requests initialization of an end entity into a PKI hierarchy by issuing a first certificate.<p><strong>cr</strong> requests issuing an additional certificate for an end entity already initialized to the PKI hierarchy.<p><strong>p10cr</strong> requests issuing an additional certificate similarly to <strong>cr</strong> but using legacy PKCS#10 CSR format.<p><strong>kur</strong> requests a (key) update for an existing certificate.<p><strong>rr</strong> requests revocation of an existing certificate.<p><strong>genm</strong> requests information using a General Message, where optionally included <strong>InfoTypeAndValue</strong>s may be used to state which info is of interest. Upon receipt of the General Response, information about all received ITAV <strong>infoType</strong>s is printed to stdout.<ul><li><strong>-infotype</strong> <em>name</em></ul><p>Set InfoType name to use for requesting specific info in <strong>genm</strong>, e.g., <code>signKeyPairTypes</code>. So far, there is specific support for <code>caCerts</code> and <code>rootCaCert</code>.<ul><li><strong>-profile</strong> <em>name</em></ul><p>Name of a certificate profile to place in the PKIHeader generalInfo field of request messages.<ul><li><strong>-geninfo</strong> <em>values</em></ul><p>A comma-separated list of InfoTypeAndValue to place in the generalInfo field of the PKIHeader of requests messages. Each InfoTypeAndValue gives an OID and an integer or string value of the form <em>OID</em>:int:<em>number</em> or <em>OID</em>:str:<em>text</em>, e.g., <code>'1.2.3.4:int:56789, id-kp:str:name'</code>.<h3 id=certificate-enrollment-options>Certificate enrollment options<a title="Permanent link" class=headerlink href=#certificate-enrollment-options>¶</a></h3><ul><li><strong>-newkey</strong> <em>filename</em>|<em>uri</em></ul><p>The source of the private or public key for the certificate being requested. Defaults to the public key in the PKCS#10 CSR given with the <strong>-csr</strong> option, the public key of the reference certificate, or the current client key.<p>The public portion of the key is placed in the certification request.<p>Unless <strong>-cmd</strong> <em>p10cr</em>, <strong>-popo</strong> <em>-1</em>, or <strong>-popo</strong> <em>0</em> is given, the private key will be needed as well to provide the proof of possession (POPO), where the <strong>-key</strong> option may provide a fallback.<ul><li><strong>-newkeypass</strong> <em>arg</em></ul><p>Pass phrase source for the key given with the <strong>-newkey</strong> option. If not given here, the password will be prompted for if needed.<p>For more information about the format of <em>arg</em> see <a href=../../man1/openssl-passphrase-options>openssl-passphrase-options(1)</a>.<ul><li><strong>-subject</strong> <em>name</em></ul><p>X.509 Distinguished Name (DN) to use as subject field in the requested certificate template in IR/CR/KUR messages. If the NULL-DN (<code>/</code>) is given then no subject is placed in the template. Default is the subject DN of any PKCS#10 CSR given with the <strong>-csr</strong> option. For KUR, a further fallback is the subject DN of the reference certificate (see <strong>-oldcert</strong>) if provided. This fallback is used for IR and CR only if no SANs are set.<p>If provided and neither of <strong>-cert</strong>, <strong>-oldcert</strong>, or <strong>-csr</strong> is given, the subject DN is used as fallback sender of outgoing CMP messages.<p>The argument must be formatted as <em>/type0=value0/type1=value1/type2=...</em>. Special characters may be escaped by <code>\</code> (backslash); whitespace is retained. Empty values are permitted, but the corresponding type will not be included. Giving a single <code>/</code> will lead to an empty sequence of RDNs (a NULL-DN). Multi-valued RDNs can be formed by placing a <code>+</code> character instead of a <code>/</code> between the AttributeValueAssertions (AVAs) that specify the members of the set. Example:<p><code>/DC=org/DC=OpenSSL/DC=users/UID=123456+CN=John Doe</code><ul><li><strong>-days</strong> <em>number</em></ul><p>Number of days the new certificate is requested to be valid for, counting from the current time of the host. Also triggers the explicit request that the validity period starts from the current time (as seen by the host).<ul><li><strong>-reqexts</strong> <em>name</em></ul><p>Name of section in OpenSSL config file defining certificate request extensions. If the <strong>-csr</strong> option is present, these extensions augment the extensions contained the given PKCS#10 CSR, overriding any extensions with same OIDs.<ul><li><strong>-sans</strong> <em>spec</em></ul><p>One or more IP addresses, email addresses, DNS names, or URIs separated by commas or whitespace (where in the latter case the whole argument must be enclosed in "...") to add as Subject Alternative Name(s) (SAN) certificate request extension. If the special element "critical" is given the SANs are flagged as critical. Cannot be used if any Subject Alternative Name extension is set via <strong>-reqexts</strong>.<ul><li><strong>-san_nodefault</strong></ul><p>When Subject Alternative Names are not given via <strong>-sans</strong> nor defined via <strong>-reqexts</strong>, they are copied by default from the reference certificate (see <strong>-oldcert</strong>). This can be disabled by giving the <strong>-san_nodefault</strong> option.<ul><li><strong>-policies</strong> <em>name</em></ul><p>Name of section in OpenSSL config file defining policies to be set as certificate request extension. This option cannot be used together with <strong>-policy_oids</strong>.<ul><li><strong>-policy_oids</strong> <em>names</em></ul><p>One or more OID(s), separated by commas and/or whitespace (where in the latter case the whole argument must be enclosed in "...") to add as certificate policies request extension. This option cannot be used together with <strong>-policies</strong>.<ul><li><strong>-policy_oids_critical</strong></ul><p>Flag the policies given with <strong>-policy_oids</strong> as critical.<ul><li><strong>-popo</strong> <em>number</em></ul><p>Proof-of-possession (POPO) method to use for IR/CR/KUR; values: <code>-1</code>..&LT2> where <code>-1</code> = NONE, <code>0</code> = RAVERIFIED, <code>1</code> = SIGNATURE (default), <code>2</code> = KEYENC.<p>Note that a signature-based POPO can only be produced if a private key is provided via the <strong>-newkey</strong> or <strong>-key</strong> options.<ul><li><strong>-csr</strong> <em>filename</em></ul><p>PKCS#10 CSR in PEM or DER format containing a certificate request. With <strong>-cmd</strong> <em>p10cr</em> it is used directly in a legacy P10CR message.<p>When used with <strong>-cmd</strong> <em>ir</em>, <em>cr</em>, or <em>kur</em>, it is transformed into the respective regular CMP request. In this case, a private key must be provided (with <strong>-newkey</strong> or <strong>-key</strong>) for the proof of possession (unless <strong>-popo</strong> <em>-1</em> or <strong>-popo</strong> <em>0</em> is used) and the respective public key is placed in the certification request (rather than taking over the public key contained in the PKCS#10 CSR).<p>PKCS#10 CSR input may also be used with <strong>-cmd</strong> <em>rr</em> to specify the certificate to be revoked via the included subject name and public key. Its subject is used as fallback sender in CMP message headers if <strong>-cert</strong> and <strong>-oldcert</strong> are not given.<ul><li><strong>-out_trusted</strong> <em>filenames</em>|<em>uris</em></ul><p>Trusted certificate(s) to use for validating the newly enrolled certificate. During this verification, any certificate status checking is disabled.<p>Multiple sources may be given, separated by commas and/or whitespace (where in the latter case the whole argument must be enclosed in "..."). Each source may contain multiple certificates.<p>The certificate verification options <strong>-verify_hostname</strong>, <strong>-verify_ip</strong>, and <strong>-verify_email</strong> only affect the certificate verification enabled via this option.<ul><li><strong>-implicit_confirm</strong></ul><p>Request implicit confirmation of newly enrolled certificates.<ul><li><strong>-disable_confirm</strong></ul><p>Do not send certificate confirmation message for newly enrolled certificate without requesting implicit confirmation to cope with broken servers not supporting implicit confirmation correctly. <strong>WARNING:</strong> This leads to behavior violating RFC 4210.<ul><li><strong>-certout</strong> <em>filename</em></ul><p>The file where any newly enrolled certificate should be saved.<ul><li><strong>-chainout</strong> <em>filename</em></ul><p>The file where the chain of any newly enrolled certificate should be saved. This chain excludes the leaf certificate, i.e., the newly enrolled certificate. Also the trust anchor (the root certificate) is not included.<p>If the <strong>-certout</strong> option is given, too, with equal <em>filename</em> argument, then the file produced contains both outputs concatenated: the newly enrolled certificate followed by its chain.<h3 id=certificate-enrollment-and-revocation-options>Certificate enrollment and revocation options<a title="Permanent link" class=headerlink href=#certificate-enrollment-and-revocation-options>¶</a></h3><ul><li><strong>-oldcert</strong> <em>filename</em>|<em>uri</em></ul><p>The certificate to be updated (i.e., renewed or re-keyed) in Key Update Request (KUR) messages or to be revoked in Revocation Request (RR) messages. For KUR the certificate to be updated defaults to <strong>-cert</strong>, and the resulting certificate is called <em>reference certificate</em>. For RR the certificate to be revoked can also be specified using <strong>-csr</strong>. <strong>-oldcert</strong> and <strong>-csr</strong> is ignored if <strong>-issuer</strong> and <strong>-serial</strong> is provided.<p>The reference certificate, if any, is also used for deriving default subject DN and Subject Alternative Names and the default issuer entry in the requested certificate template of an IR/CR/KUR. Its public key is used as a fallback in the template of certification requests. Its subject is used as sender of outgoing messages if <strong>-cert</strong> is not given. Its issuer is used as default recipient in CMP message headers if neither <strong>-recipient</strong>, <strong>-srvcert</strong>, nor <strong>-issuer</strong> is given.<ul><li><strong>-issuer</strong> <em>name</em></ul><p>X.509 Distinguished Name (DN) use as issuer field in the requested certificate template in IR/CR/KUR/RR messages. If the NULL-DN (<code>/</code>) is given then no issuer is placed in the template.<p>If provided and neither <strong>-recipient</strong> nor <strong>-srvcert</strong> is given, the issuer DN is used as fallback recipient of outgoing CMP messages.<p>The argument must be formatted as <em>/type0=value0/type1=value1/type2=...</em>. For details see the description of the <strong>-subject</strong> option.<ul><li><strong>-serial</strong> <em>number</em></ul><p>Specify the Serial number of certificate to be revoked in revocation request. The serial number can be decimal or hex (if preceded by <code>0x</code>)<ul><li><strong>-revreason</strong> <em>number</em></ul><p>Set CRLReason to be included in revocation request (RR); values: <code>0</code>..<code>10</code> or <code>-1</code> for none (which is the default).<p>Reason numbers defined in RFC 5280 are:<div class=highlight><pre><span></span><code>    CRLReason ::= ENUMERATED {
         unspecified             (0),
         keyCompromise           (1),
         cACompromise            (2),
         affiliationChanged      (3),
         superseded              (4),
         cessationOfOperation    (5),
         certificateHold         (6),
         -- value 7 is not used
         removeFromCRL           (8),
         privilegeWithdrawn      (9),
         aACompromise           (10)
     }
</code></pre></div><h3 id=message-transfer-options>Message transfer options<a title="Permanent link" class=headerlink href=#message-transfer-options>¶</a></h3><ul><li><strong>-server</strong> <em>[http[s]://][userinfo@]host[:port][/path][?query][#fragment]</em></ul><p>The <em>host</em> domain name or IP address and optionally <em>port</em> of the CMP server to connect to using HTTP(S). IP address may be for v4 or v6, such as <code>127.0.0.1</code> or <code>[::1]</code> for localhost.<p>This option excludes <em>-port</em> and <em>-use_mock_srv</em>. It is ignored if <em>-rspin</em> is given with enough filename arguments.<p>If the scheme <code>https</code> is given, the <strong>-tls_used</strong> option is implied. When TLS is used, the default port is 443, otherwise 80. The optional userinfo and fragment components are ignored. Any given query component is handled as part of the path component. If a path is included it provides the default value for the <strong>-path</strong> option.<ul><li><strong>-proxy</strong> <em>[http[s]://][userinfo@]host[:port][/path][?query][#fragment]</em></ul><p>The HTTP(S) proxy server to use for reaching the CMP server unless <strong>-no_proxy</strong> applies, see below. The proxy port defaults to 80 or 443 if the scheme is <code>https</code>; apart from that the optional <code>http://</code> or <code>https://</code> prefix is ignored (note that using TLS may be required by <strong>-tls_used</strong> or <strong>-server</strong> with the prefix <code>https</code>), as well as any path, userinfo, and query, and fragment components. Defaults to the environment variable <code>http_proxy</code> if set, else <code>HTTP_PROXY</code> in case no TLS is used, otherwise <code>https_proxy</code> if set, else <code>HTTPS_PROXY</code>. This option is ignored if <em>-server</em> is not given.<ul><li><strong>-no_proxy</strong> <em>addresses</em></ul><p>List of IP addresses and/or DNS names of servers not to use an HTTP(S) proxy for, separated by commas and/or whitespace (where in the latter case the whole argument must be enclosed in "..."). Default is from the environment variable <code>no_proxy</code> if set, else <code>NO_PROXY</code>. This option is ignored if <em>-server</em> is not given.<ul><li><strong>-recipient</strong> <em>name</em></ul><p>Distinguished Name (DN) to use in the recipient field of CMP request message headers, i.e., the CMP server (usually the addressed CA).<p>The recipient field in the header of a CMP message is mandatory. If not given explicitly the recipient is determined in the following order: the subject of the CMP server certificate given with the <strong>-srvcert</strong> option, the <strong>-issuer</strong> option, the issuer of the certificate given with the <strong>-oldcert</strong> option, the issuer of the CMP client certificate (<strong>-cert</strong> option), as far as any of those is present, else the NULL-DN as last resort.<p>The argument must be formatted as <em>/type0=value0/type1=value1/type2=...</em>. For details see the description of the <strong>-subject</strong> option.<ul><li><strong>-path</strong> <em>remote_path</em></ul><p>HTTP path at the CMP server (aka CMP alias) to use for POST requests. Defaults to any path given with <strong>-server</strong>, else <code>"/"</code>.<ul><li><strong>-keep_alive</strong> <em>value</em></ul><p>If the given value is 0 then HTTP connections are closed after each response (which would be the default behavior of HTTP 1.0) even if a CMP transaction needs more than one round trip. If the value is 1 or 2 then for each transaction a persistent connection is requested. If the value is 2 then a persistent connection is required, i.e., an error occurs if the server does not grant it. The default value is 1, which means preferring to keep the connection open.<ul><li><strong>-msg_timeout</strong> <em>seconds</em></ul><p>Number of seconds a CMP request-response message round trip is allowed to take before a timeout error is returned. A value <= 0 means no limitation (waiting indefinitely). Default is to use the <strong>-total_timeout</strong> setting.<ul><li><strong>-total_timeout</strong> <em>seconds</em></ul><p>Maximum total number of seconds a transaction may take, including polling etc. A value <= 0 means no limitation (waiting indefinitely). Default is 0.<h3 id=server-authentication-options>Server authentication options<a title="Permanent link" class=headerlink href=#server-authentication-options>¶</a></h3><ul><li><strong>-trusted</strong> <em>filenames</em>|<em>uris</em></ul><p>The certificate(s), typically of root CAs, the client shall use as trust anchors when validating signature-based protection of CMP response messages. This option is ignored if the <strong>-srvcert</strong> option is given as well. It provides more flexibility than <strong>-srvcert</strong> because the CMP protection certificate of the server is not pinned but may be any certificate from which a chain to one of the given trust anchors can be constructed.<p>If none of <strong>-trusted</strong>, <strong>-srvcert</strong>, and <strong>-secret</strong> is given, message validation errors will be thrown unless <strong>-unprotected_errors</strong> permits an exception.<p>Multiple sources may be given, separated by commas and/or whitespace (where in the latter case the whole argument must be enclosed in "..."). Each source may contain multiple certificates.<p>The certificate verification options <strong>-verify_hostname</strong>, <strong>-verify_ip</strong>, and <strong>-verify_email</strong> have no effect on the certificate verification enabled via this option.<ul><li><strong>-untrusted</strong> <em>filenames</em>|<em>uris</em></ul><p>Non-trusted intermediate CA certificate(s). Any extra certificates given with the <strong>-cert</strong> option are appended to it. All these certificates may be useful for cert path construction for the own CMP signer certificate (to include in the extraCerts field of request messages) and for the TLS client certificate (if TLS is used) as well as for chain building when validating server certificates (checking signature-based CMP message protection) and when validating newly enrolled certificates.<p>Multiple sources may be given, separated by commas and/or whitespace (where in the latter case the whole argument must be enclosed in "..."). Each source may contain multiple certificates.<ul><li><strong>-srvcert</strong> <em>filename</em>|<em>uri</em></ul><p>The specific CMP server certificate to expect and directly trust (even if it is expired) when verifying signature-based protection of CMP response messages. This pins the accepted server and results in ignoring the <strong>-trusted</strong> option.<p>If set, the subject of the certificate is also used as default value for the recipient of CMP requests and as default value for the expected sender of CMP responses.<ul><li><strong>-expect_sender</strong> <em>name</em></ul><p>Distinguished Name (DN) expected in the sender field of incoming CMP messages. Defaults to the subject DN of the pinned <strong>-srvcert</strong>, if any.<p>This can be used to make sure that only a particular entity is accepted as CMP message signer, and attackers are not able to use arbitrary certificates of a trusted PKI hierarchy to fraudulently pose as a CMP server. Note that this option gives slightly more freedom than setting the <strong>-srvcert</strong>, which pins the server to the holder of a particular certificate, while the expected sender name will continue to match after updates of the server cert.<p>The argument must be formatted as <em>/type0=value0/type1=value1/type2=...</em>. For details see the description of the <strong>-subject</strong> option.<ul><li><strong>-ignore_keyusage</strong></ul><p>Ignore key usage restrictions in CMP signer certificates when validating signature-based protection of incoming CMP messages. By default, <code>digitalSignature</code> must be allowed by CMP signer certificates. This option applies to both CMP clients and the mock server.<ul><li><strong>-unprotected_errors</strong></ul><p>Accept missing or invalid protection of negative responses from the server. This applies to the following message types and contents:<ul><li>error messages<li>negative certificate responses (IP/CP/KUP)<li>negative revocation responses (RP)<li>negative PKIConf messages</ul><p><strong>WARNING:</strong> This setting leads to unspecified behavior and it is meant exclusively to allow interoperability with server implementations violating RFC 4210, e.g.:<ul><li>section 5.1.3.1 allows exceptions from protecting only for special cases: "There MAY be cases in which the PKIProtection BIT STRING is deliberately not used to protect a message [...] because other protection, external to PKIX, will be applied instead."<li>section 5.3.21 is clear on ErrMsgContent: "The CA MUST always sign it with a signature key."<li><p>appendix D.4 shows PKIConf message having protection</p><li><p><strong>-no_cache_extracerts</strong></p></ul><p>Do not cache certificates in the extraCerts field of CMP messages received. By default, they are kept as they may be helful for validating further messages. This option applies to both CMP clients and the mock server.<ul><li><strong>-srvcertout</strong> <em>filename</em></ul><p>The file where to save the successfully validated certificate, if any, that the CMP server used for signature-based response message protection. If there is no such certificate, typically because the protection was MAC-based, this is indicated by deleting the file (if it existed).<ul><li><strong>-extracertsout</strong> <em>filename</em></ul><p>The file where to save the list of certificates contained in the extraCerts field of the last received response message that is not a pollRep nor PKIConf.<ul><li><strong>-cacertsout</strong> <em>filename</em></ul><p>The file where to save the list of CA certificates contained in the caPubs field if a positive certificate response (i.e., IP, CP, or KUP) message was received or contained in a general response (genp) message with infoType <code>caCerts</code>.<ul><li><strong>-oldwithold</strong> <em>filename</em></ul><p>The root CA certificate to include in a genm request of infoType <code>rootCaCert</code>. If present and the optional oldWithNew certificate is received, it is verified using the newWithNew certificate as the (only) trust anchor.<ul><li><strong>-newwithnew</strong> <em>filename</em></ul><p>This option must be provided when <strong>-infotype</strong> <em>rootCaCert</em> is given. It specifies the file to save the newWithNew certificate received in a genp message of type <code>rootCaKeyUpdate</code>. If on success no such cert was received, this file (if present) is deleted to indicate that the requested root CA certificate update is not available.<p>Any received newWithNew certificate is verified using any received newWithOld certificate as untrusted intermediate certificate and the certificate provided with <strong>-oldwithold</strong> as the (only) trust anchor, or if not provided, using the certificates given with the <strong>-trusted</strong> option.<p><strong>WARNING:</strong> The newWithNew certificate is meant to be a certificate that will be trusted. The trust placed in it cannot be stronger than the trust placed in the <strong>-oldwithold</strong> certificate if present, otherwise it cannot be stronger than the weakest trust placed in any of the <strong>-trusted</strong> certificates.<ul><li><strong>-newwithold</strong> <em>filename</em></ul><p>The file to save any newWithOld certificate received in a genp message of infoType <code>rootCaKeyUpdate</code>. If on success no such cert was received, this is indicated by deleting the file.<ul><li><strong>-oldwithnew</strong> <em>filename</em></ul><p>The file to save any oldWithNew certificate received in a genp message of infoType <code>rootCaKeyUpdate</code>. If on success no such cert was received, this is indicated by deleting the file.<h3 id=client-authentication-options>Client authentication options<a title="Permanent link" class=headerlink href=#client-authentication-options>¶</a></h3><ul><li><strong>-ref</strong> <em>value</em></ul><p>Reference number/string/value to use as fallback senderKID; this is required if no sender name can be determined from the <strong>-cert</strong> or &LT-subject> options and is typically used when authenticating with pre-shared key (password-based MAC).<ul><li><strong>-secret</strong> <em>arg</em></ul><p>Provides the source of a secret value to use with MAC-based message protection. This takes precedence over the <strong>-cert</strong> and <strong>-key</strong> options. The secret is used for creating MAC-based protection of outgoing messages and for validating incoming messages that have MAC-based protection. The algorithm used by default is Password-Based Message Authentication Code (PBM) as defined in RFC 4210 section 5.1.3.1.<p>For more information about the format of <em>arg</em> see <a href=../../man1/openssl-passphrase-options>openssl-passphrase-options(1)</a>.<ul><li><strong>-cert</strong> <em>filename</em>|<em>uri</em></ul><p>The client's current CMP signer certificate. Requires the corresponding key to be given with <strong>-key</strong>.<p>The subject and the public key contained in this certificate serve as fallback values in the certificate template of IR/CR/KUR messages.<p>The subject of this certificate will be used as sender of outgoing CMP messages, while the subject of <strong>-oldcert</strong> or <strong>-subjectName</strong> may provide fallback values.<p>The issuer of this certificate is used as one of the recipient fallback values and as fallback issuer entry in the certificate template of IR/CR/KUR messages.<p>When performing signature-based message protection, this "protection certificate", also called "signer certificate", will be included first in the extraCerts field of outgoing messages and the signature is done with the corresponding key. In Initialization Request (IR) messages this can be used for authenticating using an external entity certificate as defined in appendix E.7 of RFC 4210.<p>For Key Update Request (KUR) messages this is also used as the certificate to be updated if the <strong>-oldcert</strong> option is not given.<p>If the file includes further certs, they are appended to the untrusted certs because they typically constitute the chain of the client certificate, which is included in the extraCerts field in signature-protected request messages.<ul><li><strong>-own_trusted</strong> <em>filenames</em>|<em>uris</em></ul><p>If this list of certificates is provided then the chain built for the client-side CMP signer certificate given with the <strong>-cert</strong> option is verified using the given certificates as trust anchors.<p>Multiple sources may be given, separated by commas and/or whitespace (where in the latter case the whole argument must be enclosed in "..."). Each source may contain multiple certificates.<p>The certificate verification options <strong>-verify_hostname</strong>, <strong>-verify_ip</strong>, and <strong>-verify_email</strong> have no effect on the certificate verification enabled via this option.<ul><li><strong>-key</strong> <em>filename</em>|<em>uri</em></ul><p>The corresponding private key file for the client's current certificate given in the <strong>-cert</strong> option. This will be used for signature-based message protection unless the <strong>-secret</strong> option indicating MAC-based protection or <strong>-unprotected_requests</strong> is given.<p>It is also used as a fallback for the <strong>-newkey</strong> option with IR/CR/KUR messages.<ul><li><strong>-keypass</strong> <em>arg</em></ul><p>Pass phrase source for the private key given with the <strong>-key</strong> option. Also used for <strong>-cert</strong> and <strong>-oldcert</strong> in case it is an encrypted PKCS#12 file. If not given here, the password will be prompted for if needed.<p>For more information about the format of <em>arg</em> see <a href=../../man1/openssl-passphrase-options>openssl-passphrase-options(1)</a>.<ul><li><strong>-digest</strong> <em>name</em></ul><p>Specifies name of supported digest to use in RFC 4210's MSG_SIG_ALG and as the one-way function (OWF) in <code>MSG_MAC_ALG</code>. If applicable, this is used for message protection and proof-of-possession (POPO) signatures. To see the list of supported digests, use <code>openssl list -digest-commands</code>. Defaults to <code>sha256</code>.<ul><li><strong>-mac</strong> <em>name</em></ul><p>Specifies the name of the MAC algorithm in <code>MSG_MAC_ALG</code>. To get the names of supported MAC algorithms use <code>openssl list -mac-algorithms</code> and possibly combine such a name with the name of a supported digest algorithm, e.g., hmacWithSHA256. Defaults to <code>hmac-sha1</code> as per RFC 4210.<ul><li><strong>-extracerts</strong> <em>filenames</em>|<em>uris</em></ul><p>Certificates to append in the extraCerts field when sending messages. They can be used as the default CMP signer certificate chain to include.<p>Multiple sources may be given, separated by commas and/or whitespace (where in the latter case the whole argument must be enclosed in "..."). Each source may contain multiple certificates.<ul><li><strong>-unprotected_requests</strong></ul><p>Send request messages without CMP-level protection.<h3 id=credentials-format-options>Credentials format options<a title="Permanent link" class=headerlink href=#credentials-format-options>¶</a></h3><ul><li><strong>-certform</strong> <em>PEM|DER</em></ul><p>File format to use when saving a certificate to a file. Default value is PEM.<ul><li><strong>-keyform</strong> <em>PEM|DER|P12|ENGINE</em></ul><p>The format of the key input; unspecified by default. See <a href=../../man1/openssl>"Format Options" in openssl(1)</a> for details.<ul><li><strong>-otherpass</strong> <em>arg</em></ul><p>Pass phrase source for certificate given with the <strong>-trusted</strong>, <strong>-untrusted</strong>, <strong>-own_trusted</strong>, <strong>-srvcert</strong>, <strong>-out_trusted</strong>, <strong>-extracerts</strong>, <strong>-srv_trusted</strong>, <strong>-srv_untrusted</strong>, <strong>-ref_cert</strong>, <strong>-rsp_cert</strong>, <strong>-rsp_extracerts</strong>, <strong>-rsp_capubs</strong>, <strong>-rsp_newwithnew</strong>, <strong>-rsp_newwithold</strong>, <strong>-rsp_oldwithnew</strong>, <strong>-tls_extra</strong>, and <strong>-tls_trusted</strong> options. If not given here, the password will be prompted for if needed.<p>For more information about the format of <em>arg</em> see <a href=../../man1/openssl-passphrase-options>openssl-passphrase-options(1)</a>.<ul><li><strong>-engine</strong> <em>id</em></ul><p>See <a href=../../man1/openssl>"Engine Options" in openssl(1)</a>. This option is deprecated.<p>As an alternative to using this combination:<div class=highlight><pre><span></span><code>    -engine {engineid} -key {keyid} -keyform ENGINE
</code></pre></div><p>... it's also possible to just give the key ID in URI form to <strong>-key</strong>, like this:<div class=highlight><pre><span></span><code>    -key org.openssl.engine:{engineid}:{keyid}
</code></pre></div><p>This applies to all options specifying keys: <strong>-key</strong>, <strong>-newkey</strong>, and <strong>-tls_key</strong>.<h3 id=provider-options>Provider options<a title="Permanent link" class=headerlink href=#provider-options>¶</a></h3><ul><li><strong>-provider</strong> <em>name</em><li><strong>-provider-path</strong> <em>path</em><li><strong>-propquery</strong> <em>propq</em></ul><p>See <a href=../../man1/openssl>"Provider Options" in openssl(1)</a>, <a href=../../man7/provider>provider(7)</a>, and <a href=../../man7/property>property(7)</a>.<h3 id=random-state-options>Random state options<a title="Permanent link" class=headerlink href=#random-state-options>¶</a></h3><ul><li><strong>-rand</strong> <em>files</em>, <strong>-writerand</strong> <em>file</em></ul><p>See <a href=../../man1/openssl>"Random State Options" in openssl(1)</a> for details.<h3 id=tls-connection-options>TLS connection options<a title="Permanent link" class=headerlink href=#tls-connection-options>¶</a></h3><ul><li><strong>-tls_used</strong></ul><p>Make the CMP client use TLS (regardless if other TLS-related options are set) for message exchange with the server via HTTP. This option is not supported with the <em>-port</em> option. It is implied if the <strong>-server</strong> option is given with the scheme <code>https</code>. It is ignored if the <strong>-server</strong> option is not given or <strong>-use_mock_srv</strong> is given or <strong>-rspin</strong> is given with enough filename arguments.<p>The following TLS-related options are ignored if TLS is not used.<ul><li><strong>-tls_cert</strong> <em>filename</em>|<em>uri</em></ul><p>Client's TLS certificate to use for authenticating to the TLS server. If the source includes further certs they are used (along with <strong>-untrusted</strong> certs) for constructing the client cert chain provided to the TLS server.<ul><li><strong>-tls_key</strong> <em>filename</em>|<em>uri</em></ul><p>Private key for the client's TLS certificate.<ul><li><strong>-tls_keypass</strong> <em>arg</em></ul><p>Pass phrase source for client's private TLS key <strong>-tls_key</strong>. Also used for <strong>-tls_cert</strong> in case it is an encrypted PKCS#12 file. If not given here, the password will be prompted for if needed.<p>For more information about the format of <em>arg</em> see <a href=../../man1/openssl-passphrase-options>openssl-passphrase-options(1)</a>.<ul><li><strong>-tls_extra</strong> <em>filenames</em>|<em>uris</em></ul><p>Extra certificates to provide to the TLS server during handshake.<ul><li><strong>-tls_trusted</strong> <em>filenames</em>|<em>uris</em></ul><p>Trusted certificate(s) to use for validating the TLS server certificate. This implies hostname validation.<p>Multiple sources may be given, separated by commas and/or whitespace (where in the latter case the whole argument must be enclosed in "..."). Each source may contain multiple certificates.<p>The certificate verification options <strong>-verify_hostname</strong>, <strong>-verify_ip</strong>, and <strong>-verify_email</strong> have no effect on the certificate verification enabled via this option.<ul><li><strong>-tls_host</strong> <em>name</em></ul><p>Address to be checked during hostname validation. This may be a DNS name or an IP address. If not given it defaults to the <strong>-server</strong> address.<h3 id=client-side-options-for-debugging-and-offline-scenarios>Client-side options for debugging and offline scenarios<a title="Permanent link" class=headerlink href=#client-side-options-for-debugging-and-offline-scenarios>¶</a></h3><ul><li><strong>-batch</strong></ul><p>Do not interactively prompt for input, for instance when a password is needed. This can be useful for batch processing and testing.<ul><li><strong>-repeat</strong> <em>number</em></ul><p>Invoke the command the given positive number of times with the same parameters. Default is one invocation.<ul><li><strong>-reqin</strong> <em>filenames</em></ul><p>Take the sequence of CMP requests to send to the server from the given file(s) rather than from the sequence of requests produced internally.<p>This option is useful for supporting offline scenarios where the certificate request (or any other CMP request) is produced beforehand and sent out later.<p>This option is ignored if the <strong>-rspin</strong> option is given because in the latter case no requests are actually sent.<p>Note that in any case the client produces internally its sequence of CMP request messages. Thus, all options required for doing this (such as <strong>-cmd</strong> and all options providing the required parameters) need to be given also when the <strong>-reqin</strong> option is present.<p>If the <strong>-reqin</strong> option is given for a certificate request and no <strong>-newkey</strong>, <strong>-key</strong>, <strong>-oldcert</strong>, or <strong>-csr</strong> option is given, a fallback public key is taken from the request message file (if it is included in the certificate template).<p>Hint: In case the <strong>-reqin</strong> option is given for a certificate request, there are situations where the client has access to the public key to be certified but not to the private key that by default will be needed for proof of possession. In this case the POPO is not actually needed (because the internally produced certificate request message will not be sent), and its generation can be disabled using the options <strong>-popo</strong> <em>-1</em> or <strong>-popo</strong> <em>0</em>.<p>Multiple filenames may be given, separated by commas and/or whitespace (where in the latter case the whole argument must be enclosed in "...").<p>The files are read as far as needed to complete the transaction and filenames have been provided. If more requests are needed, the remaining ones are taken from the items at the respective position in the sequence of requests produced internally.<p>The client needs to update the recipNonce field in the given requests (except for the first one) in order to satisfy the checks to be performed by the server. This causes re-protection (if protecting requests is required).<ul><li><strong>-reqin_new_tid</strong></ul><p>Use a fresh transactionID for CMP request messages read using <strong>-reqin</strong>, which causes their reprotection (if protecting requests is required). This may be needed in case the sequence of requests is reused and the CMP server complains that the transaction ID has already been used.<ul><li><strong>-reqout</strong> <em>filenames</em></ul><p>Save the sequence of CMP requests created by the client to the given file(s). These requests are not sent to the server if the <strong>-reqin</strong> option is used, too.<p>Multiple filenames may be given, separated by commas and/or whitespace.<p>Files are written as far as needed to save the transaction and filenames have been provided. If the transaction contains more requests, the remaining ones are not saved.<ul><li><strong>-reqout_only</strong> <em>filename</em></ul><p>Save the first CMP requests created by the client to the given file and exit. Any options related to CMP servers and their responses are ignored.<p>This option is useful for supporting offline scenarios where the certificate request (or any other CMP request) is produced beforehand and sent out later.<ul><li><strong>-rspin</strong> <em>filenames</em></ul><p>Process the sequence of CMP responses provided in the given file(s), not contacting any given server, as long as enough filenames are provided to complete the transaction.<p>Multiple filenames may be given, separated by commas and/or whitespace.<p>Any server specified via the <em>-server</em> or <em>-use_mock_srv</em> options is contacted only if more responses are needed to complete the transaction. In this case the transaction will fail unless the server has been prepared to continue the already started transaction.<ul><li><strong>-rspout</strong> <em>filenames</em></ul><p>Save the sequence of actually used CMP responses to the given file(s). These have been received from the server unless <strong>-rspin</strong> takes effect.<p>Multiple filenames may be given, separated by commas and/or whitespace.<p>Files are written as far as needed to save the responses contained in the transaction and filenames have been provided. If the transaction contains more responses, the remaining ones are not saved.<ul><li><strong>-use_mock_srv</strong></ul><p>Test the client using the internal CMP server mock-up at API level, bypassing socket-based transfer via HTTP. This excludes the <strong>-server</strong> and <strong>-port</strong> options.<h3 id=mock-server-options>Mock server options<a title="Permanent link" class=headerlink href=#mock-server-options>¶</a></h3><ul><li><strong>-port</strong> <em>number</em></ul><p>Act as HTTP-based CMP server mock-up listening on the given local port. The client may address the server via, e.g., <code>127.0.0.1</code> or <code>[::1]</code>. This option excludes the <strong>-server</strong> and <strong>-use_mock_srv</strong> options. The <strong>-rspin</strong>, <strong>-rspout</strong>, <strong>-reqin</strong>, and <strong>-reqout</strong> options so far are not supported in this mode.<ul><li><strong>-max_msgs</strong> <em>number</em></ul><p>Maximum number of CMP (request) messages the CMP HTTP server mock-up should handle, which must be nonnegative. The default value is 0, which means that no limit is imposed. In any case the server terminates on internal errors, but not when it detects a CMP-level error that it can successfully answer with an error message.<ul><li><strong>-srv_ref</strong> <em>value</em></ul><p>Reference value to use as senderKID of server in case no <strong>-srv_cert</strong> is given.<ul><li><strong>-srv_secret</strong> <em>arg</em></ul><p>Password source for server authentication with a pre-shared key (secret).<ul><li><strong>-srv_cert</strong> <em>filename</em>|<em>uri</em></ul><p>Certificate of the server.<ul><li><strong>-srv_key</strong> <em>filename</em>|<em>uri</em></ul><p>Private key used by the server for signing messages.<ul><li><strong>-srv_keypass</strong> <em>arg</em></ul><p>Server private key (and cert) file pass phrase source.<ul><li><strong>-srv_trusted</strong> <em>filenames</em>|<em>uris</em></ul><p>Trusted certificates for client authentication.<p>The certificate verification options <strong>-verify_hostname</strong>, <strong>-verify_ip</strong>, and <strong>-verify_email</strong> have no effect on the certificate verification enabled via this option.<ul><li><strong>-srv_untrusted</strong> <em>filenames</em>|<em>uris</em></ul><p>Intermediate CA certs that may be useful when validating client certificates.<ul><li><strong>-ref_cert</strong> <em>filename</em>|<em>uri</em></ul><p>Certificate to be expected for RR messages and any oldCertID in KUR messages.<ul><li><strong>-rsp_cert</strong> <em>filename</em>|<em>uri</em></ul><p>Certificate to be returned as mock enrollment result.<ul><li><strong>-rsp_extracerts</strong> <em>filenames</em>|<em>uris</em></ul><p>Extra certificates to be included in mock certification responses.<ul><li><strong>-rsp_capubs</strong> <em>filenames</em>|<em>uris</em></ul><p>CA certificates to be included in mock Initialization Response (IP) message.<ul><li><strong>-rsp_newwithnew</strong> <em>filename</em>|<em>uri</em></ul><p>Certificate to be returned in newWithNew field of genp of type rootCaKeyUpdate.<ul><li><strong>-rsp_newwithold</strong> <em>filename</em>|<em>uri</em></ul><p>Certificate to be returned in newWithOld field of genp of type rootCaKeyUpdate.<ul><li><strong>-rsp_oldwithnew</strong> <em>filename</em>|<em>uri</em></ul><p>Certificate to be returned in oldWithNew field of genp of type rootCaKeyUpdate.<ul><li><strong>-poll_count</strong> <em>number</em></ul><p>Number of times the client must poll before receiving a certificate.<ul><li><strong>-check_after</strong> <em>number</em></ul><p>The checkAfter value (number of seconds to wait) to include in poll response.<ul><li><strong>-grant_implicitconf</strong></ul><p>Grant implicit confirmation of newly enrolled certificate.<ul><li><strong>-pkistatus</strong> <em>number</em></ul><p>PKIStatus to be included in server response. Valid range is 0 (accepted) .. 6 (keyUpdateWarning).<ul><li><strong>-failure</strong> <em>number</em></ul><p>A single failure info bit number to be included in server response. Valid range is 0 (badAlg) .. 26 (duplicateCertReq).<ul><li><strong>-failurebits</strong> <em>number</em> Number representing failure bits to be included in server response. Valid range is 0 .. 2^27 - 1.<li><strong>-statusstring</strong> <em>arg</em></ul><p>Text to be included as status string in server response.<ul><li><strong>-send_error</strong></ul><p>Force server to reply with error message.<ul><li><strong>-send_unprotected</strong></ul><p>Send response messages without CMP-level protection.<ul><li><strong>-send_unprot_err</strong></ul><p>In case of negative responses, server shall send unprotected error messages, certificate responses (IP/CP/KUP), and revocation responses (RP). WARNING: This setting leads to behavior violating RFC 4210.<ul><li><strong>-accept_unprotected</strong></ul><p>Accept missing or invalid protection of requests.<ul><li><strong>-accept_unprot_err</strong></ul><p>Accept unprotected error messages from client. So far this has no effect because the server does not accept any error messages.<ul><li><strong>-accept_raverified</strong></ul><p>Accept RAVERIFED as proof of possession (POPO).<h3 id=certificate-verification-options-for-both-cmp-and-tls>Certificate verification options, for both CMP and TLS<a title="Permanent link" class=headerlink href=#certificate-verification-options-for-both-cmp-and-tls>¶</a></h3><ul><li><strong>-allow_proxy_certs</strong>, <strong>-attime</strong>, <strong>-no_check_time</strong>, <strong>-check_ss_sig</strong>, <strong>-crl_check</strong>, <strong>-crl_check_all</strong>, <strong>-explicit_policy</strong>, <strong>-extended_crl</strong>, <strong>-ignore_critical</strong>, <strong>-inhibit_any</strong>, <strong>-inhibit_map</strong>, <strong>-no_alt_chains</strong>, <strong>-partial_chain</strong>, <strong>-policy</strong>, <strong>-policy_check</strong>, <strong>-policy_print</strong>, <strong>-purpose</strong>, <strong>-suiteB_128</strong>, <strong>-suiteB_128_only</strong>, <strong>-suiteB_192</strong>, <strong>-trusted_first</strong>, <strong>-use_deltas</strong>, <strong>-auth_level</strong>, <strong>-verify_depth</strong>, <strong>-verify_email</strong>, <strong>-verify_hostname</strong>, <strong>-verify_ip</strong>, <strong>-verify_name</strong>, <strong>-x509_strict</strong> <strong>-issuer_checks</strong></ul><p>Set various options of certificate chain verification. See <a href=../../man1/openssl-verification-options>"Verification Options" in openssl-verification-options(1)</a> for details.<p>The certificate verification options <strong>-verify_hostname</strong>, <strong>-verify_ip</strong>, and <strong>-verify_email</strong> only affect the certificate verification enabled via the <strong>-out_trusted</strong> option.<h2 id=notes>NOTES<a title="Permanent link" class=headerlink href=#notes>¶</a></h2><p>When a client obtains, from a CMP server, CA certificates that it is going to trust, for instance via the <code>caPubs</code> field of a certificate response or using general messages with infoType <code>caCerts</code> or <code>rootCaCert</code>, authentication of the CMP server is particularly critical. So special care must be taken setting up server authentication using <strong>-trusted</strong> and related options for certificate-based authentication or <strong>-secret</strong> for MAC-based protection. If authentication is certificate-based, the <strong>-srvcertout</strong> option should be used to obtain the validated server certificate and perform an authorization check based on it.<p>When setting up CMP configurations and experimenting with enrollment options typically various errors occur until the configuration is correct and complete. When the CMP server reports an error the client will by default check the protection of the CMP response message. Yet some CMP services tend not to protect negative responses. In this case the client will reject them, and thus their contents are not shown although they usually contain hints that would be helpful for diagnostics. For assisting in such cases the CMP client offers a workaround via the <strong>-unprotected_errors</strong> option, which allows accepting such negative messages.<p>If OpenSSL was built with trace support enabled (e.g., <code>./config enable-trace</code>) and the environment variable <strong>OPENSSL_TRACE</strong> includes <strong>HTTP</strong>, the requests and the response headers transferred via HTTP are printed.<h2 id=examples>EXAMPLES<a title="Permanent link" class=headerlink href=#examples>¶</a></h2><h3 id=simple-examples-using-the-default-openssl-configuration-file>Simple examples using the default OpenSSL configuration file<a title="Permanent link" class=headerlink href=#simple-examples-using-the-default-openssl-configuration-file>¶</a></h3><p>This CMP client implementation comes with demonstrative CMP sections in the example configuration file <code>openssl/apps/openssl.cnf</code>, which can be used to interact conveniently with the Insta Demo CA.<p>In order to enroll an initial certificate from that CA it is sufficient to issue the following shell commands.<div class=highlight><pre><span></span><code>export OPENSSL_CONF=/path/to/openssl/apps/openssl.cnf

openssl genrsa -out insta.priv.pem
openssl cmp -section insta
</code></pre></div><p>This should produce the file <code>insta.cert.pem</code> containing a new certificate for the private key held in <code>insta.priv.pem</code>. It can be viewed using, e.g.,<div class=highlight><pre><span></span><code>openssl x509 -noout -text -in insta.cert.pem
</code></pre></div><p>In case the network setup requires using an HTTP proxy it may be given as usual via the environment variable <strong>http_proxy</strong> or via the <strong>-proxy</strong> option in the configuration file or the CMP command-line argument <strong>-proxy</strong>, for example<div class=highlight><pre><span></span><code>-proxy http://192.168.1.1:8080
</code></pre></div><p>In the Insta Demo CA scenario both clients and the server may use the pre-shared secret <em>insta</em> and the reference value <em>3078</em> to authenticate to each other.<p>Alternatively, CMP messages may be protected in signature-based manner, where the trust anchor in this case is <code>insta.ca.crt</code> and the client may use any certificate already obtained from that CA, as specified in the <strong>[signature]</strong> section of the example configuration. This can be used in combination with the <strong>[insta]</strong> section simply by<div class=highlight><pre><span></span><code>openssl cmp -section insta,signature
</code></pre></div><p>By default the CMP IR message type is used, yet CR works equally here. This may be specified directly at the command line:<div class=highlight><pre><span></span><code>openssl cmp -section insta -cmd cr
</code></pre></div><p>or by referencing in addition the <strong>[cr]</strong> section of the example configuration:<div class=highlight><pre><span></span><code>openssl cmp -section insta,cr
</code></pre></div><p>In order to update the enrolled certificate one may call<div class=highlight><pre><span></span><code>openssl cmp -section insta,kur
</code></pre></div><p>using MAC-based protection with PBM or<div class=highlight><pre><span></span><code>openssl cmp -section insta,kur,signature
</code></pre></div><p>using signature-based protection.<p>In a similar way any previously enrolled certificate may be revoked by<div class=highlight><pre><span></span><code>openssl cmp -section insta,rr -trusted insta.ca.crt
</code></pre></div><p>or<div class=highlight><pre><span></span><code>openssl cmp -section insta,rr,signature
</code></pre></div><p>Many more options can be given in the configuration file and/or on the command line. For instance, the <strong>-reqexts</strong> CLI option may refer to a section in the configuration file defining X.509 extensions to use in certificate requests, such as <code>v3_req</code> in <code>openssl/apps/openssl.cnf</code>:<div class=highlight><pre><span></span><code>openssl cmp -section insta,cr -reqexts v3_req
</code></pre></div><h3 id=certificate-enrollment>Certificate enrollment<a title="Permanent link" class=headerlink href=#certificate-enrollment>¶</a></h3><p>The following examples do not make use of a configuration file at first. They assume that a CMP server can be contacted on the local TCP port 80 and accepts requests under the alias <em>/pkix/</em>.<p>For enrolling its very first certificate the client generates a client key and sends an initial request message to the local CMP server using a pre-shared secret key for mutual authentication. In this example the client does not have the CA certificate yet, so we specify the name of the CA with the <strong>-recipient</strong> option and save any CA certificates that we may receive in the <code>capubs.pem</code> file.<p>In below command line usage examples the <code>\</code> at line ends is used just for formatting; each of the command invocations should be on a single line.<div class=highlight><pre><span></span><code>openssl genrsa -out cl_key.pem
openssl cmp -cmd ir -server 127.0.0.1:80/pkix/ -recipient "/CN=CMPserver" \
  -ref 1234 -secret pass:1234-5678 \
  -newkey cl_key.pem -subject "/CN=MyName" \
  -cacertsout capubs.pem -certout cl_cert.pem
</code></pre></div><h3 id=certificate-update>Certificate update<a title="Permanent link" class=headerlink href=#certificate-update>¶</a></h3><p>Then, when the client certificate and its related key pair needs to be updated, the client can send a key update request taking the certs in <code>capubs.pem</code> as trusted for authenticating the server and using the previous cert and key for its own authentication. Then it can start using the new cert and key.<div class=highlight><pre><span></span><code>openssl genrsa -out cl_key_new.pem
openssl cmp -cmd kur -server 127.0.0.1:80/pkix/ \
  -trusted capubs.pem \
  -cert cl_cert.pem -key cl_key.pem \
  -newkey cl_key_new.pem -certout cl_cert.pem
cp cl_key_new.pem cl_key.pem
</code></pre></div><p>This command sequence can be repeated as often as needed.<h3 id=requesting-information-from-cmp-server>Requesting information from CMP server<a title="Permanent link" class=headerlink href=#requesting-information-from-cmp-server>¶</a></h3><p>Requesting "all relevant information" with an empty General Message. This prints information about all received ITAV <strong>infoType</strong>s to stdout.<div class=highlight><pre><span></span><code>openssl cmp -cmd genm -server 127.0.0.1/pkix/ -recipient "/CN=CMPserver" \
  -ref 1234 -secret pass:1234-5678
</code></pre></div><h3 id=using-a-custom-configuration-file>Using a custom configuration file<a title="Permanent link" class=headerlink href=#using-a-custom-configuration-file>¶</a></h3><p>For CMP client invocations, in particular for certificate enrollment, usually many parameters need to be set, which is tedious and error-prone to do on the command line. Therefore, the client offers the possibility to read options from sections of the OpenSSL config file, usually called <code>openssl.cnf</code>. The values found there can still be extended and even overridden by any subsequently loaded sections and on the command line.<p>After including in the configuration file the following sections:<div class=highlight><pre><span></span><code>[cmp]
server = 127.0.0.1
path = pkix/
trusted = capubs.pem
cert = cl_cert.pem
key = cl_key.pem
newkey = cl_key.pem
certout = cl_cert.pem

[init]
recipient = "/CN=CMPserver"
trusted =
cert =
key =
ref = 1234
secret = pass:1234-5678-1234-567
subject = "/CN=MyName"
cacertsout = capubs.pem
</code></pre></div><p>the above enrollment transactions reduce to<div class=highlight><pre><span></span><code>openssl cmp -section cmp,init
openssl cmp -cmd kur -newkey cl_key_new.pem
</code></pre></div><p>and the above transaction using a general message reduces to<div class=highlight><pre><span></span><code>openssl cmp -section cmp,init -cmd genm
</code></pre></div><h2 id=see-also>SEE ALSO<a title="Permanent link" class=headerlink href=#see-also>¶</a></h2><p><a href=../openssl-genrsa/>openssl-genrsa(1)</a>, <a href=../openssl-ecparam/>openssl-ecparam(1)</a>, <a href=../openssl-list/>openssl-list(1)</a>, <a href=../openssl-req/>openssl-req(1)</a>, <a href=../openssl-x509/>openssl-x509(1)</a>, <a href=../../man5/x509v3_config/>x509v3_config(5)</a><h2 id=history>HISTORY<a title="Permanent link" class=headerlink href=#history>¶</a></h2><p>The <strong>cmp</strong> application was added in OpenSSL 3.0.<p>The <strong>-engine</strong> option was deprecated in OpenSSL 3.0.<p>The <strong>-profile</strong> option was added in OpenSSL 3.3.<h2 id=copyright>COPYRIGHT<a title="Permanent link" class=headerlink href=#copyright>¶</a></h2><p>Copyright 2007-2024 The OpenSSL Project Authors. All Rights Reserved.<p>Licensed under the Apache License 2.0 (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at <a href=https://www.openssl.org/source/license.html>https://www.openssl.org/source/license.html</a>.</article></div><script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script></div></main><footer class=md-footer><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright>Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs </a></div></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><script id=__config type=application/json>{"base": "../..", "features": ["navigation.indexes", "navigation.instant", "navigation.path", "navigation.prune", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "master", "provider": "mike"}}</script><script src=../../assets/javascripts/bundle.ad660dcc.min.js></script>